<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.16">
<meta name="description" content="A Selenium, Cypress, Playwright and Puppeteer testing platform running in Kubernetes or Openshift clusters. Fully compatible with Selenium Webdriver protocol. Live and automated testing are supported. Runs on your own hardware or in any popular cloud platform: Google Cloud, Amazon Web Services, DigitalOcean, Microsoft Azure and so on.">
<meta name="author" content="Aerokube Software OÜ">
<link rel="icon" type="image/png" href="img/favicon.png">
<title>Moon - A cross browser Selenium, Cypress, Playwright and Puppeteer solution for Kubernetes or Openshift cluster</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;-webkit-tap-highlight-color:transparent}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
pre.CodeRay{background:#f7f7f8}
.CodeRay .line-numbers{border-right:1px solid currentColor;opacity:.35;padding:0 .5em 0 0}
.CodeRay span.line-numbers{display:inline-block;margin-right:.75em}
.CodeRay .line-numbers strong{color:#000}
table.CodeRay{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.CodeRay td{vertical-align:top;line-height:inherit}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.code{padding:0 0 0 .75em}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
<base href="https://aerokube.com/moon/dev-latest/">
<meta property="og:image:height" content="1106">
<meta property="og:image:width" content="2113">
<meta property="og:title" content="Aerokube Moon | A cross browser Selenium solution for Kubernetes or Openshift cluster">
<meta property="og:description" content="Live and automated cross browser Selenium testing in Kubernetes or Openshift cluster">
<meta property="og:url" content="https://aerokube.com/moon/dev-latest">
<meta property="og:image" content="https://aerokube.com/moon/dev-latest/img/og-image.jpg">
<meta name="twitter:site" content="@aerokube">
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Moon</h1>
<div class="details">
<span id="author" class="author">Aerokube Software OÜ</span><br>
<span id="revnumber">version dev-latest,</span>
<span id="revdate">2021-12-21</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#getting-started">1. Getting Started</a>
<ul class="sectlevel2">
<li><a href="#install">1.1. Quick Start Guide</a>
<ul class="sectlevel3">
<li><a href="#install-kubernetes">1.1.1. Installing to Kubernetes</a></li>
<li><a href="#install-openshift">1.1.2. Installing to Openshift</a></li>
</ul>
</li>
<li><a href="#architecture">1.2. Architecture</a>
<ul class="sectlevel3">
<li><a href="#moon-components">1.2.1. Moon Components</a></li>
<li><a href="#moon-operation-modes">1.2.2. Moon Operation Modes</a></li>
<li><a href="#moon-pod-contents">1.2.3. Browser Pod Contents</a></li>
</ul>
</li>
<li><a href="#recommended-cluster-settings">1.3. Recommended Cluster Settings</a></li>
<li><a href="#permissions">1.4. Required Permissions</a>
<ul class="sectlevel3">
<li><a href="#permissions-single-namespace">1.4.1. Single Namespace Mode</a></li>
<li><a href="#permissions-multiple-namespaces">1.4.2. Multiple Namespaces Mode</a></li>
</ul>
</li>
<li><a href="#moon2-vs-moon1">1.5. Difference between Moon 2.x and Moon 1.x</a></li>
<li><a href="#advantages">1.6. Moon vs other solutions</a></li>
</ul>
</li>
<li><a href="#main-features">2. Main Features</a>
<ul class="sectlevel2">
<li><a href="#cypress">2.1. Using Cypress</a>
<ul class="sectlevel3">
<li><a href="#cypress-select-browser">2.1.1. Selecting Requested Browser</a></li>
<li><a href="#cypress-select-cypress-version">2.1.2. Selecting Exact Cypress Version</a></li>
<li><a href="#cypress-additional-features">2.1.3. Enabling Additional Features</a></li>
</ul>
</li>
<li><a href="#playwright">2.2. Using Playwright</a>
<ul class="sectlevel3">
<li><a href="#playwright-select-browser">2.2.1. Selecting Requested Browser</a></li>
<li><a href="#playwright-select-browser-version">2.2.2. Selecting Exact Browser Version</a></li>
<li><a href="#playwright-select-playwright-version">2.2.3. Selecting Exact Playwright Version</a></li>
<li><a href="#playwright-additional-features">2.2.4. Enabling Additional Features</a></li>
</ul>
</li>
<li><a href="#devtools">2.3. Accessing Chrome Developer Tools</a>
<ul class="sectlevel3">
<li><a href="#devtools-select-browser">2.3.1. Selecting Requested Browser</a></li>
<li><a href="#devtools-additional-features">2.3.2. Enabling Additional Features</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#configuration">3. Configuration</a>
<ul class="sectlevel2">
<li><a href="#license">3.1. Installing a License</a></li>
<li><a href="#monitoring">3.2. Monitoring</a>
<ul class="sectlevel3">
<li><a href="#monitoring-setup">3.2.1. Setup</a></li>
<li><a href="#monitoring-built-in-metrics">3.2.2. Built-in Moon metrics</a></li>
<li><a href="#filter-by-labels">3.2.3. Filtering Browser Pods by Labels</a></li>
</ul>
</li>
<li><a href="#_log_files">3.3. Log Files</a></li>
<li><a href="#_cli_flags">3.4. CLI Flags</a>
<ul class="sectlevel3">
<li><a href="#cli-flags-moon">3.4.1. Moon Container Flags</a></li>
<li><a href="#cli-flags-moon-conf">3.4.2. Moon Conf Container Flags</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_frequently_asked_questions">4. Frequently Asked Questions</a>
<ul class="sectlevel2">
<li><a href="#faq-moon-logs">4.1. Where are Moon logs?</a></li>
<li><a href="#faq-recorded-videos">4.2. Where are recorded videos stored?</a></li>
<li><a href="#faq-update-configuration">4.3. How to update configuration of a running Moon cluster?</a></li>
<li><a href="#faq-kubernetes-service-account">4.4. Is it possible to configure Kubernetes service account for Moon?</a></li>
<li><a href="#faq-custom-firewall-rules">4.5. Is it possible to assign custom firewall rules to browser pods?</a></li>
<li><a href="#faq-connection-closed-unexpectedly">4.6. Connection was closed unexpectedly</a></li>
<li><a href="#faq-dns-lookup-timeouts">4.7. DNS lookup timeouts</a></li>
<li><a href="#faq-session-timeouts-do-no-work">4.8. Browser session timeouts do not work</a></li>
<li><a href="#faq-json-errors">4.9. JSON processing errors in tests</a></li>
</ul>
</li>
<li><a href="#_license_agreement">5. License Agreement</a></li>
<li><a href="#_pricing">6. Pricing</a></li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This reference for version: <em>dev-latest</em></p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
This documentation is the work in progress for the new development Moon 2.x version. Moon 1.x (stable version) documentation is published <a href="https://aerokube.com/moon/latest">here</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Moon is a browser automation solution compatible with <a href="https://www.w3.org/TR/webdriver/">Selenium</a>, <a href="https://www.cypress.io/">Cypress</a>, <a href="https://playwright.dev/">Playwright</a> and <a href="https://pptr.dev/">Puppeteer</a> using <a href="https://kubernetes.io/">Kubernetes</a> or <a href="https://openshift.com/">Openshift</a> to launch browsers.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="getting-started"><a class="anchor" href="#getting-started"></a>1. Getting Started</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="install"><a class="anchor" href="#install"></a>1.1. Quick Start Guide</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This section shows how to install Moon limited to 4 parallel browser sessions. Detailed information on installing a license key allowing to activate more parallel sessions is shown in <a href="#">Installing License</a> section.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="install-kubernetes"><a class="anchor" href="#install-kubernetes"></a>1.1.1. Installing to Kubernetes</h4>
<div class="sect4">
<h5 id="install-prerequisites"><a class="anchor" href="#install-prerequisites"></a>Prerequisites</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Running <a href="https://kubernetes.io/">Kubernetes</a> cluster</p>
</li>
<li>
<p><code>kubectl</code> client installed and pointing to the cluster</p>
</li>
<li>
<p>If you are running Kubernetes cluster on virtual machines, we usually recommend having bigger VMs instead of smaller ones. This allows to avoid available CPUs and memory fragmentation issues. For example having 24 CPU cores overall it is better to start 3 x 8 CPU core VMs instead of 12 x 2 CPU core.</p>
</li>
<li>
<p>If you are starting Moon in Kubernetes cluster deployed on workstation with <a href="https://github.com/kubernetes/minikube/">minikube</a> tool - see <a href="#install-minikube">Option 3: you have Minikube</a>.</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="install-helm"><a class="anchor" href="#install-helm"></a>Option 1: use Helm chart</h5>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Helm chart is the recommended Moon installation way. Steps below require Helm 3 and will not work with older releases.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>We deliver already packed and published <a href="https://helm.sh/">Helm</a> charts, so installing Moon with Helm is straightforward:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Add Aerokube <a href="https://github.com/aerokube/charts">charts</a> repository:</p>
<div class="literalblock">
<div class="content">
<pre>$ helm repo add aerokube https://charts.aerokube.com/
$ helm repo update</pre>
</div>
</div>
</li>
<li>
<p>To list available Moon versions type:</p>
<div class="literalblock">
<div class="content">
<pre>$ helm search repo aerokube --versions</pre>
</div>
</div>
</li>
<li>
<p>Create a namespace:</p>
<div class="literalblock">
<div class="content">
<pre>$ kubectl create namespace moon</pre>
</div>
</div>
</li>
<li>
<p>To install or upgrade Moon type:</p>
<div class="literalblock">
<div class="content">
<pre>$ helm upgrade --install -n moon moon aerokube/moon</pre>
</div>
</div>
</li>
<li>
<p>Moon chart has a lot of various configuration parameters that can be listed as follows:</p>
<div class="literalblock">
<div class="content">
<pre>$ helm show values aerokube/moon</pre>
</div>
</div>
<div class="paragraph">
<p>To change one of these parameters - use <code>--set</code> flag:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ helm upgrade --install --set=moon.enabled.resources=false -n moon moon aerokube/moon</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="install-moon-deploy"><a class="anchor" href="#install-moon-deploy"></a>Option 2: use raw YAML manifests</h5>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Although we maintain raw YAML manifests up-to-date, we recommend using Helm where possible.
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clone YAML manifests repository:</p>
<div class="literalblock">
<div class="content">
<pre>$ git clone https://github.com/aerokube/moon-deploy.git
$ cd moon-deploy</pre>
</div>
</div>
</li>
<li>
<p>Run one command to start Moon and Moon API:</p>
<div class="literalblock">
<div class="content">
<pre>$ kubectl apply -f moon.yaml</pre>
</div>
</div>
<div class="paragraph">
<p>If you have only several CPUs available in your cluster - use <code>moon-local.yaml</code> file instead. By default, Moon is started in a separate namespace called <code>moon</code>, so we append <code>-n moon</code> to the next commands.</p>
</div>
</li>
<li>
<p>Wait for LoadBalancer IP to allocate:</p>
<div class="literalblock">
<div class="content">
<pre>$ kubectl get svc -n moon
NAME      TYPE           CLUSTER-IP      EXTERNAL-IP   PORT(S)                         AGE
browsers  ClusterIP      None            &lt;none&gt;        &lt;none&gt;                          51s
moon      LoadBalancer   10.63.242.109   &lt;pending&gt;     4444:31894/TCP,8080:30625/TCP   17s</pre>
</div>
</div>
<div class="paragraph">
<p>It will look like this when finished:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ kubectl get svc -n moon
NAME      TYPE           CLUSTER-IP      EXTERNAL-IP      PORT(S)                         AGE
browsers  ClusterIP      None            &lt;none&gt;           &lt;none&gt;                          51s
moon      LoadBalancer   10.63.242.109   104.154.161.58   4444:31894/TCP,8080:30625/TCP   1m</pre>
</div>
</div>
<div class="paragraph">
<p>Now you can optionally point a domain name to this IP address:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ host moon.example.com
moon.example.com has address 104.154.161.58</pre>
</div>
</div>
</li>
<li>
<p>Run your tests against <code>moon</code> like you do with regular Selenium:</p>
<div class="literalblock">
<div class="content">
<pre>http://104.154.161.58:4444/wd/hub</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
When running your tests for the first time for every browser version Kubernetes will download and cache requested browser image. This can take several minutes depending on your network connection.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Same address using domain name:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>http://moon.example.com:4444/wd/hub</pre>
</div>
</div>
</li>
<li>
<p>Moon web interface is available at:</p>
<div class="literalblock">
<div class="content">
<pre>http://104.154.161.58:8080/</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="install-minikube"><a class="anchor" href="#install-minikube"></a>Option 3: you have Minikube</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clone an example configuration repository:</p>
<div class="literalblock">
<div class="content">
<pre>$ git clone https://github.com/aerokube/moon-deploy.git
$ cd moon-deploy</pre>
</div>
</div>
</li>
<li>
<p>Run one command to start Moon and Moon API:</p>
<div class="literalblock">
<div class="content">
<pre>$ minikube kubectl -- apply -f moon-local.yaml</pre>
</div>
</div>
</li>
<li>
<p>Minikube does not automatically assign IP address to LoadBalancer, so let&#8217;s do this manually:</p>
<div class="literalblock">
<div class="content">
<pre>$ minikube kubectl -- patch svc moon -n moon --patch "{\"spec\":{\"externalIPs\":[\"$(minikube ip)\"]}}"</pre>
</div>
</div>
</li>
<li>
<p>The last step is to get Selenium URL:</p>
<div class="literalblock">
<div class="content">
<pre>$ minikube ip
192.168.99.100</pre>
</div>
</div>
<div class="paragraph">
<p>Use the following as Selenium URL:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>http://192.168.99.100:4444/wd/hub</pre>
</div>
</div>
<div class="paragraph">
<p>Moon web interface is available at:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>http://192.168.99.100:8080/</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When Minikube is using <a href="https://minikube.sigs.k8s.io/docs/drivers/docker/">Docker driver</a> to access Moon you can use <a href="https://minikube.sigs.k8s.io/docs/commands/tunnel/">minikube tunnel</a> command instead:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In a separate terminal run command to start Minikube tunnel:</p>
<div class="literalblock">
<div class="content">
<pre>$ minikube tunnel</pre>
</div>
</div>
</li>
<li>
<p>Use <code>127.0.0.1</code> to access Moon:</p>
<div class="literalblock">
<div class="content">
<pre>http://127.0.0.1:4444/wd/hub
http://127.0.0.1:8080/</pre>
</div>
</div>
</li>
</ol>
</div>
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="install-openshift"><a class="anchor" href="#install-openshift"></a>1.1.2. Installing to Openshift</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Prerequisites:</p>
<div class="ulist">
<ul>
<li>
<p>Running <a href="https://www.openshift.com/">Openshift</a> cluster</p>
</li>
<li>
<p><code>oc</code> client installed and pointing to the cluster</p>
</li>
</ul>
</div>
</li>
<li>
<p>Clone an example configuration repository:</p>
<div class="literalblock">
<div class="content">
<pre>$ git clone https://github.com/aerokube/moon-deploy.git
$ cd moon-deploy</pre>
</div>
</div>
</li>
<li>
<p>Add <code>edit</code> policy to <code>default</code> account so Moon could read project pod quota:</p>
<div class="literalblock">
<div class="content">
<pre>$ oc policy add-role-to-user edit system:serviceaccount:moon:default</pre>
</div>
</div>
<div class="paragraph">
<p>Here we assume that Openshift project for Moon is called <code>moon</code>.</p>
</div>
</li>
<li>
<p>Start Moon with Openshift UI or <code>oc</code> client using <code>moon-openshift.yaml</code> file:</p>
<div class="literalblock">
<div class="content">
<pre>$ oc create -f moon-openshift.yaml -n moon</pre>
</div>
</div>
</li>
<li>
<p>Run Selenium tests against <code>moon</code> service listening on port <code>4444</code>:</p>
<div class="literalblock">
<div class="content">
<pre>http://&lt;moon-ip-or-hostname&gt;:4444/wd/hub</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="architecture"><a class="anchor" href="#architecture"></a>1.2. Architecture</h3>
<div class="sect3">
<h4 id="moon-components"><a class="anchor" href="#moon-components"></a>1.2.1. Moon Components</h4>
<div class="paragraph">
<div class="title">Moon Components</div>
<p><span class="image"><img src="img/moon-components.png" alt="moon components"></span></p>
</div>
<div class="paragraph">
<p>Moon cluster consists of several components:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>One or more <code>Moon</code> application instances. Their main purpose is to start and stop browser containers. These replicas are usually exposed as <a href="https://kubernetes.io/docs/concepts/services-networking/service/">Kubernetes service</a> available on standard Selenium port <code>4444</code>. You should run all the tests against this service. Also, this application provides an API to get information about running browser instances (in Moon 1.x this was a separate application called <code>Moon API</code>).</p>
</li>
<li>
<p>One or more <code>Moon Conf</code> application instances. This application is watching all configured Kubernetes namespaces and controls correct distribution of licenses among all these namespaces.</p>
</li>
<li>
<p>One or more <code>Moon UI</code> application instances. <code>Moon UI</code> collects information from Moon and visualizes it. It is usually available on HTTP port <code>8080</code>.</p>
</li>
<li>
<p>Running browser pods.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="moon-operation-modes"><a class="anchor" href="#moon-operation-modes"></a>1.2.2. Moon Operation Modes</h4>
<div class="paragraph">
<p>Moon 2.x has two different operation modes: <strong>single namespace mode</strong> and <strong>multiple namespaces mode</strong>.</p>
</div>
<div class="paragraph">
<div class="title">Single Namespace Mode</div>
<p><span class="image"><img src="img/single-namespace-mode.png" alt="single-namespace-mode"></span></p>
</div>
<div class="paragraph">
<p>In single namespace mode Moon itself and all launched browser pods are running in the one Kubernetes namespace. Moon 1.x was only able to work like this. This is still suitable if only one team is using Moon or you don&#8217;t need to limit browser consumption of different Moon users.</p>
</div>
<div class="paragraph">
<div class="title">Multiple Namespaces Mode</div>
<p><span class="image"><img src="img/multiple-namespaces-mode.png" alt="multiple-namespaces-mode"></span></p>
</div>
<div class="paragraph">
<p>In multiple namespaces mode Moon is running in one namespace and browsers are launched in separate namespaces. The total number of such namespaces is unlimited. This mode is mainly needed when you want to control computing resources, browsers or network access rules (<a href="https://kubernetes.io/docs/concepts/services-networking/network-policies/">network policies</a>) available for every team.</p>
</div>
</div>
<div class="sect3">
<h4 id="moon-pod-contents"><a class="anchor" href="#moon-pod-contents"></a>1.2.3. Browser Pod Contents</h4>
<div class="paragraph">
<p>In addition to container with browser every pod created by Moon contains one or more service images.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Service Images</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Purpose</th>
<th class="tableblock halign-left valign-top">Started</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">defender</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows only one browser session to be created in the pod, handles session timeouts</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vnc-server</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Delivers <a href="https://en.wikipedia.org/wiki/Virtual_Network_Computing">VNC</a> connectivity to browser images</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When VNC is requested by user</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">x-server</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Delivers an <a href="https://en.wikipedia.org/wiki/X_Window_System_core_protocol">X</a> server for running non-headless browsers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When browser window is visible</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="recommended-cluster-settings"><a class="anchor" href="#recommended-cluster-settings"></a>1.3. Recommended Cluster Settings</h3>
<div class="ulist">
<ul>
<li>
<p><strong>Use the biggest possible cluster node sizes</strong>. For example having 100 CPUs overall it is better to launch 5 nodes with 20 CPUs each than 50 nodes with 2 CPUs each. Browser pods can in some cases require more than 2 CPUs and this can lead to preliminary cluster fragmentation.</p>
</li>
<li>
<p><strong>Avoid cluster nodes with RedHat \ CentOS if possible.</strong> Nodes using these distributions are known to suffer from issues related to firewall \ SeLinux and can be more complicated to configure correctly.</p>
</li>
<li>
<p><strong>Use Calico container network interface instead of Flannel if possible</strong>. Calico has better performance than Flannel especially on big clusters.</p>
</li>
<li>
<p><strong>Use more than 1 Kubernetes API replica if needed</strong>. Moon is using Kubernetes API to create and delete browser pods. If you plan to run hundreds of browsers in parallel - take a look at Kubernetes API (Kubernetes master) host system metrics. Overloaded master can stop responding to requests properly and this can lead to frozen browser pods.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="permissions"><a class="anchor" href="#permissions"></a>1.4. Required Permissions</h3>
<div class="paragraph">
<p>Moon requires a limited set of permissions and should work with default Kubernetes settings. By default, Moon runs browsers in the same <code>moon</code> namespace where it runs (<strong>single namespace mode</strong>). Moon 2.0.0 and above supports multiple Kubernetes <a href="https://kubernetes.io/docs/tasks/administer-cluster/namespaces-walkthrough/">namespaces</a>. This allows you to have one Moon instance running in <code>moon</code> namespace and an arbitrary number of namespaces for running browsers of different users (<strong>multiple namespaces mode</strong>). This allows you to easily set maximum number of browsers allowed to run by every team.</p>
</div>
<div class="sect3">
<h4 id="permissions-single-namespace"><a class="anchor" href="#permissions-single-namespace"></a>1.4.1. Single Namespace Mode</h4>
<div class="paragraph">
<p>The following table summarizes what needs to be accessible for Moon in single namespace mode:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Required Moon Permissions In Single Namespace Mode</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Permission</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Purpose</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">To <strong>get</strong>, <strong>watch</strong>, <strong>list</strong>, <strong>create</strong>, <strong>delete</strong>, <strong>update</strong> and <strong>patch</strong> <a href="https://kubernetes.io/docs/concepts/workloads/pods/pod/">pods</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used to manipulate pods with browsers</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">To <strong>get</strong>, <strong>watch</strong>, <strong>list</strong>, <strong>create</strong>, <strong>delete</strong>, <strong>update</strong> and <strong>patch</strong> <a href="https://kubernetes.io/docs/concepts/configuration/configmap/">config maps</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used to pass users and groups to browser pods</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">To <strong>get</strong>, <strong>watch</strong>, <strong>list</strong>, <strong>create</strong>, <strong>delete</strong>, <strong>update</strong> and <strong>patch</strong> <a href="https://kubernetes.io/docs/concepts/workloads/controllers/deployment/">deployments</a> and <a href="https://kubernetes.io/docs/concepts/workloads/controllers/replicaset/">replica sets</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used in license functionality</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">To <strong>get</strong>, <strong>watch</strong> and <strong>list</strong> Moon <a href="https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/">custom resources</a> in <code>moon.aerokube.com</code> API group</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">These custom resources store Moon configuration</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="permissions-multiple-namespaces"><a class="anchor" href="#permissions-multiple-namespaces"></a>1.4.2. Multiple Namespaces Mode</h4>
<div class="paragraph">
<p>When running browsers in multiple namespaces required permissions differ. The following table shows Moon permissions in the namespace where it is running:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. Required Permissions for the Namespace where Moon runs</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Permission</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Purpose</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">To <strong>get</strong>, <strong>watch</strong> and <strong>list</strong> information about <a href="https://kubernetes.io/docs/concepts/workloads/pods/pod/">namespaces</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Needed to control how many browsers are running in every user namespace</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">To <strong>get</strong>, <strong>watch</strong> and <strong>list</strong> <a href="https://kubernetes.io/docs/concepts/workloads/pods/pod/">pods</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used to analyze pods in Moon namespace</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">To <strong>get</strong>, <strong>watch</strong>, <strong>list</strong>, <strong>create</strong>, <strong>delete</strong>, <strong>update</strong> and <strong>patch</strong> <a href="https://kubernetes.io/docs/concepts/workloads/controllers/deployment/">deployments</a> and <a href="https://kubernetes.io/docs/concepts/workloads/controllers/replicaset/">replica sets</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used in license functionality</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">To <strong>get</strong>, <strong>watch</strong> and <strong>list</strong> Moon <a href="https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/">custom resources</a> in <code>moon.aerokube.com</code> API group</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">These custom resources store Moon configuration</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>For every user namespace Moon needs the following permissions:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 4. Required Moon Permissions For User Namespace</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Permission</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Purpose</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">To <strong>get</strong>, <strong>watch</strong>, <strong>list</strong>, <strong>create</strong>, <strong>delete</strong>, <strong>update</strong> and <strong>patch</strong> <a href="https://kubernetes.io/docs/concepts/workloads/pods/pod/">pods</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used to manipulate pods with browsers</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">To <strong>get</strong>, <strong>watch</strong>, <strong>list</strong>, <strong>create</strong>, <strong>delete</strong>, <strong>update</strong> and <strong>patch</strong> <a href="https://kubernetes.io/docs/concepts/configuration/configmap/">config maps</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used to pass users and groups to browser pods</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="moon2-vs-moon1"><a class="anchor" href="#moon2-vs-moon1"></a>1.5. Difference between Moon 2.x and Moon 1.x</h3>
<div class="paragraph">
<p>Moon 2.x is the new major Moon version adding a lot of improvements. This section summarizes the most notable changes.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Multiple Kubernetes namespaces</strong>. Moon 1.x allows to run all browsers in <strong>one</strong> Kubernetes namespace. However, the same Moon cluster is often being used by different teams. A common problem is limiting the maximum number of browsers available for every team. Limiting the number of browsers is the same as limiting the number of CPUs and memory available for every team. Kubernetes solves this problem by introducing <strong>namespaces</strong>. Namespaces can be considered as projects that can have some limited number of computing resources assigned by Kubernetes administrator. In Moon 2.x you can request to create an unlimited number of separate namespaces for browsers, one for every team, and then configure Moon to launch browsers in these namespaces. This gives Kubernetes administrator full control of resources consumption for every team. From the license key perspective - you are still using one license key but available licenses are automatically distributed across all browser namespaces depending on the load. In Moon 1.x in order to use separate namespaces for different teams you had to install a separate Moon instance to every namespace and use a different license key for every such instance. This sometimes prevented teams from requesting more browsers during the peak load. In Moon 2.x one big license key is automatically shared between namespaces and thus if licenses are available, every team during the peak load can request more browsers than it usually needs. Detailed description of how it looks like is provided in <a href="#">Architecture</a> section.</p>
</li>
<li>
<p><strong>Improved configuration</strong>. Moon 1.x is using <a href="https://json.org/">JSON</a> configuration files. For example Moon 1.x browsers list file is stored in Kubernetes config map and looks like this:</p>
<div class="listingblock">
<div class="title">Typical Moon 1.x Browsers List File</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">firefox</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">95.0</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">versions</span><span class="delimiter">&quot;</span></span>: {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">95.0</span><span class="delimiter">&quot;</span></span>: {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">image</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">browsers/firefox:95.0</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">port</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">4444</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">path</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">/wd/hub</span><span class="delimiter">&quot;</span></span>
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Moon 2.x instead if providing custom resources for configuration. For example browsers list file is now called a <strong>browser set</strong> and is a native Kubernetes citizen:</p>
</div>
<div class="listingblock">
<div class="title">Moon 2.x Browser Set</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">apiVersion</span>: <span class="string"><span class="content">moon.aerokube.com/v1</span></span>
<span class="key">kind</span>: <span class="string"><span class="content">BrowserSet</span></span>
<span class="key">metadata</span>:
  <span class="key">name</span>: <span class="string"><span class="content">default</span></span>
  <span class="key">namespace</span>: <span class="string"><span class="content">moon</span></span>
<span class="key">spec</span>:
  <span class="key">selenium</span>:
    <span class="key">firefox</span>:
      <span class="key">repository</span>: <span class="string"><span class="content">quay.io/browser/firefox</span></span>
    <span class="key">chrome</span>:
      <span class="key">repository</span>: <span class="string"><span class="content">quay.io/browser/chrome</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>You can easily inspect and update such objects with any compatible Kubernetes client, e.g.:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ kubectl get browsersets -n moon -o yaml # Show all available browser sets
$ kubectl edit browserset default -n moon</pre>
</div>
</div>
<div class="paragraph">
<p>The same applies to other configuration files and even to Moon license key manipulation:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ kubectl get license -n moon
NAME      LICENSEE          SESSIONS   EXPIRES
default   Acme Inc.         10         2022-10-11T18:38:42Z</pre>
</div>
</div>
<div class="paragraph">
<p>Every modification in such configuration objects is automatically validated by Kubernetes before saving, so it&#8217;s less error-prone.</p>
</div>
</li>
<li>
<p><strong>New browser versions are available automatically</strong>. Moon 1.x requires to add an image for every new browser version to browsers list file manually. If a browser version is missing, then Moon 1.x will not be able to start this browser. Moon 2.x contrarily only needs to configure a browser image repository for every browser type. Once configured - new browser versions are detected automatically.</p>
</li>
<li>
<p><strong>Improved browser performance</strong>. Moon 2.x is using completely new browser startup architecture that starts only required operating system components for current set of requested browser features. This leads to smaller browser images, faster startup and browser commands execution.</p>
</li>
<li>
<p><strong>Lower cloud resources consumption</strong>. Reworked browser startup architecture leads to at least 20% lower average cloud resources (CPU, memory, network traffic) consumption.</p>
</li>
<li>
<p><strong>Improved network communication</strong>. Moon 1.x relies on Kubernetes DNS implementation (e.g. <a href="https://github.com/coredns/coredns">CoreDNS</a>) for communicating with browser pods. DNS service is known to suffer from caching and cloud-specific networking issues which can in rare cases lead to broken browser sessions. Moon 2.x relies on pod IP addresses instead and does not depend on DNS at all.</p>
</li>
<li>
<p><strong>No built-in authentication</strong>. Moon 1.x supports only <a href="https://en.wikipedia.org/wiki/Basic_access_authentication">basic HTTP authentication</a>. Moon 2.x instead does not provide built-in authentication mechanism by default. Instead, you can use existing Kubernetes-compatible software (e.g. <a href="https://github.com/kubernetes/ingress-nginx">Nginx Ingress Controller</a>) to provide any authentication mechanism (e.g. <a href="https://www.cloudflare.com/learning/access-management/what-is-mutual-tls/">mutual TLS authentication</a>) you need. Moon derives user name from <code>Authorization</code> or <code>X-Moon-Quota</code> HTTP headers.</p>
</li>
<li>
<p><strong>OpenID Connect support</strong>. Moon 2.x comes with a ready-to-use sidecar container for using <a href="https://openid.net/connect/">OpenID Connect</a> authentication. This allows for example to easily use an existing private or public <a href="https://en.wikipedia.org/wiki/OAuth">OAuth</a> service. For example, you can easily load existing <a href="https://github.com/">Github</a> users like this.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="advantages"><a class="anchor" href="#advantages"></a>1.6. Moon vs other solutions</h3>
<div class="paragraph">
<p>Moon takes all the best practices and features from existing browser automation solutions and adds many more:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Browser automation Swiss army knife</strong>. Moon supports all the most popular browser automation tools (<a href="https://selenium.dev/">Selenium</a>, <a href="https://playwright.dev/">Playwright</a>, <a href="https://cypress.io/">Cypress</a>, <a href="https://pptr.dev/">Puppeteer</a>) out of the box. We automatically build and publish <a href="https://aerokube.com/images/latest/">images</a> for all new browser releases.</p>
</li>
<li>
<p><strong>Unlimited automatic scalability.</strong> You always have enough browsers of any desired version available in the cluster. When running the cluster in cloud platforms such as <a href="https://aws.amazon.com/">Amazon Web Services</a> or <a href="http://cloud.google.com/">Google Cloud</a> you can adjust settings to automatically scale depending on current load. This allows to combine efficiency with competitive cost.</p>
</li>
<li>
<p><strong>Completely stateless</strong>. Selenoid and Selenium Grid 3.x store in memory information about currently running browser sessions. Selenium Grid 4.x is using a key-value storage (e.g. <a href="https://redis.io/">Redis</a>) for the same purpose. If for some reason process that stores sessions list crashes then all running sessions are lost. Moon contrarily has no internal state and can be replicated across datacenters. Browser sessions remain alive even if one or more replicas go down.</p>
</li>
<li>
<p><strong>Fine-grained resources control</strong>. Moon allows to easily configure computing resources available for every used component. This leads to predictable computing resources consumption and overall cluster cost.</p>
</li>
<li>
<p><strong>Fully graceful</strong>. Any maintenance operations with the cluster do not interrupt running browser sessions. Every cluster component shuts down gracefully.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="main-features"><a class="anchor" href="#main-features"></a>2. Main Features</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="cypress"><a class="anchor" href="#cypress"></a>2.1. Using Cypress</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>This feature is supported in Moon 1.9.0 and above.</p>
</li>
<li>
<p>No changes in Cypress project are required.</p>
</li>
<li>
<p>An example project demonstrating this feature can be found <a href="https://github.com/aerokube/moon-cloud-cypress-example">here</a>.</p>
</li>
</ol>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Moon is able to run <a href="https://github.com/cypress-io/cypress/">Cypress</a> tests out of the box. To do this:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Install a tool allowing to execute Cypress tests remotely:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ npm install @aerokube/cypress-moon</code></pre>
</div>
</div>
</li>
<li>
<p>Run your tests against Moon cluster:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ cd /path/to/my-test-project
my-test-project$ cypress-moon https://moon.example.com/cypress/chrome</code></pre>
</div>
</div>
<div class="paragraph">
<p>Each call of <code>cypress-moon</code> command will start a new browser in Moon.</p>
</div>
</li>
</ol>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If your Moon instance is running behind <a href="https://kubernetes.io/docs/concepts/services-networking/ingress/">Ingress</a> then correct URL would usually be: <code><a href="https://moon.example.com/cypress/chrome" class="bare">https://moon.example.com/cypress/chrome</a></code>.</p>
</li>
<li>
<p>Running Cypress tests requires sending compressed project to Moon. If your Cypress project is big and Moon is running behind Ingress you may need to increase maximum HTTP request body size. For example <a href="https://github.com/kubernetes/ingress-nginx">Nginx Ingress Controller</a> requires the following annotation to be added:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">nginx.ingress.kubernetes.io/proxy-body-size</span>: <span class="string"><span class="content">128m</span></span></code></pre>
</div>
</div>
</li>
</ol>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Cypress compared to Selenium has no <a href="https://www.w3.org/TR/webdriver/#capabilities">capabilities</a> concept. The only way to request an exact browser type or additional features is passing all these requirements in HTTP endpoint URL. Next section describes supported URL naming conventions.</p>
</div>
<div class="sect3">
<h4 id="cypress-select-browser"><a class="anchor" href="#cypress-select-browser"></a>2.1.1. Selecting Requested Browser</h4>
<div class="paragraph">
<p>You can request one of browsers supported by Cypress (<code>chrome</code>, <code>chromium</code>, <code>edge</code>, <code>electron</code> or <code>firefox</code>) by specifying its name in URL. By default, Moon will use <code>browsers/cypress-&lt;browser-name&gt;:latest</code> public image.</p>
</div>
<div class="listingblock">
<div class="title">Requesting Chrome (<code>browsers/cypress-chrome:latest</code> image)</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ cypress-moon https://moon.example.com/cypress/chrome</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Requesting Chromium (<code>browsers/cypress-chromium:latest</code> image)</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ cypress-moon https://moon.example.com/cypress/chromium</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Requesting Electron (<code>browsers/cypress-electron:latest</code> image)</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ cypress-moon https://moon.example.com/cypress/electron</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Requesting Microsoft Edge (<code>browsers/cypress-edge:latest</code> image)</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ cypress-moon https://moon.example.com/cypress/edge</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Requesting Firefox (<code>browsers/cypress-firefox:latest</code> image)</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ cypress-moon https://moon.example.com/cypress/firefox</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="cypress-select-cypress-version"><a class="anchor" href="#cypress-select-cypress-version"></a>2.1.2. Selecting Exact Cypress Version</h4>
<div class="paragraph">
<p>Cypress API can change from version to version. Because of that it is recommended to make sure that Cypress version being used in your project corresponds to Cypress version in browser image. To use an image compatible with exact Cypress version - add this version as follows:</p>
</div>
<div class="listingblock">
<div class="title">Selecting an image compatible to Cypress 7.3.0 (<code>browsers/cypress-electron:cypress-7.3.0</code> image)</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ cypress-moon https://moon.example.com/cypress/electron/cypress-7.3.0</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="cypress-additional-features"><a class="anchor" href="#cypress-additional-features"></a>2.1.3. Enabling Additional Features</h4>
<div class="paragraph">
<p>In addition to selecting Cypress version - you can enable additional features like changing screen resolution, passing custom test name and so on. All these optional features are set by adding parameters to URL:</p>
</div>
<div class="listingblock">
<div class="title">Adding parameters to enable additional features</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ cypress-moon https://moon.example.com/cypress/electron/cypress-7.3.0?noExit=true&amp;headless=false&amp;env=LANG%3Dde_AT.UTF-8&amp;env=LANGUAGE%3Dat:de</code></pre>
</div>
</div>
<div class="paragraph">
<p>Full list of supported parameters and their meaning is shown below.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 5. Supported parameters for enabling additional features</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter name</th>
<th class="tableblock halign-left valign-top">Possible values</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">configFile</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Custom Cypress configuration file</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not set</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Path to custom Cypress <a href="https://docs.cypress.io/guides/references/configuration">configuration file</a>. <strong>Supported for Cypress 9.0.0 and above.</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">env</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Environment variables</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not set</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">One or more environment variables that will be visible to the browser. Can be passed multiple times: <code>env=LANG%3Dde_AT.UTF-8&amp;env=LANGUAGE%3Dat:de</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">headless</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code> or <code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether to run browser in headless mode.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">host</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A typical <code>/etc/hosts</code> entry in format <code>www.example.com:127.0.0.1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not set</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows to explicitly add <code>/etc/hosts</code> entries. Can be passed multiple times.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any human-readable string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not set</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows to set custom test name (same meaning as <code>name</code> Selenium capability).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nameserver</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DNS server name, e.g. <code>ns1.example.com</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not set</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows to explicitly set one or several DNS servers for browser. Can be passed multiple times.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">noExit</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code> or <code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether to leave container running after executing all tests. Mainly needed for debugging purposes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">screenResolution</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1280x1024</code> or <code>1280x1024x24</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1920x1080x24</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets resolution of the desktop where browser is running. <strong>Use Cypress methods to set browser window size.</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">spec</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cypress test spec file name (e.g. <code>cypress/integration/my-spec.js</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not set</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows to run one or more concrete test files. Can be passed multiple times.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="playwright"><a class="anchor" href="#playwright"></a>2.2. Using Playwright</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>This feature is supported in Moon 1.6.0 and above.</p>
</li>
<li>
<p>An example project demonstrating this feature can be found <a href="https://github.com/aerokube/moon-cloud-playwright-example">here</a>.</p>
</li>
</ol>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Moon is able to run browser images for <a href="https://github.com/microsoft/playwright">Playwright</a> framework out of the box. An example Playwright test that will work with Moon looks like the following:</p>
</div>
<div class="listingblock">
<div class="title">An example Playwright test working with Moon</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript">const { firefox } = require(<span class="string"><span class="delimiter">'</span><span class="content">playwright</span><span class="delimiter">'</span></span>);

(async () =&gt; {
  const browser = await firefox.connect({ <span class="key">timeout</span>: <span class="integer">0</span>, <span class="key">wsEndpoint</span>: <span class="string"><span class="delimiter">'</span><span class="content">wss://moon.example.com/playwright/firefox/playwright-1.17.1</span><span class="delimiter">'</span></span> });
  const page = await browser.newPage();
  await page.<span class="reserved">goto</span>(<span class="string"><span class="delimiter">'</span><span class="content">https://aerokube.com/moon/</span><span class="delimiter">'</span></span>);
  await page.screenshot({ <span class="key">path</span>: <span class="error">`</span>screenshot.png<span class="error">`</span> });
  await browser.close();
})();</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can see that the only difference from standard Playwright example is a web socket endpoint URL. Playwright compared to Selenium has no <a href="https://www.w3.org/TR/webdriver/#capabilities">capabilities</a> concept. The only way to request an exact browser version or environment variables is passing all these requirements in websocket endpoint URL. Next section describes supported URL naming conventions.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If your Moon instance is accessible over <a href="https://en.wikipedia.org/wiki/HTTPS">HTTPS</a> connection (e.g. <code><a href="https://moon.example.com/" class="bare">https://moon.example.com/</a></code> instead of <code><a href="http://moon.example.com/" class="bare">http://moon.example.com/</a></code>) then endpoint URL should start with <code>wss://</code> instead of <code>ws://</code> (e.g. <code>wss://moon.example.com/</code>).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="playwright-select-browser"><a class="anchor" href="#playwright-select-browser"></a>2.2.1. Selecting Requested Browser</h4>
<div class="paragraph">
<p>You can request one of browsers supported by Playwright (<code>firefox</code>, <code>chromium</code> or <code>webkit</code>) by specifying its name in URL. By default, Moon will use <code>playwright/&lt;browser-name&gt;:latest</code> public image.</p>
</div>
<div class="listingblock">
<div class="title">Requesting Chromium (<code>playwright/chromium:latest</code> image)</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">ws://moon.example.com:4444/playwright/chromium</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Requesting Firefox (<code>playwright/firefox:latest</code> image)</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">ws://moon.example.com:4444/playwright/firefox</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Requesting Webkit (<code>playwright/webkit:latest</code> image)</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">ws://moon.example.com:4444/playwright/webkit</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="playwright-select-browser-version"><a class="anchor" href="#playwright-select-browser-version"></a>2.2.2. Selecting Exact Browser Version</h4>
<div class="paragraph">
<p>Every browser version is distributed as a separate image tagged <code>playwright/&lt;browser-name&gt;:&lt;browser-version&gt;</code>. To use an exact browser version - add this version as follows:</p>
</div>
<div class="listingblock">
<div class="title">Selecting Firefox 94.0 (<code>playwright/firefox:94.0</code> image)</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">ws://moon.example.com:4444/playwright/firefox/94.0</code></pre>
</div>
</div>
<div class="paragraph">
<p>Full list of images can be found <a href="https://aerokube.com/images/latest/#_playwright">here</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="playwright-select-playwright-version"><a class="anchor" href="#playwright-select-playwright-version"></a>2.2.3. Selecting Exact Playwright Version</h4>
<div class="paragraph">
<p>Currently, Playwright API can change from version to version. Because of that it is recommended to make sure that Playwright client version being used in your code corresponds to Playwright server version in browser image. To use an image compatible with exact Playwright version - add this version as follows:</p>
</div>
<div class="listingblock">
<div class="title">Selecting an image compatible to Playwright 1.17.1 (<code>playwright/firefox:playwright-1.17.1</code> image)</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">ws://moon.example.com:4444/playwright/firefox/playwright-1.17.1</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="playwright-additional-features"><a class="anchor" href="#playwright-additional-features"></a>2.2.4. Enabling Additional Features</h4>
<div class="paragraph">
<p>In addition to selecting browser and its version - you can enable additional features like using headless browser versions, passing environment variables and so on. All these optional features are set by adding parameters to URL:</p>
</div>
<div class="listingblock">
<div class="title">Adding parameters to enable additional features</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">ws://moon.example.com:4444/playwright/chrome?headless=false&amp;arg=--use-gl</code></pre>
</div>
</div>
<div class="paragraph">
<p>Full list of supported parameters and their meaning is shown below.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 6. Supported parameters for enabling additional features</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter name</th>
<th class="tableblock halign-left valign-top">Possible values</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">arg</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Browser command-line arguments</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not set</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">One or more additional command-line arguments to be passed to browser. This parameter can be passed multiple times: <code>arg=--use-fake-ui-for-media-stream&amp;arg=--use-gl</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">devtools</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code> or <code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether to show Chrome Developer Toolbar (only applicable to <code>chromium</code> browser).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">env</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Environment variables</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not set</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">One or more environment variables that will be visible to the browser. Can be passed multiple times: <code>env=LANG%3Dde_AT.UTF-8&amp;env=LANGUAGE%3Dat:de</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">headless</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code> or <code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether to run browser in headless mode.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">host</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A typical <code>/etc/hosts</code> entry in format <code>www.example.com:127.0.0.1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not set</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows to explicitly add <code>/etc/hosts</code> entries. Can be passed multiple times.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any human-readable string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not set</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows to set custom test name (same meaning as <code>name</code> Selenium capability).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nameserver</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DNS server name, e.g. <code>ns1.example.com</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not set</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows to explicitly set one or several DNS servers for browser. Can be passed multiple times.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">screenResolution</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1280x1024</code> or <code>1280x1024x24</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1920x1080x24</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets resolution of the desktop where browser is running. <strong>Use Playwright methods to set browser window size.</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">timeZone</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Europe/Moscow</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time zone set to Moon</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets time zone being used by browser.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="devtools"><a class="anchor" href="#devtools"></a>2.3. Accessing Chrome Developer Tools</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>This is feature is supported in Moon 1.7.0 and above.</p>
</li>
<li>
<p>This feature will work only for Chrome 63+.</p>
</li>
<li>
<p>We recommend using the most recent Chrome version possible.</p>
</li>
<li>
<p>An example project demonstrating this feature can be found <a href="https://github.com/aerokube/moon-cloud-puppeteer-example">here</a>.</p>
</li>
</ol>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Moon can automate browsers using <a href="https://chromedevtools.github.io/devtools-protocol/">Chrome Developer Tools Protocol</a>. This allows you to run tests in parallel using libraries like <a href="https://github.com/puppeteer/puppeteer">Puppeteer</a> or <a href="https://github.com/getgauge/taiko">Taiko</a>. In order to start a new browser with these tools - simply use the following URL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">wss://moon.example.com/cdtp/chrome</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If your Moon instance is accessible over <a href="https://en.wikipedia.org/wiki/HTTPS">HTTPS</a> connection (e.g. <code><a href="https://moon.example.com/" class="bare">https://moon.example.com/</a></code> instead of <code><a href="http://moon.example.com/" class="bare">http://moon.example.com/</a></code>) then URL should start with <code>wss://</code> instead of <code>ws://</code> (e.g. <code>wss://moon.example.com/</code>).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>An example Puppeteer test is shown below:</p>
</div>
<div class="listingblock">
<div class="title">Accessing Developer Tools API with Puppeteer</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript">const puppeteer = require(<span class="string"><span class="delimiter">'</span><span class="content">puppeteer-core</span><span class="delimiter">'</span></span>);
const host = <span class="string"><span class="delimiter">'</span><span class="content">moon.example.com</span><span class="delimiter">'</span></span>;
(async () =&gt; {
    const devtools = await puppeteer.connect(
        { <span class="key">timeout</span>: <span class="integer">0</span>, <span class="key">browserWSEndpoint</span>: <span class="error">`</span>wss:<span class="comment">//${host}/cdtp/chrome` }</span>
    ); <span class="comment">// For every call of this method a new browser is started</span>
    const page = await devtools.newPage();
    await page.<span class="reserved">goto</span>(<span class="string"><span class="delimiter">'</span><span class="content">https://aerokube.com</span><span class="delimiter">'</span></span>);
    await page.screenshot({<span class="key">path</span>: <span class="string"><span class="delimiter">'</span><span class="content">screenshot.png</span><span class="delimiter">'</span></span>});
    const title = await page.title();

    console.log(title);

    await devtools.close();
})();</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="devtools-select-browser"><a class="anchor" href="#devtools-select-browser"></a>2.3.1. Selecting Requested Browser</h4>
<div class="paragraph">
<p>You can choose desired browser version by changing connection URL:</p>
</div>
<div class="listingblock">
<div class="title">Selecting Chrome version (<code>cdtp/chrome:85.0</code> image)</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">wss://moon.example.com/cdtp/chrome/85.0</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="devtools-additional-features"><a class="anchor" href="#devtools-additional-features"></a>2.3.2. Enabling Additional Features</h4>
<div class="paragraph">
<p>You can enable additional features by changing connection URL:</p>
</div>
<div class="listingblock">
<div class="title">Adding parameters to enable additional features</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">wss://moon.example.com/cdtp/chrome?headless=false&amp;nameserver=ns1.example.com</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 7. Supported parameters for enabling additional features</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter name</th>
<th class="tableblock halign-left valign-top">Possible values</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">arg</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Browser command-line arguments</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not set</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">One or more additional command-line arguments to be passed to browser. This parameter can be passed multiple times: <code>arg=--use-fake-ui-for-media-stream&amp;arg=--use-gl</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">devtools</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code> or <code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether to show Chrome Developer Toolbar.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">env</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Environment variables</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not set</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">One or more environment variables that will be visible to the browser. Can be passed multiple times: <code>env=LANG%3Dde_AT.UTF-8&amp;env=LANGUAGE%3Dat:de</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">headless</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code> or <code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether to run browser in headless mode.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">host</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A typical <code>/etc/hosts</code> entry in format <code>www.example.com:127.0.0.1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not set</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows to explicitly add <code>/etc/hosts</code> entries. Can be passed multiple times.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any human-readable string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not set</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows to set custom test name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nameserver</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DNS server name, e.g. <code>ns1.example.com</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not set</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows to explicitly set one or several DNS servers for browser. Can be passed multiple times.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">screenResolution</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1280x1024</code> or <code>1280x1024x24</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1920x1080x24</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets resolution of the desktop where browser is running.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">timeZone</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Europe/Moscow</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time zone set to Moon</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets time zone being used by browser.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuration"><a class="anchor" href="#configuration"></a>3. Configuration</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="license"><a class="anchor" href="#license"></a>3.1. Installing a License</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>According to license agreement you can use <strong>up to 4 parallel sessions without a license</strong>. If you wish to have more parallel sessions - order a license and follow this section steps to install the license. A trial license key with more parallel sessions can be generated on <a href="https://aerokube.com/moon/">Moon website</a>.</p>
</li>
</ol>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To install a license you should have a license key file. A typical license file looks like this:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ cat license.key
Ti90a3ljSWpvV3hicU5ZY3U3ZVNMUzdzalVjU29nSVU2a3lmWDdENmhOSEs4SFJVVE5LNEpKL2oxRGhWTnRhZVBEQmx5cm1SM0dFWlVpbGIwOWhBSUpvWmlQMnNtYmtoZVRDbnJ3UTlIV3grMUMzaXFJalU3L0NIZDJuSzN3QUpIS0lyV2VoVjlRVUh5NzNCMFg0NEV5KzFSVXg1elhvaC9RUkNjTlBIOHR4WWtrRFBmTFhxYTFESlI0aXNObGtobWpXY2VJNVdna1lsWHFFOUp0OUxValZPN05hb2pCcHJzY0pvZjBrZys2YkhWUDR3cUJvYVFoSFJTYzMzZzNRSTkrWVd4dlZCeExmdTVxM2k2ZnluMDRHSEhGc21Fd2owVHdVa1Z3MmI5Z2FyVXlaVFF4RDdCRjVSVjBmSUVrU1pEQ0ZQdmIvMHZoKythY1V4OVRrR2FBREZzbWR3dExxRlU4NHF3MzBVdE5nTGhnNWYxRXRCQ215R1BHR0wyK2NpR0RDZDBTSXg4K1RsRGNWVzUyVVY4MUt6bkdOanJhTklOeXVtYjVPVXF6aVVpdmJZeVJNVVBSMWF3NUJRVGJDaHVycWVVdGtMMWFRZDgwOCtoWGRxODFOakxRNEJlVENNQTdPL2FneHBTUE1nL0J2QmVQKy84ZGhJeXd5Y0lxQVJhVWxocUdmUko2K05tbkFYV0hzZ2RjTng1dUVHU0w5VWF5TU1rR3RkZEZKQ1FiWmF0RnJMaDFHbHhKTndBRHFWcXIvQ0oxSzBQL2p6K2NFSWpsSG82TktvM3pudVFlanhYT2tGU1p1bWZrS1krZmF3VkVRZWlvcFlmZFk0TU9tc3U5TThsbng3T2VXQXZmOTFUQ2w1NUhBK1ZsQTMzN3VFOG1WV3ZlS0E1Tlk9O2V5SnNhV05sYm5ObFpTSTZJa0ZqYldVZ1RFeERJaXdpY0hKdlpIVmpkQ0k2SWsxdmIyNGlMQ0p0WVhoVFpYTnphVzl1Y3lJNk1qQXNJblJ2SWpveE5UTTRNelV5TURBd2ZRPT0=</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="monitoring"><a class="anchor" href="#monitoring"></a>3.2. Monitoring</h3>
<div class="paragraph">
<p>You can easily visualize browsers consumption and other Moon metrics with <a href="https://prometheus.io/">Prometheus</a> and <a href="https://grafana.com/">Grafana</a>. One of the simplest ways of deploying Prometheus in Kubernetes is using <a href="https://github.com/coreos/prometheus-operator">Prometheus Operator</a>.</p>
</div>
<div class="sect3">
<h4 id="monitoring-setup"><a class="anchor" href="#monitoring-setup"></a>3.2.1. Setup</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Moon should be already running (e.g. in <code>moon</code> namespace).</p>
</li>
<li>
<p>Deploy Prometheus and Grafana using Prometheus Operator (e.g. to <code>monitoring</code> namespace).</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>An example installation command using Helm 3 is:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ helm repo add prometheus-community https://prometheus-community.github.io/helm-charts
$ helm repo update
$ helm install kube-prometheus-stack prometheus-community/kube-prometheus-stack --create-namespace --namespace monitoring</pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Having a configured Prometheus instance you have two ways of getting metrics: <strong>using built-in Moon metrics</strong> and <strong>filtering browser pods by labels</strong>.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="monitoring-built-in-metrics"><a class="anchor" href="#monitoring-built-in-metrics"></a>3.2.2. Built-in Moon metrics</h4>
<div class="paragraph">
<p>Built-in Moon metrics are exposed on the standard <code>/metrics</code> HTTP API on port <code>4444</code> (<code>moon</code> container of the Moon pod). The following metrics are available:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 8. Moon Built-in Prometheus Metrics</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Labels</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">moon_browser_limit</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum number of browser sessions allowed by installed license key</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">moon_browser_running</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Total number of currently running browser sessions</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">moon_browser_count</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">quota, browserName, browserVersion</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Browser consumption corresponding to exact browser name and version</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">moon_browser_queued</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Total number of browser requests in queue</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">moon_license_expire</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">gauge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Moon license key expiration timestamp</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="filter-by-labels"><a class="anchor" href="#filter-by-labels"></a>3.2.3. Filtering Browser Pods by Labels</h4>
<div class="paragraph">
<p>Installing Prometheus with <code>kube-prometheus-stack</code> will also automatically install <a href="https://github.com/kubernetes/kube-state-metrics">kube-state-metrics</a> component. This component allows you to filter Kubernetes pods by labels, annotations, status, start time and so on. To fetch information about browser pods with some labels set, use the following Prometheus query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>kube_pod_labels{label_moon="browser", label_browserName="chrome", label_browserVersion="96.0"}</pre>
</div>
</div>
<div class="paragraph">
<p>Full list of available expressions can be found <a href="https://github.com/kubernetes/kube-state-metrics/blob/master/docs/pod-metrics.md">here</a>.</p>
</div>
<div class="paragraph">
<p>Moon can add custom labels to started browser pods (e.g. browser automation project name, tested feature name and so on). This can be done globally in using <a href="labels.html">browsers list</a>, <a href="special-capabilities.html#capability-labels">Selenium capabilities</a> and so on. For example, after having a label <code>project="MyCoolProject"</code> on browser pods, you can filter such pods like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>kube_pod_labels{label_moon="browser", label_project="MyCoolProject", label_browserName="chrome"}</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_log_files"><a class="anchor" href="#_log_files"></a>3.3. Log Files</h3>
<div class="paragraph">
<p>Although Moon should just work out of the box, sometimes you may need the log output. Every Moon component is outputting logs to standard output (<code>stdout</code>), so you can use well-known <code>kubectl</code> commands to see the log. Everything related to browser sessions is being output by <code>moon</code> container:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ kubectl logs -lapp=moon -c moon -n moon</pre>
</div>
</div>
<div class="paragraph">
<p>To follow the logs while running the tests add <code>-f</code> flag:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ kubectl logs -f -lapp=moon -c moon -n moon</pre>
</div>
</div>
<div class="paragraph">
<p>You can also take a look at <code>moon-conf</code> and <code>moon-ui</code> logs as follows:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ kubectl logs -f -lapp=moon -c moon-api -n moon
$ kubectl logs -f -lapp=moon -c moon-ui -n moon</pre>
</div>
</div>
<div class="paragraph">
<p>If you are encountering browser pods not being deleted - then take a look at <code>defender</code> container logs for every frozen browser pod:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ kubectl logs chrome-73-0-ac15ffaa-e641-4c7f-a54c-f25b5be1f135 -c defender -n moon</pre>
</div>
</div>
<div class="paragraph">
<p>Here <code>chrome-73-0-ac15ffaa-e641-4c7f-a54c-f25b5be1f135</code> is the browser session ID equal to browser pod name.</p>
</div>
</div>
<div class="sect2">
<h3 id="_cli_flags"><a class="anchor" href="#_cli_flags"></a>3.4. CLI Flags</h3>
<div class="paragraph">
<p>These flags should be <a href="https://kubernetes.io/docs/tasks/inject-data-application/define-command-argument-container/#define-a-command-and-arguments-when-you-create-a-pod">specified</a> in Kubernetes YAML files when starting the cluster.</p>
</div>
<div class="sect3">
<h4 id="cli-flags-moon"><a class="anchor" href="#cli-flags-moon"></a>3.4.1. Moon Container Flags</h4>
<div class="paragraph">
<p>The following flags are supported:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>-browser-service-account string
    browser service account name (default "default")
-cpu-limit value
    browser container cpu limit (default 2)
-cpu-request value
    browser container cpu request (default 1)
-delete-timeout duration
    timeout to delete Kubernetes resources (default 10m0s)
-disable-cpu-limits
    disable cpu limits for pods
-disable-memory-limits
    disable memory limits for pods
-grace-period duration
    graceful shutdown period (default 5m0s)
-license-key string
    path to license file
-listen string
    host and port to listen to (default ":4444")
-memory-limit value
    browser container memory limit (default 2Gi)
-memory-request value
    browser container memory request (default 2Gi)
-moon-url value
    moon service url (default http://moon.moon:4444/wd/hub)
-session-attempt-timeout duration
    new session attempt timeout (default 30m0s)
-timeout duration
    override session timeout (default 1m0s)
-version
    show version and exit</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="cli-flags-moon-conf"><a class="anchor" href="#cli-flags-moon-conf"></a>3.4.2. Moon Conf Container Flags</h4>
<div class="paragraph">
<p>The following flags are supported:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>-license-key string
    path to license file (default "license/license.key")</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_frequently_asked_questions"><a class="anchor" href="#_frequently_asked_questions"></a>4. Frequently Asked Questions</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="faq-moon-logs"><a class="anchor" href="#faq-moon-logs"></a>4.1. Where are Moon logs?</h3>
<div class="paragraph">
<p>See <a href="#">Log Files</a> section.</p>
</div>
</div>
<div class="sect2">
<h3 id="faq-recorded-videos"><a class="anchor" href="#faq-recorded-videos"></a>4.2. Where are recorded videos stored?</h3>
<div class="paragraph">
<p>Moon automatically saves session logs and recorded video files to <a href="https://en.wikipedia.org/wiki/Amazon_S3">S3</a> compatible storage. If S3 storage is not configured - then video recording will not work.</p>
</div>
</div>
<div class="sect2">
<h3 id="faq-update-configuration"><a class="anchor" href="#faq-update-configuration"></a>4.3. How to update configuration of a running Moon cluster?</h3>
<div class="paragraph">
<p>Just update respective custom resources (<code>config</code>, <code>browserset</code>, <code>deviceset</code>, <code>quota</code>) with standard Kubernetes commands (<code>kubectl edit</code> or <code>kubectl replace</code>). For example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ kubectl edit config default -n moon # Updating global Moon configuration
$ kubectl edit browserset default -n moon # Updating Moon browsers list
$ kubectl edit deviceset users -n moon # Updating Moon devices list
$ kubectl edit quota default -n moon # Updating Moon quota</pre>
</div>
</div>
<div class="paragraph">
<p>These commands will open your preferred editor with respective data: do any desired modifications, save and exit. Changes are applied immediately.</p>
</div>
</div>
<div class="sect2">
<h3 id="faq-kubernetes-service-account"><a class="anchor" href="#faq-kubernetes-service-account"></a>4.4. Is it possible to configure Kubernetes service account for Moon?</h3>
<div class="paragraph">
<p>Yes, Moon has <code>-browser-service-account</code> flag described in <a href="#cli-flags-moon">Moon Container Flags</a> section.</p>
</div>
</div>
<div class="sect2">
<h3 id="faq-custom-firewall-rules"><a class="anchor" href="#faq-custom-firewall-rules"></a>4.5. Is it possible to assign custom firewall rules to browser pods?</h3>
<div class="paragraph">
<p>Yes, using built-in <a href="https://kubernetes.io/docs/concepts/services-networking/network-policies/">Kubernetes Network Policies</a> feature. Moon already can assign custom labels to running browser pods. To apply a firewall rule to browser pods you need to assign a set of custom labels to these pods and then create a <code>NetworkPolicy</code> matching pods with <code>podSelector</code> using these labels.</p>
</div>
</div>
<div class="sect2">
<h3 id="faq-connection-closed-unexpectedly"><a class="anchor" href="#faq-connection-closed-unexpectedly"></a>4.6. Connection was closed unexpectedly</h3>
<div class="paragraph">
<p>If your HTTP requests are randomly hanging - this can mean that you can have too low HTTP request timeout value on your network load balancer (<code>LoadBalancer</code>, <code>Ingress</code>, Openshift <code>Route</code>). Very often default value is about <code>30 seconds</code> and this can lead to closed connections when a lot of new Selenium session requests are being sent to Moon. How to set timeout setting usually depends on cloud platform you are using. For example in AWS this can look like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">kind</span>: <span class="string"><span class="content">Service</span></span>
<span class="key">apiVersion</span>: <span class="string"><span class="content">v1</span></span>
<span class="key">metadata</span>:
  <span class="key">name</span>: <span class="string"><span class="content">moon</span></span>
  <span class="key">namespace</span>: <span class="string"><span class="content">moon</span></span>
  <span class="key">annotations</span>:
    <span class="key">service.beta.kubernetes.io/aws-load-balancer-connection-idle-timeout</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">60</span><span class="delimiter">&quot;</span></span> <span class="comment"># AWS load balancer timeout setting</span>
<span class="key">spec</span>:
  <span class="key">type</span>: <span class="string"><span class="content">LoadBalancer</span></span>
  <span class="comment"># The rest of spec goes here...</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="faq-dns-lookup-timeouts"><a class="anchor" href="#faq-dns-lookup-timeouts"></a>4.7. DNS lookup timeouts</h3>
<div class="paragraph">
<p>If you are using <a href="https://github.com/coreos/flannel">Flannel</a> as Kubernetes networking engine and receiving DNS lookup timeouts like the following&#8230;&#8203;</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>2019/02/21 08:37:32 [VNC_ERROR] [10.244.1.1] [dial tcp: lookup chrome-71-0-686efb96-eabe-4435-af31-21a33c8a4c8b on 10.96.0.10:53: read udp 10.244.1.11:40603-&gt;10.96.0.10:53: i/o timeout]</code></pre>
</div>
</div>
<div class="paragraph">
<p>&#8230;&#8203;then you may need to set the following kernel property on Kubernetes nodes:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>$ sysctl net.bridge.bridge-nf-call-iptables=1</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="faq-session-timeouts-do-no-work"><a class="anchor" href="#faq-session-timeouts-do-no-work"></a>4.8. Browser session timeouts do not work</h3>
<div class="paragraph">
<p>This could because of incorrectly set <code>-moon-url</code> flag value. By default Moon is being exposed using Kubernetes service named <code>moon</code> and is available on port <code>4444</code>. In that case everything works out of the box with default <code>-moon-url</code> flag value. In customized deployment your Moon service name can differ and you have to set <code>-moon-url</code> value flag explicitly. For example, having Moon being exposed with service named <code>my-custom-moon-service</code> on port <code>3333</code>, you have to explicitly add flag <code>-moon-url <a href="http://my-custom-moon-service:3333/wd/hub" class="bare">http://my-custom-moon-service:3333/wd/hub</a></code> to your deployment manifests.</p>
</div>
</div>
<div class="sect2">
<h3 id="faq-json-errors"><a class="anchor" href="#faq-json-errors"></a>4.9. JSON processing errors in tests</h3>
<div class="paragraph">
<p>In some environments your Selenium tests could from time to time start getting JSON processing errors like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>Json exception: Expected to read a START_MAP but instead have: END. Last 0 characters read</code></pre>
</div>
</div>
<div class="paragraph">
<p>The main reason of such behavior usually is incorrectly configured request proxy timeout on <code>LoadBalancer</code> or <code>Ingress</code> time. Very frequently default timeout value is <code>60 seconds</code> and in cases when some Selenium operation takes more time, load balancer will abort request and send 502 error with no body or with HTML body. However Selenium clients always expect to have JSON in Selenium response body and anything else leads to JSON processing exceptions. To solve this - increase request timeout on load balancer side. How to do this should be described in load balancer documentation.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_license_agreement"><a class="anchor" href="#_license_agreement"></a>5. License Agreement</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Last updated December 17th, 2021. Replaces the prior version in its entirety.</p>
</div>
<div class="paragraph">
<p>This is a legal agreement. By downloading, installing, copying, saving on Customer&#8217;s computer, or otherwise using Aerokube software, support or products Customer becomes a party to this Agreement and Customer consents to be bound by all the terms and conditions set forth below.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Parties</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><strong>"Aerokube"</strong>, <strong>"Licensor"</strong> or <strong>"We"</strong> means <strong>Aerokube Software OÜ</strong>, having its principal place of business at Harju maakond, Tallinn, Kesklinna linnaosa, Estonia pst 5-309B, 10143, Estonia, registered in the Commercial Register of Estonia, registry code: 14653208.</p>
</li>
<li>
<p><strong>"Customer"</strong>, <strong>"Licensee"</strong> or <strong>"You"</strong> means the sole proprietor or legal entity specified in the Subscription Confirmation. For legal entities, "Customer" includes any entity which controls, is controlled by, or is under common control with Customer. For the purposes of this definition, "control" means one of the following:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>The power, directly or indirectly, to direct or manage such entity, whether by contract or otherwise.</p>
</li>
<li>
<p>Ownership of fifty percent (50%) or more of the outstanding shares or beneficial ownership of such entity.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
<li>
<p><strong>Definitions</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><strong>"Agreement"</strong> means this License Agreement.</p>
</li>
<li>
<p><strong>"Product"</strong> means any generally available Licensor&#8217;s software product identified by Licensor as a software developer tool. For the avoidance of doubt, the Product is not produced to the specifications of Customer nor customized through modification or personalization, is intended for mass distribution, and no software code will be provided to Customer.</p>
</li>
<li>
<p><strong>"User"</strong> means any employee, independent contractor or other personnel obtaining access to the Product(s) from Customer.</p>
</li>
<li>
<p><strong>"Number of Concurrent Sessions"</strong> means maximum number of software testing processes being run using the Product in parallel. This can be for example browsers executing User&#8217;s tests.</p>
</li>
<li>
<p><strong>"License Key"</strong> means a unique key-code that enables a Licensee to use the Product by unlocking the fixed Number of Concurrent Sessions. Only Licensor and/or its representatives are permitted to produce License Keys for the Product.</p>
</li>
<li>
<p><strong>"Subscription"</strong> means an arrangement for making use of the Product of periodic nature on a prepayment plan. For the purpose of clarity, Subscription includes the subscription term, Products provided to Customer, subscription fees, payment schedules and fixed number of License Keys.</p>
</li>
<li>
<p><strong>"Product Evaluation"</strong> means using the Product without a valid License Key.</p>
</li>
<li>
<p><strong>"Subscription Confirmation"</strong> means an email confirming Customer&#8217;s rights to access and use Products, including total Number of Concurrent Sessions.</p>
</li>
<li>
<p><strong>"Product Installation"</strong> means a Product copy running on Customer&#8217;s computer device, hardware server or virtual machine.</p>
</li>
<li>
<p><strong>"Product Version"</strong> means a release, update, or upgrade of a particular Product that is not identified by Licensor as being made for the purpose of fixing software bugs.</p>
</li>
<li>
<p><strong>"Bug Fix Update"</strong> for a particular Product Version means a software update or release that is specifically identified by Licensor as a bug fix for that Product Version.</p>
</li>
<li>
<p><strong>"E-mail Support"</strong> means a form of customer support provided by the Licensor. At the time of writing, the corresponding e-mail address is <strong>support@aerokube.com</strong>; should the address be changed, the new address will be referred to on the Licensor&#8217;s web site.</p>
</li>
<li>
<p><strong>"Instant Messaging Support"</strong> means a form of customer support provided by the Licensor. At the time of writing, the corresponding address to support channel is <strong><a href="https://t.me/aerokube_moon" class="bare">https://t.me/aerokube_moon</a></strong>; should the address be changed, the new address will be referred to on the Licensor&#8217;s web site.</p>
</li>
<li>
<p><strong>"Affiliate"</strong> means any entity belonging to the same group as the Licensor.</p>
</li>
</ol>
</div>
</li>
<li>
<p><strong>How this Agreement Works</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><strong>Entire Agreement.</strong> This Agreement, including the Third-Party Software license terms, constitutes the entire agreement between the parties concerning its subject matter and supersedes any prior agreements between Customer and Licensor regarding Customer&#8217;s use of any Products. No purchase order, other ordering document or any handwritten or typewritten text which purports to modify or supplement the printed text of this Agreement or any schedule will add to or vary the terms of this Agreement unless signed by both Customer and Licensor.</p>
</li>
<li>
<p><strong>Reservation of Rights.</strong> Aerokube reserves the right at any time to cease the support of the Product and to alter prices, features, specifications, capabilities, functions, terms of use, release dates, general availability or other characteristics of the Product.</p>
</li>
<li>
<p><strong>Changes to this Agreement.</strong> We may update or modify this Agreement from time to time, including any referenced policies and other documents. If a revision meaningfully reduces Customer&#8217;s rights, we will use reasonable efforts to notify Customer. If we modify this Agreement, the modified version of the Agreement will be effective from the start of the next Subscription term. In this case, if Customer objects to the updated Agreement terms, as Customer&#8217;s exclusive remedy, Customer may cancel the Subscription. Customer may be required to click through the updated Agreement to show its acceptance. For the avoidance of doubt, each Subscription Confirmation is subject to the version of the Agreement in effect on the Subscription Confirmation date.</p>
</li>
<li>
<p><strong>Opportunity to Review.</strong> Customer hereby declares that Customer has had sufficient opportunity to review this Agreement, understand the content of all of its clauses, negotiate its terms, and seek independent professional legal advice in that respect before entering into it. Consequently, any statutory "form contract" ("adhesion contract") regulations shall not be applicable to this Agreement.</p>
</li>
<li>
<p><strong>Severability.</strong> If a particular term of this Agreement is not enforceable, the unenforceability of that term will not affect any other terms of this Agreement.</p>
</li>
<li>
<p><strong>Headings.</strong> Headings and titles are for convenience only and do not affect the interpretation of this Agreement.</p>
</li>
<li>
<p><strong>No Waiver.</strong> Our failure to enforce or exercise any part of this Agreement is not a waiver of that section.</p>
</li>
<li>
<p><strong>Notice.</strong> Aerokube may deliver any notice to Customer via electronic mail to an email address provided by Customer, registered mail, personal delivery or renowned express courier (such as DHL, FedEx or UPS). Any such notice will be deemed to be effective:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>On the day the notice is sent to Customer via email.</p>
</li>
<li>
<p>Upon personal delivery.</p>
</li>
<li>
<p>One (1) day after deposit with an express courier or five (5) days after deposit in the mail, whichever occurs first.</p>
</li>
</ol>
</div>
</li>
<li>
<p><strong>Governing Law.</strong> This Agreement will be governed by the laws of the Estonia, without reference to conflict of laws principles. Customer agrees that any litigation relating to this Agreement may only be brought in, and will be subject to the jurisdiction of, any competent court of the Estonia. The parties agree that the United Nations Convention on Contracts for the International Sale of Goods does not apply to this Agreement.</p>
</li>
<li>
<p><strong>Exceptions or Modifications.</strong> For exceptions or modifications to this Agreement, please contact Aerokube at: <a href="mailto:support@aerokube.com">support@aerokube.com</a> In case the terms of this Agreement are in conflict with the terms of any agreement individually negotiated and agreed between Aerokube and Customer, the terms of the latter shall prevail.</p>
</li>
<li>
<p><strong>Force Majeure.</strong> Except with respect to Customer’s payment obligations, neither party shall be liable to the other for any delay or failure to perform any obligation under this Agreement (except for a failure to pay fees) if the delay or failure is due to unforeseen events which occur after the signing of this Agreement and which are beyond the reasonable control of such party (<strong>"Force Majeure Event"</strong>), such as a strike, blockade, war, act of terrorism, riot, natural disaster, failure or diminishment of power or telecommunications or data networks or services, or refusal of a license by a government agency. In the event of a Force Majeure Event that prevents one part from substantially performing its obligations hereunder for a period of ten (10) days or more, either party may terminate this Agreement on five (5) days written notice.</p>
</li>
</ol>
</div>
</li>
<li>
<p><strong>Grant of Rights</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The Product include code and libraries licensed to Licensor by third parties, including open source software.</p>
</li>
<li>
<p>The Product is provided basing on the Number of Concurrent Sessions. If Customer complies with the terms of this Agreement, Customer has the rights stipulated hereunder for each Subscription that Customer acquires. Customer&#8217;s rights acquired in relation to the Product are limited to those necessary to enable Customer and its Users to effectively operate the Product(s). All other rights remain reserved to Licensor.</p>
</li>
<li>
<p>Unless the Subscription has expired or this Agreement is terminated in accordance with respective section, and subject to the terms and conditions specified herein, Licensor grants Customer a non-exclusive and non-transferable right to use each Product covered by the Subscription as stipulated below.</p>
</li>
<li>
<p>Customer <strong>may</strong>:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>For each License Key included to Subscription have <strong>one</strong> Product Installation of any version covered by the Subscription on any operating system supported by the Product.</p>
</li>
<li>
<p>Do Product Evaluation on <strong>one</strong> Product Installation of any version on any operating system supported by the Product.</p>
</li>
<li>
<p>Make one backup copy of the Product solely for archival/security backup purposes.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Customer <strong>may not</strong>:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Allow the same Product Installation to be used concurrently by more than the Number of Concurrent Sessions specified for used License Key in Subscription Confirmation.</p>
</li>
<li>
<p>Rent, lease, reproduce, modify, adapt, create derivative works of, distribute, sell, or transfer the Product.</p>
</li>
<li>
<p>Provide access to the Product or the right to use the Product to a third party.</p>
</li>
<li>
<p>Reverse engineer, decompile, disassemble, modify, translate, make any attempt to discover the source code of the Product.</p>
</li>
<li>
<p>Remove or obscure any proprietary or other notices contained in the Product.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Customer acknowledges that no ownership right is conveyed to Customer under this Agreement, irrespective of the use of terms such as "purchase" or "sale". Licensor has and retains all rights, title and interest, including all intellectual property rights, in and to the Products and any and all related or underlying technology, and any modifications or derivative works thereof, including without limitation as they may incorporate Feedback (as defined below).</p>
</li>
<li>
<p>This Agreement applies whether Customer purchases a Subscription directly from Licensor or through resellers. If Customer purchases through a reseller, the Subscription details shall be as stated in the Subscription Confirmation issued by the reseller to Customer, and the reseller is responsible for the accuracy of any such Subscription Confirmation. Resellers are not authorized to make any promises or commitments on Licensor behalf, and Customer understands and agrees that Licensor is not bound by any obligations to Customer other than as specified in this Agreement.</p>
</li>
</ol>
</div>
</li>
<li>
<p><strong>Access to Products</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>All deliveries under this Agreement will be electronic. Customer and its Users must have an Internet connection in order to receive any deliveries. For the avoidance of doubt, Customer is responsible for downloading and installing the Products. Download instructions are made available on Licensor website at <a href="https://aerokube.com/moon/" class="bare">https://aerokube.com/moon/</a>.</p>
</li>
<li>
<p>Customer enables full access to Product Installation by specifying a License Key from Subscription Confirmation.</p>
</li>
<li>
<p>Subject to the terms of this Agreement, Customer is granted a right to install and use the Product for evaluation purposes without charge for unlimited amount of time. The Product contains a feature that will automatically limit allowed Number of Concurrent Sessions. Licensor reserves the right at any time to change that limit in new Product versions.</p>
</li>
</ol>
</div>
</li>
<li>
<p><strong>Fees</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Customer shall pay its Subscription fees in accordance with Licensor Terms of Purchase or the reseller&#8217;s terms of purchase, whichever are applicable.</p>
</li>
<li>
<p>The Subscription fees shall be paid in full, and any levies, duties and/or taxes imposed by Customer&#8217;s jurisdiction (including, but not limited to, value added tax, sales tax and withholding tax), shall be borne solely by Customer.</p>
</li>
<li>
<p>Customer may not deduct any amounts from fees payable to Licensor or the reseller, unless otherwise specified in the applicable terms of purchase.</p>
</li>
</ol>
</div>
</li>
<li>
<p><strong>Feedback</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Customer has no obligation to provide Licensor with ideas, suggestions, or proposals ("Feedback").</p>
</li>
<li>
<p>If Customer or Users submit Feedback to Licensor, then Customer grants Licensor a non-exclusive, worldwide, royalty-free license that is sub-licensable and transferable, to make, use, sell, have made, offer to sell, import, reproduce, publicly display, distribute, modify, or publicly perform the Feedback in any manner without any obligation, royalty or restriction based on intellectual property rights or otherwise.</p>
</li>
</ol>
</div>
</li>
<li>
<p><strong>LIMITED WARRANTY</strong></p>
<div class="paragraph">
<p>ALL PRODUCTS ARE PROVIDED TO CUSTOMER ON AN <strong>"AS IS"</strong> AND <strong>"AS AVAILABLE"</strong> BASIS WITHOUT WARRANTIES. USE OF THE PRODUCTS IS AT YOUR OWN RISK. AEROKUBE MAKES NO WARRANTY AS TO THEIR USE OR PERFORMANCE. TO THE MAXIMUM EXTENT PERMITTED BY APPLICABLE LAW, AEROKUBE, AND ITS SUPPLIERS (WHICH SHALL INCLUDE THE PROVIDERS OF THE THIRD PARTY SOFTWARE) AND RESELLERS, DISCLAIM ALL WARRANTIES AND CONDITIONS, EITHER EXPRESS OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, TITLE, AND NON-INFRINGEMENT, WITH REGARD TO THE PRODUCTS, AND THE PROVISION OF OR FAILURE TO PROVIDE SUPPORT SERVICES. THIS LIMITED WARRANTY GIVES CUSTOMER SPECIFIC LEGAL RIGHTS. CUSTOMER MAY HAVE OTHER RIGHTS, WHICH VARY FROM STATE/JURISDICTION TO STATE/JURISDICTION. AEROKUBE (AND ITS AFFILIATES, AGENTS, DIRECTORS AND EMPLOYEES) DOES NOT WARRANT:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>THAT THE PRODUCTS ARE ACCURATE, RELIABLE OR CORRECT</p>
</li>
<li>
<p>THAT THE PRODUCTS WILL MEET YOUR REQUIREMENTS</p>
</li>
<li>
<p>THAT THE PRODUCTS WILL BE AVAILABLE AT ANY PARTICULAR TIME OR LOCATION, UNINTERRUPTED OR SECURE</p>
</li>
<li>
<p>THAT ANY DEFECTS OR ERRORS WILL BE CORRECTED</p>
</li>
<li>
<p>THAT THE PRODUCTS ARE FREE OF VIRUSES OR OTHER HARMFUL COMPONENTS</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>ANY CONTENT OR DATA DOWNLOADED OR OTHERWISE OBTAINED THROUGH THE USE OF THE PRODUCTS ARE DOWNLOADED AT YOUR OWN RISK AND YOU WILL BE SOLELY RESPONSIBLE FOR ANY DAMAGE TO YOUR PROPERTY OR LOSS OF DATA THAT RESULTS FROM SUCH DOWNLOAD. NO WARRANTY OR LIABILITY AT ALL IS GIVEN TO PRODUCTS UNDER EVALUATION.</p>
</div>
</li>
<li>
<p><strong>DISCLAIMER OF DAMAGES</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>TO THE MAXIMUM EXTENT PERMITTED BY APPLICABLE LAW, IN NO EVENT WILL AEROKUBE (OR ITS AFFILIATES, AGENTS, DIRECTORS, OR EMPLOYEES), OR AEROKUBE LICENSORS, SUPPLIERS OR RESELLERS BE LIABLE TO CUSTOMER OR ANYONE ELSE FOR:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>ANY LOSS OF USE, DATA, GOODWILL, OR PROFITS, WHETHER OR NOT FORESEEABLE</p>
</li>
<li>
<p>ANY LOSS OR DAMAGES IN CONNECTION WITH TERMINATION OR SUSPENSION OF CUSTOMER&#8217;S ACCESS TO OUR PRODUCTS IN ACCORDANCE WITH THIS AGREEMENT</p>
</li>
<li>
<p>ANY SPECIAL, INCIDENTAL, INDIRECT, CONSEQUENTIAL, EXEMPLARY OR PUNITIVE DAMAGES WHATSOEVER (EVEN IF WE HAVE BEEN ADVISED OF THE POSSIBILITY OF THESE DAMAGES), INCLUDING THOSE:</p>
<div class="olist upperalpha">
<ol class="upperalpha" type="A">
<li>
<p>RESULTING FROM LOSS OF USE, DATA, OR PROFITS, WHETHER OR NOT FORESEEABLE</p>
</li>
<li>
<p>BASED ON ANY THEORY OF LIABILITY, INCLUDING BREACH OF CONTRACT OR WARRANTY, STRICT LIABILITY, NEGLIGENCE OR OTHER TORTIOUS ACTION</p>
</li>
<li>
<p>ARISING FROM ANY OTHER CLAIM ARISING OUT OF OR IN CONNECTION WITH CUSTOMER&#8217;S USE OF OR ACCESS TO THE PRODUCTS OR SUPPORT.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>THE FOREGOING LIMITATION OF LIABILITY SHALL APPLY TO THE FULLEST EXTENT PERMITTED BY LAW IN THE APPLICABLE JURISDICTION.</p>
</li>
<li>
<p>THE TOTAL LIABILITY IN ANY MATTER ARISING OUT OF OR IN RELATION TO THIS AGREEMENT IS LIMITED TO ONE HUNDRED (100) US DOLLARS OR THE AGGREGATE AMOUNT PAID OR PAYABLE BY THE CUSTOMER FOR PRODUCTS DURING THE THREE-MONTH PERIOD PRECEDING THE EVENT GIVING RISE TO THE LIABILITY, WHICHEVER IS GREATER. THIS LIMITATION WILL APPLY EVEN IF WE OR YOU HAVE BEEN ADVISED OF THE POSSIBILITY OF LIABILITY EXCEEDING SUCH AMOUNT AND NOTWITHSTANDING ANY FAILURE OF THE ESSENTIAL PURPOSE OF ANY LIMITED REMEDY.</p>
</li>
</ol>
</div>
</li>
<li>
<p><strong>Term and Termination</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The term of this Agreement will commence upon acceptance of this Agreement by Customer as set forth in the preamble above, and will continue for each Product through the end of the applicable subscription period specified in the respective Subscription Confirmation. This Agreement will automatically renew with respect to each Product for a successive subscription term, unless terminated as set forth herein.</p>
</li>
<li>
<p>Customer may terminate this Agreement at any time by cancelling its Product subscription. If such termination occurs during a then-current subscription period, this Agreement will continue to be effective until the end of that subscription period. Such termination does not relieve Customer of the obligation to pay any outstanding subscription fees owed to Licensor, and no credits or refunds will be issued to Customer for prepaid subscription fees (except as specified in the Licensor Terms of Purchase, if applicable).</p>
</li>
<li>
<p>Licensor <strong>may terminate</strong> this agreement if:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Customer has materially breached this Agreement and fails to cure such breach within thirty (30) days of written notice thereof.</p>
</li>
<li>
<p>Customer fails to make the timely payment of subscription fees in accordance with "Fees" Section of this Agreement.</p>
</li>
<li>
<p>Licensor is required to do so by law (for example, where the provision of the Product to Customer is, or becomes, unlawful).</p>
</li>
<li>
<p>Licensor elects to discontinue providing the Product, in whole or in part.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Licensor will make reasonable efforts to <strong>notify Customer</strong> via email as follows:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Thirty (30) days prior to termination of the Agreement when required to terminate by law or because of discontinued Product. In such events Customer will be entitled to a refund of the unused portion of prepaid subscription fees, if applicable.</p>
</li>
<li>
<p>Three (3) days prior to termination of the Agreement in other cases. In such events Customer will not be entitled to any refund of the unused portion of prepaid subscription fees.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
<li>
<p><strong>Temporary Suspension for Non-payment</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Licensor reserves the right to suspend or limit Customer&#8217;s access to Aerokube Products if Customer fails to pay subscription fees on time.</p>
</li>
<li>
<p>If Licensor suspends or limits Customer&#8217;s access to Aerokube Products for non-payment according, Customer must pay all past due amounts in order to restore full access to Aerokube Products.</p>
</li>
<li>
<p>Customer hereby agrees that Licensor is entitled to charge Customer for the time period during which Customer has access to Aerokube Products until Customer or Licensor terminates or suspends Customer&#8217;s subscription in accordance with this Agreement.</p>
</li>
</ol>
</div>
</li>
<li>
<p><strong>Export Regulations</strong></p>
<div class="paragraph">
<p>Customer shall comply with all applicable laws and regulations with regards to economic sanctions, export controls, import regulations, and trade embargoes (all herein referred to as "Sanctions"), including those of the European Union and United States (specifically the Export Administration Regulations (EAR)). Customer declares that it is not a person targeted by Sanctions nor is it otherwise owned or controlled by or acting on behalf of any person targeted by Sanctions. Further, Customer warrants that it will not download or otherwise export or re-export the Product or any related technical data directly or indirectly to any person targeted by Sanctions or download or otherwise use the Product for any end-use prohibited or restricted by Sanctions.</p>
</div>
</li>
<li>
<p><strong>Customer Support</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Licensor provides Email Support as well as Instant Messaging Support. The response time will be reasonable, but no specific response time guarantees are given.</p>
</li>
<li>
<p>Customer may request additional paid support from Licensor which is subject of a supplementary individually negotiated Agreement between Customer and Licensor.</p>
</li>
<li>
<p>Any guarantees of support availability only apply to the latest version of Licensed Software available in Customer Subscription.</p>
</li>
</ol>
</div>
</li>
<li>
<p><strong>Customer Data</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><strong>Use of Name and Logo.</strong> Customer agrees that Licensor may identify it as a customer of Aerokube and may refer to it by name, trade name and trademark, if applicable. Licensor may also briefly describe Customer&#8217;s business in Licensor marketing materials, on the Aerokube website and/or in public or legal documents. Customer hereby grants Licensor a worldwide, non-exclusive and royalty-free license to use Customer&#8217;s name and any of Customer&#8217;s trade names and trademarks solely pursuant to this marketing section. Notwithstanding anything to the contrary herein, Licensor acknowledges that in some cases Customer licenses and does not own marks or logos (for example, marks or logos of the Affiliates) and cannot permit Licensor to use such marks.</p>
</li>
<li>
<p><strong>Gathering of Usage Statistics.</strong> Customer acknowledges and agrees that the Product may contain a feature that reports the usage statistics, diagnostics information and usage meta-information of the Product back to the Licensor. Customer may opt out of the gathering of usage statistics by turning off this feature in the Product settings.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_pricing"><a class="anchor" href="#_pricing"></a>6. Pricing</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Last updated December 17th, 2021. Replaces the prior version in its entirety.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Moon price is calculated using so-called <code>Number of Concurrent Sessions</code> that is to say total number of browser sessions being run in parallel. We control this by limiting total number of simultaneously running browser pods to the value you are purchasing.</p>
</li>
<li>
<p>When no license key is provided <code>4 (four)</code> parallel browser sessions maximum are allowed. If such limit is sufficient for you - you are allowed use Moon without license key for unlimited period of time.</p>
</li>
<li>
<p>If free limit is insufficient - you need <code>a paid license</code>. Such license can include <code>any desired number</code> of parallel browser sessions (yes, even <code>42</code>).</p>
</li>
<li>
<p>Every parallel session has a fixed cost - <code>$5 USD</code> (five United States dollars). If you are a EU-based company - then we convert the price to euro (€).</p>
<div class="listingblock">
<div class="title">An example price calculation</div>
<div class="content">
<pre>42 sessions * $5/month = $210/month</pre>
</div>
</div>
</li>
<li>
<p>For simplicity, we calculated monthly prices for some frequent cases:</p>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 9. Moon License Pricing</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Number of Parallel Sessions</th>
<th class="tableblock halign-left valign-top">Price per Month, USD</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0-4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">free</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">$25</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">$50</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">15</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">$75</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">20</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">$100</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">25</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">$125</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">30</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">$150</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">40</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">$200</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">50</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">$250</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">75</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">$375</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">$500</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">150</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">$750</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">$1000</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">250</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">$1250</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">500</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">$2500</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">750</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">$3750</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">$5000</p></td>
</tr>
</tbody>
</table>
</li>
</ol>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version dev-latest<br>
Last updated 2021-12-21 14:47:13 UTC
</div>
</div>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-23854888-2"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-23854888-2');
</script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
        m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(43539754, "init", {
        clickmap:true,
        trackLinks:true,
        accurateTrackBounce:true,
        webvisor:true,
        trackHash:true
    });
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/43539754" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->
</body>
</html>