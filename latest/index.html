<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.6.1">
<meta name="author" content="Aerokube Software OÜ">
<link rel="shortcut icon" type="image/png" href="img/favicon.png">
<title>Moon</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:initial}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px 0}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:.4em .75em 0 .75em;line-height:1;vertical-align:top}
.colist>table tr>td:first-of-type img{max-width:initial}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
<style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
/*pre.CodeRay {background-color:#f7f7f8;}*/
.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}
.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,.3)}
.CodeRay .line-numbers strong{color:rgba(0,0,0,.4)}
table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}
table.CodeRay td{vertical-align: top;line-height:1.45}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,.3)}
table.CodeRay td.code{padding:0 0 0 .5em}
table.CodeRay td.code>pre{padding:0}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Moon</h1>
<div class="details">
<span id="author" class="author">Aerokube Software OÜ</span><br>
<span id="revnumber">version latest,</span>
<span id="revdate">2019-08-27</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_getting_started">1. Getting Started</a>
<ul class="sectlevel2">
<li><a href="#_quick_start_guide">1.1. Quick Start Guide</a></li>
<li><a href="#_frequently_asked_questions">1.2. Frequently Asked Questions</a>
<ul class="sectlevel3">
<li><a href="#_where_are_moon_logs">1.2.1. Where are Moon logs?</a></li>
<li><a href="#_where_are_recorded_videos_stored">1.2.2. Where are recorded videos stored?</a></li>
<li><a href="#_how_to_update_configuration_of_a_running_moon_cluster">1.2.3. How to update configuration of a running Moon cluster?</a></li>
<li><a href="#_connection_was_closed_unexpectedly">1.2.4. Connection was closed unexpectedly</a></li>
<li><a href="#_browser_pods_are_freezing">1.2.5. Browser pods are freezing</a></li>
<li><a href="#_no_space_left_on_device">1.2.6. No space left on device</a></li>
<li><a href="#_dns_lookup_timeouts">1.2.7. DNS lookup timeouts</a></li>
</ul>
</li>
<li><a href="#_installing_to_openshift">1.3. Installing to Openshift</a></li>
<li><a href="#_required_permissions">1.4. Required Permissions</a></li>
<li><a href="#_cluster_architecture">1.5. Cluster Architecture</a></li>
<li><a href="#_moon_vs_selenoid">1.6. Moon vs Selenoid</a></li>
</ul>
</li>
<li><a href="#_configuration">2. Configuration</a>
<ul class="sectlevel2">
<li><a href="#_users_list">2.1. Users List</a>
<ul class="sectlevel3">
<li><a href="#_updating_users_list">2.1.1. Updating Users List</a></li>
</ul>
</li>
<li><a href="#_browsers_list">2.2. Browsers List</a>
<ul class="sectlevel3">
<li><a href="#_per_user_browser_lists">2.2.1. Per-user Browser Lists</a></li>
<li><a href="#_guest_quota">2.2.2. Guest Quota</a></li>
<li><a href="#_updating_browsers_list">2.2.3. Updating Browsers List</a></li>
</ul>
</li>
<li><a href="#_configuration_file">2.3. Configuration File</a></li>
<li><a href="#_credentials_secret">2.4. Credentials Secret</a></li>
<li><a href="#_installing_license">2.5. Installing License</a>
<ul class="sectlevel3">
<li><a href="#_how_licenses_work">2.5.1. How Licenses Work</a></li>
</ul>
</li>
<li><a href="#_advanced_configuration">2.6. Advanced Configuration</a>
<ul class="sectlevel3">
<li><a href="#_uploading_files_to_s3">2.6.1. Uploading Files to S3</a></li>
<li><a href="#_using_custom_docker_registry">2.6.2. Using Custom Docker Registry</a></li>
<li><a href="#_adjusting_timeouts">2.6.3. Adjusting Timeouts</a></li>
<li><a href="#_adjusting_resources_consumption">2.6.4. Adjusting Resources Consumption</a></li>
<li><a href="#_running_browser_pods_in_privileged_mode">2.6.5. Running Browser Pods in Privileged Mode</a></li>
<li><a href="#_using_node_selectors">2.6.6. Using Node Selectors</a></li>
<li><a href="#_using_tolerations">2.6.7. Using Tolerations</a></li>
<li><a href="#_using_custom_kubernetes_annotations">2.6.8. Using Custom Kubernetes Annotations</a></li>
</ul>
</li>
<li><a href="#_log_files">2.7. Log Files</a></li>
<li><a href="#_cli_flags">2.8. CLI Flags</a></li>
</ul>
</li>
<li><a href="#_main_features">3. Main Features</a>
<ul class="sectlevel2">
<li><a href="#_special_capabilities">3.1. Special Capabilities</a>
<ul class="sectlevel3">
<li><a href="#_live_browser_screen_enablevnc">3.1.1. Live Browser Screen: enableVNC</a></li>
<li><a href="#_custom_screen_resolution_screenresolution">3.1.2. Custom Screen Resolution: screenResolution</a></li>
<li><a href="#_android_skin_skin">3.1.3. Android Skin: skin</a></li>
<li><a href="#_video_recording_enablevideo_videoname_videoscreensize_videoframerate_videocodec">3.1.4. Video Recording: enableVideo, videoName, videoScreenSize, videoFrameRate, videoCodec</a></li>
<li><a href="#_custom_test_name_name">3.1.5. Custom Test Name: name</a></li>
<li><a href="#_per_session_time_zone_timezone">3.1.6. Per-session Time Zone: timeZone</a></li>
<li><a href="#_per_session_environment_variables_env">3.1.7. Per-session Environment Variables: env</a></li>
<li><a href="#_hosts_entries_hostsentries">3.1.8. Hosts Entries: hostsEntries</a></li>
<li><a href="#_custom_session_timeout_sessiontimeout">3.1.9. Custom Session Timeout: sessionTimeout</a></li>
<li><a href="#_specifying_capabilities_via_protocol_extensions">3.1.10. Specifying Capabilities via Protocol Extensions</a></li>
</ul>
</li>
<li><a href="#_accessing_files_downloaded_with_browser">3.2. Accessing Files Downloaded with Browser</a></li>
<li><a href="#_accessing_clipboard">3.3. Accessing Clipboard</a></li>
</ul>
</li>
<li><a href="#_license_agreement">4. License Agreement</a></li>
<li><a href="#_pricing">5. Pricing</a></li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This reference for version: <em>latest</em></p>
</div>
<div class="paragraph">
<p>Moon is an enterprise version of <a href="http://github.com/aerokube/selenoid">Selenoid</a> using <a href="https://kubernetes.io/">Kubernetes</a> to launch browsers.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_getting_started"><a class="anchor" href="#_getting_started"></a>1. Getting Started</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_quick_start_guide"><a class="anchor" href="#_quick_start_guide"></a>1.1. Quick Start Guide</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Prerequisites:</p>
<div class="ulist">
<ul>
<li>
<p>Running <a href="https://kubernetes.io/">Kubernetes</a> cluster</p>
</li>
<li>
<p><code>kubectl</code> client installed and pointing to the cluster</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you are running Kubernetes cluster on virtual machines, we usually recommend having bigger VMs instead of smaller ones. This allows to avoid available CPUs and memory fragmentation issues. For example having 24 CPU cores overall it is better to start 3 x 8 CPU core VMs instead of 12 x 2 CPU core.
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Clone an example configuration repository:</p>
<div class="literalblock">
<div class="content">
<pre>$ git clone https://github.com/aerokube/moon-deploy.git
$ cd moon-deploy</pre>
</div>
</div>
</li>
<li>
<p>Run one command to start Moon and Moon API:</p>
<div class="literalblock">
<div class="content">
<pre>$ kubectl apply -f moon.yaml</pre>
</div>
</div>
<div class="paragraph">
<p>By default Moon is started in a separate namespace called <code>moon</code> so we append <code>-n moon</code> to the next commands.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In Google Cloud you may also need to give cluster admin permissions to your Google account as follows:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ kubectl create clusterrolebinding cluster-admin-binding --clusterrole=cluster-admin --user=username@example.com # Use you real Google account email</pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Wait for LoadBalancer IP to allocate:</p>
<div class="literalblock">
<div class="content">
<pre>$ kubectl get svc -n moon
NAME      TYPE           CLUSTER-IP      EXTERNAL-IP   PORT(S)                         AGE
moon      LoadBalancer   10.63.242.109   &lt;pending&gt;     4444:31894/TCP,8080:30625/TCP   17s</pre>
</div>
</div>
<div class="paragraph">
<p>It will look like this when finished:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ kubectl get svc -n moon
NAME      TYPE           CLUSTER-IP      EXTERNAL-IP      PORT(S)                         AGE
moon      LoadBalancer   10.63.242.109   104.154.161.58   4444:31894/TCP,8080:30625/TCP   1m</pre>
</div>
</div>
<div class="paragraph">
<p>Now you can optionally point a domain name to this IP address:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ host moon.example.com
moon.example.com has address 104.154.161.58</pre>
</div>
</div>
</li>
<li>
<p>Run your tests against <code>moon</code> like you do with regular Selenium:</p>
<div class="literalblock">
<div class="content">
<pre>http://104.154.161.58:4444/wd/hub</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
When running your tests for the first time for every browser version Kubernetes will download and cache requested browser image. This can take several minutes depending on your network connection.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Same address using domain name:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>http://moon.example.com:4444/wd/hub</pre>
</div>
</div>
</li>
<li>
<p>Moon web interface is available at:</p>
<div class="literalblock">
<div class="content">
<pre>http://104.154.161.58:8080/</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_frequently_asked_questions"><a class="anchor" href="#_frequently_asked_questions"></a>1.2. Frequently Asked Questions</h3>
<div class="sect3">
<h4 id="_where_are_moon_logs"><a class="anchor" href="#_where_are_moon_logs"></a>1.2.1. Where are Moon logs?</h4>
<div class="paragraph">
<p>See <a href="#_log_files">Log Files</a> section.</p>
</div>
</div>
<div class="sect3">
<h4 id="_where_are_recorded_videos_stored"><a class="anchor" href="#_where_are_recorded_videos_stored"></a>1.2.2. Where are recorded videos stored?</h4>
<div class="paragraph">
<p>Moon automatically saves session logs and recorded video files to <a href="https://en.wikipedia.org/wiki/Amazon_S3">S3</a> compatible storage. If S3 storage is not configured - then video recording will not work.</p>
</div>
</div>
<div class="sect3">
<h4 id="_how_to_update_configuration_of_a_running_moon_cluster"><a class="anchor" href="#_how_to_update_configuration_of_a_running_moon_cluster"></a>1.2.3. How to update configuration of a running Moon cluster?</h4>
<div class="paragraph">
<p>Just update respective config maps (<code>config</code>, <code>quota</code>) or secrets (<code>users</code>, <code>credentials</code>) with standard Kubernetes commands (<code>kubectl edit</code> or <code>kubectl replace</code>). For example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ kubectl edit configmap config -n moon # Updating global Moon configuration
$ kubectl edit configmap quota -n moon # Updating Moon quota
$ kubectl edit secret users -n moon # Updating Moon users
$ kubectl edit secret credentials -n moon # Updating Moon credentials (e.g. S3 access keypair)</pre>
</div>
</div>
<div class="paragraph">
<p>These commands will open your preferred editor with respective data: do any desired modifications, save and exit. Changes are applied immediately but how fast Moon will see them depends on Kubernetes caching settings (default is <code>1 minute</code>).</p>
</div>
</div>
<div class="sect3">
<h4 id="_connection_was_closed_unexpectedly"><a class="anchor" href="#_connection_was_closed_unexpectedly"></a>1.2.4. Connection was closed unexpectedly</h4>
<div class="paragraph">
<p>If your HTTP requests are randomly hanging - this can mean that you can have too low HTTP request timeout value on your network load balancer (<code>LoadBalancer</code>, <code>Ingress</code>, Openshift <code>Route</code>). Very often default value is about <code>30 seconds</code> and this can lead to closed connections when a lot of new Selenium session requests are being sent to Moon. How to set timeout setting usually depends on cloud platform you are using. For example in AWS this can look like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">kind</span>: <span class="string"><span class="content">Service</span></span>
<span class="key">apiVersion</span>: <span class="string"><span class="content">v1</span></span>
<span class="key">metadata</span>:
  <span class="key">name</span>: <span class="string"><span class="content">moon</span></span>
  <span class="key">namespace</span>: <span class="string"><span class="content">moon</span></span>
  <span class="key">annotations</span>:
    <span class="key">service.beta.kubernetes.io/aws-load-balancer-connection-idle-timeout</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">60</span><span class="delimiter">&quot;</span></span> <span class="comment"># AWS load balancer timeout setting</span>
<span class="key">spec</span>:
  <span class="key">type</span>: <span class="string"><span class="content">LoadBalancer</span></span>
  <span class="comment"># The rest of spec goes here...</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_browser_pods_are_freezing"><a class="anchor" href="#_browser_pods_are_freezing"></a>1.2.5. Browser pods are freezing</h4>
<div class="paragraph">
<p>This is a known issue in Kubernetes DNS server settings. Current fix is to turn off DNS caching. To do this:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open DNS configuration map for editing (this will open an editor):</p>
<div class="literalblock">
<div class="content">
<pre>$ kubectl edit cm coredns -n kube-system</pre>
</div>
</div>
</li>
<li>
<p>You will see YAML content like the following:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">apiVersion</span>: <span class="string"><span class="content">v1</span></span>
<span class="key">data</span>:
  <span class="key">Corefile</span>: <span class="string"><span class="delimiter">|</span><span class="content">
    .:53 {
        errors
        health
        kubernetes cluster.local in-addr.arpa ip6.arpa {
           pods insecure
           upstream
           fallthrough in-addr.arpa ip6.arpa
        }
        prometheus :9153
        proxy . /etc/resolv.conf
        cache 30
        loop
        reload
        loadbalance
    }</span></span>
<span class="key">kind</span>: <span class="string"><span class="content">ConfigMap</span></span>
<span class="key">metadata</span>:
  <span class="key">creationTimestamp</span>: <span class="string"><span class="content">2019-01-17T10:32:38Z</span></span>
  <span class="key">name</span>: <span class="string"><span class="content">coredns</span></span>
  <span class="key">namespace</span>: <span class="string"><span class="content">kube-system</span></span>
  <span class="key">resourceVersion</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">206</span><span class="delimiter">&quot;</span></span>
  <span class="key">selfLink</span>: <span class="string"><span class="content">/api/v1/namespaces/kube-system/configmaps/coredns</span></span>
  <span class="key">uid</span>: <span class="string"><span class="content">3668d0fe-1a43-11e9-ad0b-025000000001</span></span></code></pre>
</div>
</div>
</li>
<li>
<p>Remove one line:</p>
<div class="literalblock">
<div class="content">
<pre>cache 30</pre>
</div>
</div>
</li>
<li>
<p>Save changes and exit the editor.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_no_space_left_on_device"><a class="anchor" href="#_no_space_left_on_device"></a>1.2.6. No space left on device</h4>
<div class="paragraph">
<p>If you are getting the following error&#8230;&#8203;</p>
</div>
<div class="literalblock">
<div class="content">
<pre>2019/01/23 13:47:11 [INIT] [Failed to init quota reloader: unable to watch directory: no space left on device]</pre>
</div>
</div>
<div class="paragraph">
<p>&#8230;&#8203;and have sufficient disk space then it can be caused by insufficient number of <a href="https://en.wikipedia.org/wiki/Inotify">inotify</a> watchers. Moon is using inotify to automatically reload configuration files when they change. To fix this execute one command on Kubernetes hosts:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ echo fs.inotify.max_user_watches=524288 | sudo tee -a /etc/sysctl.conf &amp;&amp; sudo sysctl -p</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_dns_lookup_timeouts"><a class="anchor" href="#_dns_lookup_timeouts"></a>1.2.7. DNS lookup timeouts</h4>
<div class="paragraph">
<p>If you are using <a href="https://github.com/coreos/flannel">Flannel</a> as Kubernetes networking engine and receiving DNS lookup timeouts like the following&#8230;&#8203;</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>2019/02/21 08:37:32 [VNC_ERROR] [10.244.1.1] [dial tcp: lookup chrome-71-0-686efb96-eabe-4435-af31-21a33c8a4c8b on 10.96.0.10:53: read udp 10.244.1.11:40603-&gt;10.96.0.10:53: i/o timeout]</code></pre>
</div>
</div>
<div class="paragraph">
<p>&#8230;&#8203;then you may need to set the following kernel property on Kubernetes nodes:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>$ sysctl net.bridge.bridge-nf-call-iptables=1</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_installing_to_openshift"><a class="anchor" href="#_installing_to_openshift"></a>1.3. Installing to Openshift</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Prerequisites:</p>
<div class="ulist">
<ul>
<li>
<p>Running <a href="https://www.openshift.com/">Openshift</a> cluster</p>
</li>
<li>
<p><code>oc</code> client installed and pointing to the cluster</p>
</li>
</ul>
</div>
</li>
<li>
<p>Clone an example configuration repository:</p>
<div class="literalblock">
<div class="content">
<pre>$ git clone https://github.com/aerokube/moon-deploy.git
$ cd moon-deploy</pre>
</div>
</div>
</li>
<li>
<p>Add <code>edit</code> policy to <code>default</code> account so Moon could read project pod quota:</p>
<div class="literalblock">
<div class="content">
<pre>$ oc policy add-role-to-user edit system:serviceaccount:moon:default</pre>
</div>
</div>
<div class="paragraph">
<p>Here we assume that Openshift project for Moon is called <code>moon</code>.</p>
</div>
</li>
<li>
<p>Start Moon with Openshift UI or <code>oc</code> client using <code>moon-openshift.yaml</code> file:</p>
<div class="literalblock">
<div class="content">
<pre>$ oc create -f moon-openshift.yaml -n moon</pre>
</div>
</div>
</li>
<li>
<p>Run Selenium tests against <code>moon</code> service listening on port <code>4444</code>:</p>
<div class="literalblock">
<div class="content">
<pre>http://&lt;moon-ip-or-hostname&gt;:4444/wd/hub</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_required_permissions"><a class="anchor" href="#_required_permissions"></a>1.4. Required Permissions</h3>
<div class="paragraph">
<p>Moon requires very limited set of permissions and should work with default Kubernetes settings. The following table summarizes what needs to be accessible.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 1. Required Moon Permissions</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Permission</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Purpose</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">To <strong>start</strong> and <strong>stop</strong> <a href="https://kubernetes.io/docs/concepts/workloads/pods/pod/">pods</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used to start pods with browsers</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">To <strong>start</strong> and <strong>stop</strong> <a href="https://kubernetes.io/docs/concepts/services-networking/service/">services</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used to provide network connectivity to browser pods</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">To <strong>read</strong> data from <a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-pod-configmap/">config maps</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used to share various configuration data among Moon replicas: S3 configuration, custom images configuration and so on</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">To <strong>read</strong> data from <a href="https://kubernetes.io/docs/concepts/configuration/secret/">secrets</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used to share S3 credentials among Moon replicas</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">To <strong>read</strong> <a href="https://kubernetes.io/docs/concepts/policy/resource-quotas/">resource quota</a> information</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used to verify that Moon can run no more than total number of browser pods allowed by license</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">To <strong>create</strong> and <strong>update</strong> <a href="https://kubernetes.io/docs/concepts/policy/resource-quotas/">resource quota</a> information</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Optional.</strong> Used only in case when no resource quota was configured</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">To <strong>create</strong> and <strong>delete</strong> <a href="https://kubernetes.io/docs/concepts/configuration/secret/">secrets</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Optional.</strong> Used only in case when no resource quota was configured</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
All these permissions are normally enabled by default when running Moon and its browser pods in the same Kubernetes namespace. To configure a namespace for browser pods - use <code>-namespace</code> flag for Moon and Moon API. If you are starting Moon in one namespace and specify <code>-namespace</code> flag pointing to another namespace, then you may require additional Kubernetes permissions to be enabled.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_cluster_architecture"><a class="anchor" href="#_cluster_architecture"></a>1.5. Cluster Architecture</h3>
<div class="paragraph">
<div class="title">Moon Cluster Architecture</div>
<p><span class="image"><img src="img/architecture.png" alt="architecture"></span></p>
</div>
<div class="paragraph">
<p>Moon cluster consists of several important components:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>One or more <code>Moon</code> application instances. Their main purpose is to start and stop browser containers. These replicas are usually exposed as <a href="https://kubernetes.io/docs/concepts/services-networking/service/">Kubernetes service</a> available on standard Selenium port <code>4444</code>. You should run all the tests against this service.</p>
</li>
<li>
<p>One or more <code>Moon API</code> application instances. This API collects and returns various data about running browsers. <code>Moon API</code> can be optionally exposed as <a href="https://kubernetes.io/docs/concepts/services-networking/service/">Kubernetes service</a> available on HTTP port <code>8888</code>. By default it is only accessible inside Kubernetes cluster.</p>
</li>
<li>
<p>One or more <code>Moon UI</code> application instances. <code>Moon UI</code> collects information from Moon API and visualizes it. It is usually available on HTTP port <code>8080</code>.</p>
</li>
<li>
<p>Running browser pods. Moon is using exactly the same browser images as <a href="https://github.com/aerokube/selenoid">Selenoid</a>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Moon is completely stateless and does not require any external database to run browser sessions.</p>
</div>
<div class="paragraph">
<div class="title">Why Moon is Stateless</div>
<p><span class="image"><img src="img/moon-stateless.png" alt="moon-stateless"></span></p>
</div>
<div class="paragraph">
<p>When user requests a new browser session - a Kubernetes pod containing desired browser version is created. Moon also creates a Kubernetes service (with generated name like <code>chrome-71-0-&lt;UUID&gt;</code>) to deliver network connectivity to browser pod. Having a running pod and service - a standard new Selenium session request is sent to it. After receiving unique session identifier (so called <code>Selenium session ID</code>) Moon replaces it with the generated Kubernetes service name and returns the response to user. Subsequent Selenium requests are just proxied to respective service by using Selenium session ID as service name.</p>
</div>
</div>
<div class="sect2">
<h3 id="_moon_vs_selenoid"><a class="anchor" href="#_moon_vs_selenoid"></a>1.6. Moon vs Selenoid</h3>
<div class="paragraph">
<p>Moon takes all the best practices and features from Selenoid and adds many more:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Unlimited automatic scalability.</strong> You always have enough browsers of any desired version available in the cluster. When running the cluster in cloud platforms such as <a href="http://cloud.google.com/">Google Cloud</a> you can adjust settings to automatically scale depending on current load. This allows to combine efficiency with competitive cost.</p>
</li>
<li>
<p><strong>Completely stateless</strong>. Selenoid stores in memory information about currently running browser sessions. If for some reason its process crashes - then all running sessions are lost. Moon contrarily has no internal state and can be replicated across datacenters. Browser sessions remain alive even if one or more replicas go down.</p>
</li>
<li>
<p><strong>Uniform load distribution</strong>. Load balancers like <a href="http://github.com/aerokube/ggr/">Ggr</a> are using random load distribution across available browser hosts. This makes them inefficient when overall load is above 80% of cluster capacity. Moon delivers exactly uniform distribution working good even under 100% load.</p>
</li>
<li>
<p><strong>Fully graceful</strong>. Any maintenance operations with the cluster do not interrupt running browser sessions. Every cluster component shuts down gracefully.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuration"><a class="anchor" href="#_configuration"></a>2. Configuration</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_users_list"><a class="anchor" href="#_users_list"></a>2.1. Users List</h3>
<div class="paragraph">
<p>Moon is a multi-user application allowing different users access different browser versions. A single <a href="https://httpd.apache.org/docs/2.4/misc/password_encryptions.html">htpasswd</a> file is used to store users information. This file is saved to <a href="https://kubernetes.io/docs/concepts/configuration/secret/">Kubernetes Secret</a> and mounted to Moon container as a volume. A typical users file is a text file with user names and their encrypted passwords separated by colon:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>$ cat users.htpasswd
test:$apr1$.dZyHlKN$jdoZkin/kPviFNArx/cVL1 # User is test, password is encrypted
alice:$apr1$mLYJAC4y$VYeJstWjWP/4iVlH/TNcD.
bob:$apr1$gyqzbSpt$RBNcxrsQaolPZCQZW0VQW1</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_updating_users_list"><a class="anchor" href="#_updating_users_list"></a>2.1.1. Updating Users List</h4>
<div class="paragraph">
<p>To add or remove users:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Modify <code>users.htpasswd</code> with <code>htpasswd</code> command:</p>
<div class="literalblock">
<div class="content">
<pre>$ htpasswd -Bbn new-user new-user-password &gt;&gt; users.htpasswd # Adding new user
$ htpasswd -Bb users.htpasswd some-user new-password # Updating password
$ htpasswd -D users.htpasswd test-user # Deleting existing user</pre>
</div>
</div>
</li>
<li>
<p>Update <code>users</code> secret:</p>
<div class="literalblock">
<div class="content">
<pre>$ kubectl replace secret users --from-file=./users.htpasswd -n moon</pre>
</div>
</div>
</li>
<li>
<p>Changes are applied immediately without Moon restart.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_browsers_list"><a class="anchor" href="#_browsers_list"></a>2.2. Browsers List</h3>
<div class="paragraph">
<p>Moon is using a simple <a href="https://en.wikipedia.org/wiki/JSON">JSON</a>-based configuration to store available browsers list. A typical browsers list file looks like the following:</p>
</div>
<div class="listingblock">
<div class="title">Typical Browsers List File</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">firefox</span><span class="delimiter">&quot;</span></span>: {                                      <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="key"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">62.0</span><span class="delimiter">&quot;</span></span>,                              <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="key"><span class="delimiter">&quot;</span><span class="content">versions</span><span class="delimiter">&quot;</span></span>: {                                   <i class="conum" data-value="3"></i><b>(3)</b>
      <span class="key"><span class="delimiter">&quot;</span><span class="content">62.0</span><span class="delimiter">&quot;</span></span>: {                                     <i class="conum" data-value="4"></i><b>(4)</b>
        <span class="key"><span class="delimiter">&quot;</span><span class="content">image</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">selenoid/firefox:62.0</span><span class="delimiter">&quot;</span></span>,           <i class="conum" data-value="5"></i><b>(5)</b>
        <span class="key"><span class="delimiter">&quot;</span><span class="content">port</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">4444</span><span class="delimiter">&quot;</span></span>,                             <i class="conum" data-value="6"></i><b>(6)</b>
        <span class="key"><span class="delimiter">&quot;</span><span class="content">path</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">/wd/hub</span><span class="delimiter">&quot;</span></span>,                          <i class="conum" data-value="7"></i><b>(7)</b>
        <span class="key"><span class="delimiter">&quot;</span><span class="content">volumes</span><span class="delimiter">&quot;</span></span>: [<span class="string"><span class="delimiter">&quot;</span><span class="content">/from:/to</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">/another:/test</span><span class="delimiter">&quot;</span></span>], <i class="conum" data-value="8"></i><b>(8)</b>
        <span class="key"><span class="delimiter">&quot;</span><span class="content">resources</span><span class="delimiter">&quot;</span></span>: {                              <i class="conum" data-value="9"></i><b>(9)</b>
          <span class="key"><span class="delimiter">&quot;</span><span class="content">limits</span><span class="delimiter">&quot;</span></span>: {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">cpu</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">2</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">memory</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">2Gi</span><span class="delimiter">&quot;</span></span>
          },
          <span class="key"><span class="delimiter">&quot;</span><span class="content">requests</span><span class="delimiter">&quot;</span></span>: {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">cpu</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">200m</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">memory</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">1Gi</span><span class="delimiter">&quot;</span></span>
          }
        },
        <span class="key"><span class="delimiter">&quot;</span><span class="content">privileged</span><span class="delimiter">&quot;</span></span>: <span class="predefined-constant">true</span>,                         <i class="conum" data-value="10"></i><b>(10)</b>
        <span class="key"><span class="delimiter">&quot;</span><span class="content">nodeSelector</span><span class="delimiter">&quot;</span></span>: {                           <i class="conum" data-value="11"></i><b>(11)</b>
          <span class="key"><span class="delimiter">&quot;</span><span class="content">node-type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">hardware</span><span class="delimiter">&quot;</span></span>
        },
        <span class="key"><span class="delimiter">&quot;</span><span class="content">env</span><span class="delimiter">&quot;</span></span>: [<span class="string"><span class="delimiter">&quot;</span><span class="content">TZ=Europe/Moscow</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">LANG=ru</span><span class="delimiter">&quot;</span></span>],     <i class="conum" data-value="12"></i><b>(12)</b>
        <span class="key"><span class="delimiter">&quot;</span><span class="content">hosts</span><span class="delimiter">&quot;</span></span>: [<span class="string"><span class="delimiter">&quot;</span><span class="content">example.com:192.168.0.1</span><span class="delimiter">&quot;</span></span>],       <i class="conum" data-value="13"></i><b>(13)</b>
      },
      <span class="key"><span class="delimiter">&quot;</span><span class="content">60.0</span><span class="delimiter">&quot;</span></span>: {
        <span class="comment">//...</span>
      }
    }
  },
  <span class="key"><span class="delimiter">&quot;</span><span class="content">chrome</span><span class="delimiter">&quot;</span></span>: {
    <span class="comment">//...</span>
  },
  <span class="key"><span class="delimiter">&quot;</span><span class="content">opera</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">56.0</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">versions</span><span class="delimiter">&quot;</span></span>: {
        <span class="comment">//...</span>
    }
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Browser name</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Default browser version</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>A list of available browser versions</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Version name</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Image name</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Port to proxy connections to. In the majority of cases should be 4444.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Path relative to / where we request a new session, see below</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>A list of volumes to mount to browser container</td>
</tr>
<tr>
<td><i class="conum" data-value="9"></i><b>9</b></td>
<td>Resource configuration for browser container (CPU and memory)</td>
</tr>
<tr>
<td><i class="conum" data-value="10"></i><b>10</b></td>
<td>Whether to run browser pod in privileged mode (default is false)</td>
</tr>
<tr>
<td><i class="conum" data-value="11"></i><b>11</b></td>
<td>Kubernetes node selector (allows to run pods on particular hosts only)</td>
</tr>
<tr>
<td><i class="conum" data-value="12"></i><b>12</b></td>
<td>Environment variables passed to browser container</td>
</tr>
<tr>
<td><i class="conum" data-value="13"></i><b>13</b></td>
<td>Custom <code>/etc/hosts</code> entries to be passed to browser container in <code>hostname:ip</code> format</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_per_user_browser_lists"><a class="anchor" href="#_per_user_browser_lists"></a>2.2.1. Per-user Browser Lists</h4>
<div class="paragraph">
<p>As you already know Moon is a multi-user application. For every user you need to create one file - <code>&lt;username&gt;.json</code>. For example for user <code>alice</code> from <code>users.htpasswd</code> you should create <code>alice.json</code>. All JSON files should be stored in the same directory specified by <code>-quota-dir</code> flag:</p>
</div>
<div class="listingblock">
<div class="title">Per-user browser lists</div>
<div class="content">
<pre>\---quota
    |---- alice.json
    |---- browsers.json
    |---- bob.json
    |---- test.json</pre>
</div>
</div>
<div class="paragraph">
<p>Such directory is then uploaded to <a href="https://kubernetes.io/docs/tasks/configure-pod-container/configmap/">Kubernetes ConfigMap</a> and mounted to Moon container as a volume.</p>
</div>
</div>
<div class="sect3">
<h4 id="_guest_quota"><a class="anchor" href="#_guest_quota"></a>2.2.2. Guest Quota</h4>
<div class="paragraph">
<p>In some cases you may need anonymous Selenium access - without username and password. In terms of Moon this is called <code>guest quota</code> and is configured with <code>-guest-user</code> flag (default value is <code>browsers</code>). Any browser versions specified in <code>&lt;guest-user&gt;.json</code> file will be available without username and password:</p>
</div>
<div class="listingblock">
<div class="title">Guest quota file name</div>
<div class="content">
<pre>-guest-user browsers ====&gt; browsers.json # This is the default
-guest-user guest-user ====&gt; guest-user.json</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_updating_browsers_list"><a class="anchor" href="#_updating_browsers_list"></a>2.2.3. Updating Browsers List</h4>
<div class="paragraph">
<p>To add or remove browsers:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Having configuration files stored in <code>quota</code> directory apply desired modifications.</p>
</li>
<li>
<p>Update <code>quota</code> ConfigMap using contents of <code>quota</code> directory:</p>
<div class="literalblock">
<div class="content">
<pre>$ kubectl replace configmap quota --from-file=quota -n moon</pre>
</div>
</div>
</li>
<li>
<p>Changes are applied immediately without Moon restart. All running user sessions will continue to work without any interruption.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_configuration_file"><a class="anchor" href="#_configuration_file"></a>2.3. Configuration File</h3>
<div class="paragraph">
<p>Moon stores all advanced configuration options (e.g. S3 settings) in a special JSON file called <code>service.json</code>:</p>
</div>
<div class="listingblock">
<div class="title">Typical <code>service.json</code> file</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">s3</span><span class="delimiter">&quot;</span></span>: {                                          <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="key"><span class="delimiter">&quot;</span><span class="content">endpoint</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">https://storage.googleapis.com</span><span class="delimiter">&quot;</span></span>,  <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="key"><span class="delimiter">&quot;</span><span class="content">bucketName</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">moon-test</span><span class="delimiter">&quot;</span></span>,                     <i class="conum" data-value="3"></i><b>(3)</b>
    <span class="key"><span class="delimiter">&quot;</span><span class="content">version</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">S3v2</span><span class="delimiter">&quot;</span></span>,                             <i class="conum" data-value="4"></i><b>(4)</b>
    <span class="key"><span class="delimiter">&quot;</span><span class="content">keyPattern</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">$quota/$date</span><span class="delimiter">&quot;</span></span>                   <i class="conum" data-value="5"></i><b>(5)</b>
  },
  <span class="key"><span class="delimiter">&quot;</span><span class="content">images</span><span class="delimiter">&quot;</span></span>: {                                      <i class="conum" data-value="6"></i><b>(6)</b>
    <span class="key"><span class="delimiter">&quot;</span><span class="content">logger</span><span class="delimiter">&quot;</span></span>: {                                    <i class="conum" data-value="7"></i><b>(7)</b>
      <span class="key"><span class="delimiter">&quot;</span><span class="content">image</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">my-reg.com/moon/logger:1.2.0</span><span class="delimiter">&quot;</span></span>,     <i class="conum" data-value="8"></i><b>(8)</b>
      <span class="key"><span class="delimiter">&quot;</span><span class="content">cpu</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">0.3</span><span class="delimiter">&quot;</span></span>,                                <i class="conum" data-value="9"></i><b>(9)</b>
      <span class="key"><span class="delimiter">&quot;</span><span class="content">mem</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">1024Mi</span><span class="delimiter">&quot;</span></span>                              <i class="conum" data-value="10"></i><b>(10)</b>
    }
  },
  <span class="key"><span class="delimiter">&quot;</span><span class="content">annotations</span><span class="delimiter">&quot;</span></span>: {                                 <i class="conum" data-value="11"></i><b>(11)</b>
    <span class="key"><span class="delimiter">&quot;</span><span class="content">key1</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">value1</span><span class="delimiter">&quot;</span></span>,                              <i class="conum" data-value="12"></i><b>(12)</b>
    <span class="key"><span class="delimiter">&quot;</span><span class="content">key2</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">value2</span><span class="delimiter">&quot;</span></span>
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>S3 configuration section</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>S3 endpoint URL</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>S3 bucket name</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>S3 signature version (should be <code>S3v2</code> or <code>S3v4</code>)</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>S3 key pattern</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Custom Moon system images section (to use Moon with private Docker registries)</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Custom Moon image definition (one of <code>logger</code>, <code>defender</code>, <code>videoRecorder</code>)</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>Custom Moon image reference</td>
</tr>
<tr>
<td><i class="conum" data-value="9"></i><b>9</b></td>
<td>Custom Moon image CPU limit</td>
</tr>
<tr>
<td><i class="conum" data-value="10"></i><b>10</b></td>
<td>Custom Moon image memory limit</td>
</tr>
<tr>
<td><i class="conum" data-value="11"></i><b>11</b></td>
<td>Custom pod annotations section (applies globally to all browser versions)</td>
</tr>
<tr>
<td><i class="conum" data-value="12"></i><b>12</b></td>
<td>Custom pod annotation key and value</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>service.json</code> is mounted to Moon container as a regular file using Kubernetes config map. Path to configuration file is specified with <code>-config-file</code> Moon flag. Any changes to configuration file are applied immediately - no need to restart Moon.</p>
</div>
<div class="listingblock">
<div class="title">Adding <code>service.json</code> file to Moon</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">apiVersion</span>: <span class="string"><span class="content">v1</span></span>
<span class="key">kind</span>: <span class="string"><span class="content">ConfigMap</span></span>
<span class="key">metadata</span>:
  <span class="key">name</span>: <span class="string"><span class="content">config</span></span>
  <span class="key">namespace</span>: <span class="string"><span class="content">moon</span></span>
<span class="key">data</span>:
  <span class="key">service.json</span>: <span class="string"><span class="delimiter">|</span><span class="content">
    {
      &quot;s3&quot;: {
        &quot;endpoint&quot;: &quot;https://storage.googleapis.com&quot;,
        &quot;bucketName&quot;: &quot;moon-test&quot;,
        &quot;version&quot;: &quot;S3v2&quot;
      }
    }</span></span>
<span class="head"><span class="head">---</span></span>
<span class="key">apiVersion</span>: <span class="string"><span class="content">apps/v1beta1</span></span>
<span class="key">kind</span>: <span class="string"><span class="content">Deployment</span></span>
<span class="key">metadata</span>:
  <span class="key">name</span>: <span class="string"><span class="content">moon</span></span>
  <span class="key">namespace</span>: <span class="string"><span class="content">moon</span></span>
<span class="key">spec</span>:
  <span class="key">template</span>:
    <span class="key">metadata</span>:
      <span class="key">labels</span>:
        <span class="key">app</span>: <span class="string"><span class="content">moon</span></span>
    <span class="key">spec</span>:
      <span class="key">containers</span>:
      - <span class="string"><span class="content">name: moon</span></span>
        <span class="key">image</span>: <span class="string"><span class="content">aerokube/moon:latest-release</span></span>
        <span class="key">args</span>: <span class="string"><span class="content">[&quot;-config-file&quot;, &quot;/config/service.json&quot;]</span></span>
        <span class="key">volumeMounts</span>:
        - <span class="string"><span class="content">name: config</span></span>
          <span class="key">mountPath</span>: <span class="string"><span class="content">/config</span></span>
          <span class="key">readOnly</span>: <span class="string"><span class="content">true</span></span>
    <span class="key">volumes</span>:
      - <span class="string"><span class="content">name: config</span></span>
        <span class="key">configMap</span>:
          <span class="key">name</span>: <span class="string"><span class="content">config</span></span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_credentials_secret"><a class="anchor" href="#_credentials_secret"></a>2.4. Credentials Secret</h3>
<div class="paragraph">
<p>Moon reads all credentials (e.g. S3 keys) from an optional Kubernetes secret called <code>credentials</code>. This secret is mounted to Moon container as a regular directory with files corresponding to different. Path to credentials directory is specified with <code>-credentials-file</code> Moon flag. Any changes to credentials secret are applied immediately - no need to restart Moon.</p>
</div>
<div class="listingblock">
<div class="title">Adding credentials secret to Moon</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">apiVersion</span>: <span class="string"><span class="content">v1</span></span>
<span class="key">kind</span>: <span class="string"><span class="content">Secret</span></span>
<span class="key">metadata</span>:
  <span class="key">name</span>: <span class="string"><span class="content">credentials</span></span>
  <span class="key">namespace</span>: <span class="string"><span class="content">moon</span></span>
<span class="key">stringData</span>:
  <span class="key">s3.accessKey</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">access-key-value</span><span class="delimiter">&quot;</span></span>
  <span class="key">s3.secretKey</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">secret-key-value</span><span class="delimiter">&quot;</span></span>
<span class="head"><span class="head">---</span></span>
<span class="key">apiVersion</span>: <span class="string"><span class="content">apps/v1beta1</span></span>
<span class="key">kind</span>: <span class="string"><span class="content">Deployment</span></span>
<span class="key">metadata</span>:
  <span class="key">name</span>: <span class="string"><span class="content">moon</span></span>
  <span class="key">namespace</span>: <span class="string"><span class="content">moon</span></span>
<span class="key">spec</span>:
  <span class="key">template</span>:
    <span class="key">metadata</span>:
      <span class="key">labels</span>:
        <span class="key">app</span>: <span class="string"><span class="content">moon</span></span>
    <span class="key">spec</span>:
      <span class="key">containers</span>:
      - <span class="string"><span class="content">name: moon</span></span>
        <span class="key">image</span>: <span class="string"><span class="content">aerokube/moon:latest-release</span></span>
        <span class="key">args</span>: <span class="string"><span class="content">[&quot;-credentials-dir&quot;, &quot;/credentials&quot;]</span></span>
        <span class="key">volumeMounts</span>:
        - <span class="string"><span class="content">name: credentials</span></span>
          <span class="key">mountPath</span>: <span class="string"><span class="content">/credentials</span></span>
          <span class="key">readOnly</span>: <span class="string"><span class="content">true</span></span>
    <span class="key">volumes</span>:
    - <span class="string"><span class="content">name: credentials</span></span>
      <span class="key">secret</span>:
        <span class="key">secretName</span>: <span class="string"><span class="content">credentials</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The following keys are supported:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 2. Supported Credentials Secret Keys</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">s3.accessKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S3 access key value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">s3.secretKey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S3 secret key value</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_installing_license"><a class="anchor" href="#_installing_license"></a>2.5. Installing License</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
According to license agreement you can use <strong>up to 4 parallel sessions without a license</strong>. If you wish to have more parallel sessions - order a license and follow this section steps to install the license.
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>To install a license you should have a license key file. A typical license file looks like this:</p>
<div class="literalblock">
<div class="content">
<pre>$ cat license.key
Ti90a3ljSWpvV3hicU5ZY3U3ZVNMUzdzalVjU29nSVU2a3lmWDdENmhOSEs4SFJVVE5LNEpKL2oxRGhWTnRhZVBEQmx5cm1SM0dFWlVpbGIwOWhBSUpvWmlQMnNtYmtoZVRDbnJ3UTlIV3grMUMzaXFJalU3L0NIZDJuSzN3QUpIS0lyV2VoVjlRVUh5NzNCMFg0NEV5KzFSVXg1elhvaC9RUkNjTlBIOHR4WWtrRFBmTFhxYTFESlI0aXNObGtobWpXY2VJNVdna1lsWHFFOUp0OUxValZPN05hb2pCcHJzY0pvZjBrZys2YkhWUDR3cUJvYVFoSFJTYzMzZzNRSTkrWVd4dlZCeExmdTVxM2k2ZnluMDRHSEhGc21Fd2owVHdVa1Z3MmI5Z2FyVXlaVFF4RDdCRjVSVjBmSUVrU1pEQ0ZQdmIvMHZoKythY1V4OVRrR2FBREZzbWR3dExxRlU4NHF3MzBVdE5nTGhnNWYxRXRCQ215R1BHR0wyK2NpR0RDZDBTSXg4K1RsRGNWVzUyVVY4MUt6bkdOanJhTklOeXVtYjVPVXF6aVVpdmJZeVJNVVBSMWF3NUJRVGJDaHVycWVVdGtMMWFRZDgwOCtoWGRxODFOakxRNEJlVENNQTdPL2FneHBTUE1nL0J2QmVQKy84ZGhJeXd5Y0lxQVJhVWxocUdmUko2K05tbkFYV0hzZ2RjTng1dUVHU0w5VWF5TU1rR3RkZEZKQ1FiWmF0RnJMaDFHbHhKTndBRHFWcXIvQ0oxSzBQL2p6K2NFSWpsSG82TktvM3pudVFlanhYT2tGU1p1bWZrS1krZmF3VkVRZWlvcFlmZFk0TU9tc3U5TThsbng3T2VXQXZmOTFUQ2w1NUhBK1ZsQTMzN3VFOG1WV3ZlS0E1Tlk9O2V5SnNhV05sYm5ObFpTSTZJa0ZqYldVZ1RFeERJaXdpY0hKdlpIVmpkQ0k2SWsxdmIyNGlMQ0p0WVhoVFpYTnphVzl1Y3lJNk1qQXNJblJ2SWpveE5UTTRNelV5TURBd2ZRPT0=</pre>
</div>
</div>
<div class="paragraph">
<p>Moon container is expecting to find license key file in the path specified by <code>-license-file</code> parameter. You need to mount license key file as a volume to every Moon container</p>
</div>
</li>
<li>
<p>Having a license key file - create a Kubernetes secret:</p>
<div class="literalblock">
<div class="content">
<pre>$ kubectl create secret generic license-key --from-file /path/to/license.key -n moon</pre>
</div>
</div>
<div class="paragraph">
<p>If you prefer YAML - this will look like:</p>
</div>
<div class="listingblock">
<div class="title">Creating a secret for license key</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">apiVersion</span>: <span class="string"><span class="content">v1</span></span>
<span class="key">kind</span>: <span class="string"><span class="content">Secret</span></span>
<span class="key">metadata</span>:
  <span class="key">name</span>: <span class="string"><span class="content">license-key</span></span>
  <span class="key">namespace</span>: <span class="string"><span class="content">moon</span></span>
<span class="key">stringData</span>:
  <span class="key">license.key</span>: <span class="string"><span class="content">Ti90a3ljSWpvV3hicU5ZY3U3ZVNMUzdzalVjU29nSVU2a3lmWDdENmhOSEs4SFJVVE5LNEpKL2oxRGhWTnRhZVBEQmx5cm1SM0dFWlVpbGIwOWhBSUpvWmlQMnNtYmtoZVRDbnJ3UTlIV3grMUMzaXFJalU3L0NIZDJuSzN3QUpIS0lyV2VoVjlRVUh5NzNCMFg0NEV5KzFSVXg1elhvaC9RUkNjTlBIOHR4WWtrRFBmTFhxYTFESlI0aXNObGtobWpXY2VJNVdna1lsWHFFOUp0OUxValZPN05hb2pCcHJzY0pvZjBrZys2YkhWUDR3cUJvYVFoSFJTYzMzZzNRSTkrWVd4dlZCeExmdTVxM2k2ZnluMDRHSEhGc21Fd2owVHdVa1Z3MmI5Z2FyVXlaVFF4RDdCRjVSVjBmSUVrU1pEQ0ZQdmIvMHZoKythY1V4OVRrR2FBREZzbWR3dExxRlU4NHF3MzBVdE5nTGhnNWYxRXRCQ215R1BHR0wyK2NpR0RDZDBTSXg4K1RsRGNWVzUyVVY4MUt6bkdOanJhTklOeXVtYjVPVXF6aVVpdmJZeVJNVVBSMWF3NUJRVGJDaHVycWVVdGtMMWFRZDgwOCtoWGRxODFOakxRNEJlVENNQTdPL2FneHBTUE1nL0J2QmVQKy84ZGhJeXd5Y0lxQVJhVWxocUdmUko2K05tbkFYV0hzZ2RjTng1dUVHU0w5VWF5TU1rR3RkZEZKQ1FiWmF0RnJMaDFHbHhKTndBRHFWcXIvQ0oxSzBQL2p6K2NFSWpsSG82TktvM3pudVFlanhYT2tGU1p1bWZrS1krZmF3VkVRZWlvcFlmZFk0TU9tc3U5TThsbng3T2VXQXZmOTFUQ2w1NUhBK1ZsQTMzN3VFOG1WV3ZlS0E1Tlk9O2V5SnNhV05sYm5ObFpTSTZJa0ZqYldVZ1RFeERJaXdpY0hKdlpIVmpkQ0k2SWsxdmIyNGlMQ0p0WVhoVFpYTnphVzl1Y3lJNk1qQXNJblJ2SWpveE5UTTRNelV5TURBd2ZRPT0=</span></span></code></pre>
</div>
</div>
</li>
<li>
<p>When starting Moon - mount this secret as a volume and point <code>-license-file</code> to mounted file:</p>
<div class="listingblock">
<div class="title">Starting Moon with license key</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">apiVersion</span>: <span class="string"><span class="content">apps/v1beta1</span></span>
<span class="key">kind</span>: <span class="string"><span class="content">Deployment</span></span>
<span class="key">metadata</span>:
  <span class="key">name</span>: <span class="string"><span class="content">moon</span></span>
  <span class="key">namespace</span>: <span class="string"><span class="content">moon</span></span>
<span class="key">spec</span>:
  <span class="key">replicas</span>: <span class="string"><span class="content">3</span></span>
  <span class="key">template</span>:
    <span class="key">metadata</span>:
      <span class="key">labels</span>:
        <span class="key">app</span>: <span class="string"><span class="content">moon</span></span>
    <span class="key">spec</span>:
      <span class="key">containers</span>:
      - <span class="string"><span class="content">name: moon</span></span>
        <span class="key">image</span>: <span class="string"><span class="content">aerokube/moon:latest-release</span></span>
        <span class="key">args</span>: <span class="string"><span class="content">[&quot;-license-file&quot;, &quot;/license/license.key&quot;]</span></span> <span class="comment"># Pointing to license key file</span>
        <span class="key">resources</span>:
            <span class="comment"># Resources here</span>
        <span class="key">ports</span>:
            <span class="comment"># Ports here</span>
        <span class="key">volumeMounts</span>:
        <span class="comment"># Other mounts here</span>
        - <span class="string"><span class="content">name: license-key</span></span> <span class="comment"># Mounting volume with license key</span>
          <span class="key">mountPath</span>: <span class="string"><span class="content">/license</span></span>
          <span class="key">readOnly</span>: <span class="string"><span class="content">true</span></span>
    <span class="key">volumes</span>:
    <span class="comment"># Other volumes here</span>
    - <span class="string"><span class="content">name: license-key</span></span> <span class="comment"># Creating volume from secret</span>
      <span class="key">secret</span>:
        <span class="key">secretName</span>: <span class="string"><span class="content">license-key</span></span></code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="_how_licenses_work"><a class="anchor" href="#_how_licenses_work"></a>2.5.1. How Licenses Work</h4>
<div class="paragraph">
<p>Every license key gives you an ability to run <strong>fixed number of parallel browser sessions</strong>. To limit maximum number of browser sessions Moon is using built-in Kubernetes <a href="https://kubernetes.io/docs/concepts/policy/resource-quotas/">resource quota</a> feature. Every browser session in Moon is a separate Kubernetes <a href="https://kubernetes.io/docs/concepts/workloads/pods/pod/">pod</a>. When started Moon checks that respective pod resource quota exists (that is to say total number of pods is limited). If not found such resource quota is automatically created. You can have any desired number of Moon, Moon API and Moon UI replicas (i.e. pods) in your cluster. These pods are added to total number of parallel browser sessions from license key. For example:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Your license key covers <strong>100</strong> parallel sessions</p>
</li>
<li>
<p>You have <strong>5</strong> pods with Moon, Moon API and Moon UI (Moon pods)</p>
</li>
<li>
<p>Correct pods quota is no more than <strong>100 + 5 = 105</strong> pods</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Having such pods quota and 5 running Moon pods, Kubernetes will allow to start 100 browser pods maximum. New browser session requests exceeding the quota will wait for previous sessions to finish, i.e. previous pods to be removed by Moon. To determine that a running pod is a Moon pod its labels are analysed. Any pod is considered a Moon pod if the following <a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/">label selector</a> matches:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>app in (moon, moon-api, moon-ui)</pre>
</div>
</div>
<div class="paragraph">
<p>So when starting Moon - you should add a label <code>app</code> with value: <code>moon</code>, <code>moon-api</code> or <code>moon-ui</code> to respective pod definitions.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_advanced_configuration"><a class="anchor" href="#_advanced_configuration"></a>2.6. Advanced Configuration</h3>
<div class="sect3">
<h4 id="_uploading_files_to_s3"><a class="anchor" href="#_uploading_files_to_s3"></a>2.6.1. Uploading Files to S3</h4>
<div class="paragraph">
<p>You can configure Moon to send sessions logs and recorded video files to <a href="https://en.wikipedia.org/wiki/Amazon_S3">S3</a>-compatible storage. Such type of storage is supported by <a href="https://aws.amazon.com/">AWS</a>, <a href="https://cloud.google.com/">Google Cloud</a>, <a href="https://azure.microsoft.com/">Microsoft Azure</a>, <a href="https://digitalocean.com/">Digital Ocean</a> and many other cloud providers. To deploy a private S3-compatible storage you can use <a href="https://minio.io/">Minio</a>. To enable S3 support in Moon:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create an S3 bucket. In this example bucket name is <code>moon-test</code>. You will get an access key and a secret key for the bucket. Also you need to know supported S3 protocol version (usually specified in documentation).</p>
</li>
<li>
<p>Create a <code>service.json</code> file with the following contents:</p>
<div class="literalblock">
<div class="content">
<pre>$ cat service.json
{
  "s3": {
    "endpoint": "https://storage.googleapis.com",
    "bucketName": "moon-test",
    "version": "S3v2"
  }
}</pre>
</div>
</div>
</li>
<li>
<p>Save <code>service.json</code> to a Kubernetes config map, mount it as a file to Moon container and then specify path to the file using <code>-config-file</code> flag as shown in <a href="#_configuration_file">Configuration File</a> section.</p>
</li>
<li>
<p>Create a Kubernetes credentials secret, mount it as a directory to Moon container and then specify path to this directory using <code>-credentials-dir</code> flag as shown in <a href="#_credentials_secret">Credentials Secret</a> section.</p>
<div class="listingblock">
<div class="title">S3 credentials secret</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">apiVersion</span>: <span class="string"><span class="content">v1</span></span>
<span class="key">kind</span>: <span class="string"><span class="content">Secret</span></span>
<span class="key">metadata</span>:
  <span class="key">name</span>: <span class="string"><span class="content">credentials</span></span>
  <span class="key">namespace</span>: <span class="string"><span class="content">moon</span></span>
<span class="key">stringData</span>:
  <span class="key">s3.accessKey</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">access-key-value</span><span class="delimiter">&quot;</span></span>
  <span class="key">s3.secretKey</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">secret-key-value</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
</li>
<li>
<p>By default files are uploaded to S3 bucket as follows:</p>
<div class="listingblock">
<div class="title">Default S3 bucket layout</div>
<div class="content">
<pre>\---my-bucket
    \---- &lt;session-id&gt;
        |---- video.mp4
        |---- session.log</pre>
</div>
</div>
<div class="paragraph">
<p>Moon allows to organize any custom S3 keys layout using <strong>S3 key pattern</strong> with placeholders. A typical S3 key pattern looks like the following:</p>
</div>
<div class="listingblock">
<div class="title">Typical S3 key pattern</div>
<div class="content">
<pre>$quota/$browserName/$browserVersion/$platformName/$sessionId</pre>
</div>
</div>
<div class="paragraph">
<p>Here every placeholder such as <code>$quota</code>, <code>$browserName</code>, <code>$browserVersion</code> and so on will be replaced by corresponding information: user name, browser name, browser version. The resulting S3 key will be used as a directory to save log and video files. A list of supported placeholders is shown in the table below:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 3. S3 Key Placeholders</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Placeholder</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">$sessionId</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Replaced by Selenium session ID</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">$browserName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Replaced by Selenium browser name capability value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">$browserVersion</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Replaced by Selenium browser version capability value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">$platformName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Replaced by Selenium platform capability value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">$date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Replaced by current date, e.g. <code>2018-11-01</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">$quota</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Replaced by quota name (i.e. user name provided in Selenium URL)</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Default S3 key pattern is just <code>$sessionId</code>:</p>
</div>
<div class="listingblock">
<div class="title">Default video and log paths</div>
<div class="content">
<pre>my-bucket/chrome-71-0-686efb96-eabe-4435-af31-21a33c8a4c8b/video.mp4
my-bucket/chrome-71-0-686efb96-eabe-4435-af31-21a33c8a4c8b/session.log</pre>
</div>
</div>
<div class="paragraph">
<p>You change S3 key pattern in <code>service.json</code> file as follows:</p>
</div>
<div class="listingblock">
<div class="title">Setting custom S3 key pattern in <code>service.json</code></div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">s3</span><span class="delimiter">&quot;</span></span>: {
    <span class="comment">// The rest of S3 settings go here...</span>
    <span class="key"><span class="delimiter">&quot;</span><span class="content">keyPattern</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">$quota/$browserName/$browserVersion/$platformName/$sessionId</span><span class="delimiter">&quot;</span></span>  <i class="conum" data-value="1"></i><b>(1)</b>
  },
  <span class="key"><span class="delimiter">&quot;</span><span class="content">images</span><span class="delimiter">&quot;</span></span>: {
    <span class="comment">//...</span>
  },
  <span class="key"><span class="delimiter">&quot;</span><span class="content">annotations</span><span class="delimiter">&quot;</span></span>: {
    <span class="comment">//...</span>
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Custom S3 key pattern</td>
</tr>
</table>
</div>
</li>
<li>
<p>When you update a config map with <code>service.json</code> or a <code>credentials secret</code> - settings are applied immediately without Moon restart.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_using_custom_docker_registry"><a class="anchor" href="#_using_custom_docker_registry"></a>2.6.2. Using Custom Docker Registry</h4>
<div class="paragraph">
<p>By default Moon downloads all images (<code>aerokube/defender</code>, <code>aerokube/logger</code> and so on) from public Docker registry. If in your environment due to security restrictions Docker images can only be downloaded from private registry you need to configure Moon to work with this registry. To do this:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Configure Kubernetes authentication to your private registry:</p>
<div class="literalblock">
<div class="content">
<pre>$ kubectl create secret docker-registry my-registry.example.com --docker-server=my-registry.example.com --docker-username=some-user --docker-password=registry-password --docker-email=some-user@example.com
$ kubectl patch serviceaccount default -p '{"imagePullSecrets": [{"name": "my-registry.example.com"}]}' # Use correct service account name here</pre>
</div>
</div>
</li>
<li>
<p>Copy all desired browser images to your registry:</p>
<div class="literalblock">
<div class="content">
<pre>selenoid/chrome:73.0 =&gt; my-registry.example.com/moon/chrome:73.0</pre>
</div>
</div>
</li>
<li>
<p>Update <a href="#_browsers_list">Browsers List</a> file (<code>browsers.json</code>) to use new browser images:</p>
<div class="listingblock">
<div class="title">Browsers List File with Custom Images</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">chrome</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">73.0</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">versions</span><span class="delimiter">&quot;</span></span>: {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">73.0</span><span class="delimiter">&quot;</span></span>: {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">image</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">my-registry.example.com/moon/chrome:73.0</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">port</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">4444</span><span class="delimiter">&quot;</span></span>
        },
        <span class="key"><span class="delimiter">&quot;</span><span class="content">72.0</span><span class="delimiter">&quot;</span></span>: {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">image</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">my-registry.example.com/moon/chrome:72.0</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">port</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">4444</span><span class="delimiter">&quot;</span></span>
        }
    }
  }
}</code></pre>
</div>
</div>
</li>
<li>
<p>Copy desired version of the Moon service images to your registry:</p>
<div class="literalblock">
<div class="content">
<pre>aerokube/moon-video-recorder:1.3.4 =&gt; my-registry.example.com/moon/moon-video-recorder:1.3.4
aerokube/defender:1.3.4 =&gt; my-registry.example.com/moon/defender:1.3.4
aerokube/logger =&gt; my-registry.example.com/moon/logger:1.3.4</pre>
</div>
</div>
</li>
<li>
<p>Override Moon service images, create a <code>service.json</code> file with the following contents:</p>
<div class="literalblock">
<div class="content">
<pre>$ cat service.json
{
  "images": {
    "videoRecorder": {
        "image": "my-registry.example.com/moon/video-recorder:latest-release"
    },
    "defender": {
        "image": "my-registry.example.com/moon/defender:latest-release"
    },
    "logger": {
        "image": "my-registry.example.com/moon/logger:latest-release"
    }
  }
}</pre>
</div>
</div>
<div class="paragraph">
<p>If you already have S3 configuration in <code>service.json</code> file - just append new <code>images</code> key to it.</p>
</div>
<div class="paragraph">
<p>You can optionally adjust CPU and memory limits for each image as follows:</p>
</div>
<div class="listingblock">
<div class="title">Adjusting memory and CPU limits for system images</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">images</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">logger</span><span class="delimiter">&quot;</span></span>: {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">image</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">my-registry.example.com/moon/logger:latest-release</span><span class="delimiter">&quot;</span></span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">cpu</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">0.3</span><span class="delimiter">&quot;</span></span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">mem</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">1024Mi</span><span class="delimiter">&quot;</span></span>
    }
  }
}</code></pre>
</div>
</div>
</li>
<li>
<p>Save <code>service.json</code> to a Kubernetes config map, mount it as a file to Moon container and then specify path to the file using <code>-config-file</code> flag as shown in <a href="#_configuration_file">Configuration File</a> section. When you update a config map with <code>service.json</code> - settings are applied immediately without Moon restart.</p>
</li>
<li>
<p>Copy desired version of Moon main images to your registry:</p>
<div class="literalblock">
<div class="content">
<pre>aerokube/moon:1.3.4 =&gt; my-registry.example.com/moon/moon:1.3.4
aerokube/moon-api:1.3.4 =&gt; my-registry.example.com/moon/moon-api:1.3.4
aerokube/selenoid-ui:1.6.5 =&gt; my-registry.example.com/moon/selenoid-ui:1.6.5</pre>
</div>
</div>
</li>
<li>
<p>Use new main Moon images from the previous step in Kubernetes YAML definitions to start Moon, Moon API and Moon UI.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_adjusting_timeouts"><a class="anchor" href="#_adjusting_timeouts"></a>2.6.3. Adjusting Timeouts</h4>
<div class="paragraph">
<p>Sometimes things go wrong: user can unexpectedly disconnect or browser session starts longer than needed. This can lead to overall cluster degradation because of broken browser pods occupying all available hardware. To prevent such cases Moon automatically detects and closes suspicious browser sessions. Several flags allow to adjust timeout settings:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 4. Available Timeout Flags</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Flag</th>
<th class="tableblock halign-left valign-top">Default Value</th>
<th class="tableblock halign-left valign-top">Meaning</th>
<th class="tableblock halign-left valign-top">Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">-timeout</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 minute</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum browser session idle time - measured as maximum time between separate HTTP requests corresponding to a running session.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When this timeout expires - session is automatically closed. You may need to increase this timeout when tested application pages load too slowly.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">-session-attempt-timeout</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10 minutes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum time to start browser pod.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This time includes Kubernetes scheduling time and browser image download duration.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_adjusting_resources_consumption"><a class="anchor" href="#_adjusting_resources_consumption"></a>2.6.4. Adjusting Resources Consumption</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Flags and fields described in this section apply to browser container consumption only. Other system containers started in browser pod have reasonable fixed values assigned.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Moon has reasonable defaults for resources consumed by every browser pod. Sometimes you may need to override these settings. To override resource settings globally for every browser image use one of the following flags:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 5. Resources Consumption Flags</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Flag</th>
<th class="tableblock halign-left valign-top">Default Value</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">-cpu-limit</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hard CPU limit for browser container (no more than this limit is given)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">-cpu-request</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Soft (guaranteed) CPU limit for browser container</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">-memory-limit</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1Gi</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hard memory limit for browser container</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">-memory-request</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">512Mi</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Soft memory limit for browser container</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>You can also override the same values for every browser image in browsers list file:</p>
</div>
<div class="listingblock">
<div class="title">Overriding Resources in Browsers List File</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">firefox</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">62.0</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">versions</span><span class="delimiter">&quot;</span></span>: {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">62.0</span><span class="delimiter">&quot;</span></span>: {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">image</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">selenoid/firefox:62.0</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">port</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">4444</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">path</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">/wd/hub</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">resources</span><span class="delimiter">&quot;</span></span>: {                              <i class="conum" data-value="1"></i><b>(1)</b>
          <span class="key"><span class="delimiter">&quot;</span><span class="content">limits</span><span class="delimiter">&quot;</span></span>: {                               <i class="conum" data-value="2"></i><b>(2)</b>
            <span class="key"><span class="delimiter">&quot;</span><span class="content">cpu</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">2</span><span class="delimiter">&quot;</span></span>,                             <i class="conum" data-value="3"></i><b>(3)</b>
            <span class="key"><span class="delimiter">&quot;</span><span class="content">memory</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">2Gi</span><span class="delimiter">&quot;</span></span>                         <i class="conum" data-value="4"></i><b>(4)</b>
          },
          <span class="key"><span class="delimiter">&quot;</span><span class="content">requests</span><span class="delimiter">&quot;</span></span>: {                             <i class="conum" data-value="5"></i><b>(5)</b>
            <span class="key"><span class="delimiter">&quot;</span><span class="content">cpu</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">200m</span><span class="delimiter">&quot;</span></span>,                          <i class="conum" data-value="6"></i><b>(6)</b>
            <span class="key"><span class="delimiter">&quot;</span><span class="content">memory</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">1Gi</span><span class="delimiter">&quot;</span></span>                         <i class="conum" data-value="7"></i><b>(7)</b>
          }
        }
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Resources definition section</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Limits definition section</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>CPU limit field</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Memory limit field</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Requests definition section</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>CPU request field</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Memory request field</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In some installations you may also want to completely disable CPU or memory limits for all browsers pods. This can be achieved with one of the following flags:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 6. Disabling Memory and CPU limits</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Flag</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">-disable-cpu-limits</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Completely disables CPU limits for all browser pods</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">-disable-memory-limits</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Completely disables memory limits for all browser pods</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_running_browser_pods_in_privileged_mode"><a class="anchor" href="#_running_browser_pods_in_privileged_mode"></a>2.6.5. Running Browser Pods in Privileged Mode</h4>
<div class="paragraph">
<p>In some cases like running Android emulators browser container should be run in <code>privileged</code> mode. This setting can be applied separately to each browser version in browsers list file as follows:</p>
</div>
<div class="listingblock">
<div class="title">Starting Container in Privileged Mode</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">firefox</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">62.0</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">versions</span><span class="delimiter">&quot;</span></span>: {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">62.0</span><span class="delimiter">&quot;</span></span>: {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">image</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">selenoid/firefox:62.0</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">port</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">4444</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">path</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">/wd/hub</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">privileged</span><span class="delimiter">&quot;</span></span>: <span class="predefined-constant">true</span>                  <i class="conum" data-value="1"></i><b>(1)</b>
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Launch container in privileged mode</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_using_node_selectors"><a class="anchor" href="#_using_node_selectors"></a>2.6.6. Using Node Selectors</h4>
<div class="paragraph">
<p>Sometimes you may need to run browser pods on particular Kubernetes nodes (i.e. hardware hosts) only. Kubernetes allows to do this by specifying so called <a href="https://kubernetes.io/docs/concepts/configuration/assign-pod-node/">node selectors</a>. To provide such selector to Moon browser pods update browsers list as shown below:</p>
</div>
<div class="listingblock">
<div class="title">Adding Node Selectors</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">firefox</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">62.0</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">versions</span><span class="delimiter">&quot;</span></span>: {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">62.0</span><span class="delimiter">&quot;</span></span>: {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">image</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">selenoid/firefox:62.0</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">port</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">4444</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">path</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">/wd/hub</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">nodeSelector</span><span class="delimiter">&quot;</span></span>: {                    <i class="conum" data-value="1"></i><b>(1)</b>
          <span class="key"><span class="delimiter">&quot;</span><span class="content">node-type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">hardware</span><span class="delimiter">&quot;</span></span>
        }
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Node selector for this browser version</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_using_tolerations"><a class="anchor" href="#_using_tolerations"></a>2.6.7. Using Tolerations</h4>
<div class="paragraph">
<p>Kubernetes has a cool feature called <a href="https://kubernetes.io/docs/concepts/configuration/taint-and-toleration/">Taints</a> allowing to fine tune pods scheduling across nodes. If you wish to run browser pods on tainted nodes - you have to adjust so-called <code>tolerations</code>, that is to say a number of conditions to match against tainted nodes. Moon is using exactly the same format as Kubernetes to define tolerations:</p>
</div>
<div class="listingblock">
<div class="title">Adding Tolerations</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">firefox</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">62.0</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">versions</span><span class="delimiter">&quot;</span></span>: {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">62.0</span><span class="delimiter">&quot;</span></span>: {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">image</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">selenoid/firefox:62.0</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">port</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">4444</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">path</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">/wd/hub</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">tolerations</span><span class="delimiter">&quot;</span></span>: [                    <i class="conum" data-value="1"></i><b>(1)</b>
            {
                <span class="key"><span class="delimiter">&quot;</span><span class="content">key</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">key1</span><span class="delimiter">&quot;</span></span>,
                <span class="key"><span class="delimiter">&quot;</span><span class="content">operator</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Exists</span><span class="delimiter">&quot;</span></span>,
                <span class="key"><span class="delimiter">&quot;</span><span class="content">value</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">value1</span><span class="delimiter">&quot;</span></span>,
                <span class="key"><span class="delimiter">&quot;</span><span class="content">effect</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">NoExecute</span><span class="delimiter">&quot;</span></span>,
                <span class="key"><span class="delimiter">&quot;</span><span class="content">tolerationSeconds</span><span class="delimiter">&quot;</span></span>: <span class="integer">3600</span>
            }
        ]
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>A list of tolerations for this browser version</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_using_custom_kubernetes_annotations"><a class="anchor" href="#_using_custom_kubernetes_annotations"></a>2.6.8. Using Custom Kubernetes Annotations</h4>
<div class="paragraph">
<p>In some cases you may need to add custom <a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/annotations/">Kubernetes annotations</a> to started browser pods. Moon allows to configure custom annotations globally or individually for every browser version. Global annotations are configured in <a href="#_configuration_file">Configuration File</a> (aka <code>service.json</code>) as follows:</p>
</div>
<div class="listingblock">
<div class="title">Adding global annotations to <code>service.json</code> file</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">s3</span><span class="delimiter">&quot;</span></span>: {
    <span class="comment">//...</span>
  },
  <span class="key"><span class="delimiter">&quot;</span><span class="content">images</span><span class="delimiter">&quot;</span></span>: {
    <span class="comment">//...</span>
  },
  <span class="key"><span class="delimiter">&quot;</span><span class="content">annotations</span><span class="delimiter">&quot;</span></span>: {                                 <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="key"><span class="delimiter">&quot;</span><span class="content">key1</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">value1</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">key2</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">value2</span><span class="delimiter">&quot;</span></span>
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>A list of global Kubernetes annotations</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To configure Kubernetes annotations for single desired browser version - just add the same <code>annotations</code> section to <a href="#_browsers_list">Browsers List</a> file as follows:</p>
</div>
<div class="listingblock">
<div class="title">Adding Tolerations</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">firefox</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">62.0</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">versions</span><span class="delimiter">&quot;</span></span>: {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">62.0</span><span class="delimiter">&quot;</span></span>: {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">image</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">selenoid/firefox:62.0</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">port</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">4444</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">path</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">/wd/hub</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">annotations</span><span class="delimiter">&quot;</span></span>: {                           <i class="conum" data-value="1"></i><b>(1)</b>
          <span class="key"><span class="delimiter">&quot;</span><span class="content">key1</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">value1</span><span class="delimiter">&quot;</span></span>,
          <span class="key"><span class="delimiter">&quot;</span><span class="content">key2</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">value2</span><span class="delimiter">&quot;</span></span>
        }
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>A list of Kubernetes annotations for this browser version</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Moon adds some annotations by default and their names are reserved:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 7. Moon Reserved Annotation Names</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Custom session label passed in <code>name</code> capability</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">timeZone</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Custom time zone value passed in <code>timeZone</code> capability</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_log_files"><a class="anchor" href="#_log_files"></a>2.7. Log Files</h3>
<div class="paragraph">
<p>Although Moon should just work out of the box, sometimes you may need the log output. Every Moon component is outputting logs to standard output (<code>stdout</code>) so you can use well-known <code>kubectl</code> commands to see the log:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ kubectl get pods -n moon
NAME                    READY     STATUS    RESTARTS   AGE
moon-58f8b57966-s648q   1/1       Running   0          1m</pre>
</div>
</div>
<div class="paragraph">
<p>Everything related to Selenium sessions is being output by <code>moon</code> container:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ kubectl logs moon-58f8b57966-s648q -c moon -n moon
2019/05/03 11:20:37 [INIT] [Loading quota files from: quota]
2019/05/03 11:20:37 [INIT] [Quota configuration updated]
2019/05/03 11:20:37 [INIT] [Loading users from: users/users.htpasswd]
...</pre>
</div>
</div>
<div class="paragraph">
<p>To follow the logs while running the tests add <code>-f</code> flag:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ kubectl logs -f moon-58f8b57966-s648q -c moon -n moon</pre>
</div>
</div>
<div class="paragraph">
<p>Every log line contains:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 8. Log entry contents</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Field</th>
<th class="tableblock halign-left valign-top">Example</th>
<th class="tableblock halign-left valign-top">Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2017/11/01 19:12:42</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Status</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[SESSION_ATTEMPTED]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">See table below for complete list of statuses.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Additional fields</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[my-user]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">One or more sections showing additional information such as browser name, user name, IP address or error message</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Duration</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[4.15s]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For some log entries this field shows how much time operation took</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The following statuses are available:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 9. Log entry statuses</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Status</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AWAITING_SERVICE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Waiting for Kubernetes service to start</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BAD_REQUEST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Failed to process user request</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BAD_RESOURCES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">User incorrectly configured browser container resources</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BAD_SCREEN_RESOLUTION</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">User requested to set wrong custom screen resolution</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BAD_TIMEZONE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">User requested to set wrong custom time zone inside container</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BAD_TIMEOUT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">User requested to set wrong session timeout</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BAD_VIDEO_FRAME_RATE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">User requested to capture video with wrong frame rate</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BAD_VIDEO_SCREEN_SIZE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">User requested to capture video with wrong screen size</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CLIENT_DISCONNECTED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">User disconnected and session was interrupted</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CREATING_POD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Starting to create pod with browser</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CREATING_SERVICE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Starting to create service for browser session</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DELETING_POD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Starting to delete pod with browser</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DELETING_SERVICE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Starting to delete service for browser session</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DELETING_SESSION</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Received request to delete browser session</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EMPTY_REQUEST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Received empty request from user</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FAILED_TO_CREATE_POD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Failed to create browser pod</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FAILED_TO_CREATE_SERVICE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Failed to create browser service</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FAILED_TO_DELETE_POD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Failed to delete browser pod</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FAILED_TO_DELETE_SERVICE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Failed to delete browser service</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FAILED_TO_DELETE_SESSION</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Failed to delete browser session</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FAILED_TO_GET_LOGS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Failed to get session logs</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FORBIDDEN_TO_CREATE_POD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kubernetes return forbidden status when creating pod</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">INIT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Service initialization messages</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LOGS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Requested session logs</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LOGS_CLIENT_DISCONNECTED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Client disconnected while streaming session logs</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MALFORMED_VOLUME</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Moon skipped malformed volume specification from <code>browsers.json</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">POD_CREATED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Browser pod created</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">POD_DELETED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Browser pod deleted</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PROXYING</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Proxying requests to specified URL</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PROXY_ERROR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Failed to proxy requests to specified URL</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SERVER_ERROR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Failed to create pod or service due to internal server error (probably a bug)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SERVICE_CREATED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Browser service created</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SERVICE_DELETED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Browser service deleted</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SERVICE_IS_UP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Browser service successfully started</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SESSION_CREATED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Browser session successfully created</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SESSION_DELETED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Session successfully deleted</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SESSION_FAILED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Failed to create new session</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SESSION_TIMED_OUT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Existing session timed out</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SESSION_NOT_FOUND</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Received request with empty session ID</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SHUTTING_DOWN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Shutting down the service</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">STATUS_ERROR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Failed to refresh Moon status</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">STATUS_REQUEST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Received Moon status request</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">STATUS_REQUEST_ERROR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Failed to return Moon status</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UNSUPPORTED_BROWSER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">User requested unsupported browser</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">USER_NOT_FOUND</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Trying to request session with unknown user</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VNC_CLIENT_DISCONNECTED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">User disconnected while proxying VNC traffic</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VNC_ERROR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An error occurred while proxying VNC traffic</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VNC_SESSION</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">User requested VNC session</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VNC_SESSION_CLOSED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">User closed VNC session</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>You can also take a look at <code>moon-api</code> and moon-ui logs as follows:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ kubectl logs -f moon-58f8b57966-s648q -c moon-api -n moon
$ kubectl logs -f moon-58f8b57966-s648q -c moon-ui -n moon</pre>
</div>
</div>
<div class="paragraph">
<p>If you are encountering browser pods not being deleted - then take a look at <code>defender</code> container logs for every frozen browser pod:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ kubectl logs chrome-73-0-ac15ffaa-e641-4c7f-a54c-f25b5be1f135 -c defender -n moon # Here chrome-73-0-ac15ffaa-e641-4c7f-a54c-f25b5be1f135 is Selenium session ID equal to browser pod name</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_cli_flags"><a class="anchor" href="#_cli_flags"></a>2.8. CLI Flags</h3>
<div class="paragraph">
<p>These flags should be <a href="https://kubernetes.io/docs/tasks/inject-data-application/define-command-argument-container/#define-a-command-and-arguments-when-you-create-a-pod">specified</a> in Kubernetes YAML files when starting the cluster.</p>
</div>
<div class="paragraph">
<p>The following flags are supported by <code>moon</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>-config-file string
    optional configuration file (default "config/service.json")
-cpu-limit string
    browser container cpu limit (default "1")
-cpu-request string
    browser container cpu request (default "0.5")
-credentials-dir string
    directory where credentials are mounted (default "credentials")
-disable-cpu-limits
    disable cpu limits for pods
-disable-memory-limits
    disable memory limits for pods
-grace-period duration
    graceful shutdown (default 30s)
-guest-user string
    guest quota user name (default "browsers")
-license-file string
    path to license file (default "license/license.key")
-listen string
    address to bind (default ":4444")
-memory-limit string
    browser container memory limit (default "1Gi")
-memory-request string
    browser container memory request (default "512Mi")
-namespace string
    namespace
-quota-dir string
    quota directory (default "quota")
-session-attempt-timeout duration
    new session attempt timeout (default 30m0s)
-timeout duration
    override session timeout (default 1m0s)
-users-file string
    path to users file (default "users/users.htpasswd")
-version
    show version and exit</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_main_features"><a class="anchor" href="#_main_features"></a>3. Main Features</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_special_capabilities"><a class="anchor" href="#_special_capabilities"></a>3.1. Special Capabilities</h3>
<div class="paragraph">
<p>Moon supports a set of custom capabilities. You can pass them in tests to enable or disable some features.</p>
</div>
<div class="sect3">
<h4 id="_live_browser_screen_enablevnc"><a class="anchor" href="#_live_browser_screen_enablevnc"></a>3.1.1. Live Browser Screen: enableVNC</h4>
<div class="paragraph">
<p>Moon supports showing browser screen during test execution. To see browser screen add capability:</p>
</div>
<div class="listingblock">
<div class="title">Type: boolean</div>
<div class="content">
<pre>enableVNC: true</pre>
</div>
</div>
<div class="paragraph">
<p>Browser screen will be shown in <a href="http://aerokube.com/selenoid-ui/latest/">Selenoid UI</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_custom_screen_resolution_screenresolution"><a class="anchor" href="#_custom_screen_resolution_screenresolution"></a>3.1.2. Custom Screen Resolution: screenResolution</h4>
<div class="paragraph">
<p>Moon allows you to set custom screen resolution in containers being run:</p>
</div>
<div class="listingblock">
<div class="title">Type: string, format: &lt;width&gt;x&lt;height&gt;</div>
<div class="content">
<pre>screenResolution: "1280x1024"</pre>
</div>
</div>
<div class="paragraph">
<p>You can optionally add colors depth:</p>
</div>
<div class="listingblock">
<div class="title">Type: string, format: &lt;width&gt;x&lt;height&gt;x&lt;colors-depth&gt;</div>
<div class="content">
<pre>screenResolution: "1280x1024x24"</pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This capability sets only screen resolution - not browser window size.
Most of browsers have some default window size value this is why your screenshot size can be smaller than screen resolution specified in capability.
You should manually resize window to desired width and height or use Selenium <code>maximize</code> operation.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_android_skin_skin"><a class="anchor" href="#_android_skin_skin"></a>3.1.3. Android Skin: skin</h4>
<div class="paragraph">
<p>When testing for Android platform you can select emulator skin with capabilities. List of available skins:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 10. Available Android Skins</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Skin</th>
<th class="tableblock halign-left valign-top">Screen Resolution</th>
<th class="tableblock halign-left valign-top">DPI</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">QVGA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">240x320</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">120</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WQVGA400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">240x400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">120</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WQVGA432</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">240x432</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">120</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HVGA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">320x480</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">160</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WVGA800</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">480x800</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">240</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WVGA854</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">480x854</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">240</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WSVGA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1024x600</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">160</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WXGA720</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">720x1280</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">320</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WXGA800</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1280x800</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">160</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WXGA800-7in</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">800x1280</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">213</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>To select a skin - set <code>skin</code> capability:</p>
</div>
<div class="listingblock">
<div class="title">Type: string, format: &lt;desired-skin&gt;</div>
<div class="content">
<pre>skin: "WXGA720"</pre>
</div>
</div>
<div class="paragraph">
<p>You can also pass desired screen resolution as follows:</p>
</div>
<div class="listingblock">
<div class="title">Type: string, format: &lt;desired-screen-resolution&gt;</div>
<div class="content">
<pre>skin: "720x1280"</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_video_recording_enablevideo_videoname_videoscreensize_videoframerate_videocodec"><a class="anchor" href="#_video_recording_enablevideo_videoname_videoscreensize_videoframerate_videocodec"></a>3.1.4. Video Recording: enableVideo, videoName, videoScreenSize, videoFrameRate, videoCodec</h4>
<div class="paragraph">
<p>To enable video recording for session, add:</p>
</div>
<div class="listingblock">
<div class="title">Type: boolean</div>
<div class="content">
<pre>enableVideo: true</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>By default saved video files are named <code>&lt;session-id&gt;.mp4</code> where <code>&lt;session-id&gt;</code> is a unique identifier of Selenium session.
To provide custom video name specify:</p>
<div class="listingblock">
<div class="title">Type: string</div>
<div class="content">
<pre>videoName: "my-cool-video.mp4"</pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
It is important to add <code>mp4</code> file extension.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>By default the entire screen picture is being recorded.
Specifying <code>screenResolution</code> capability changes recorded video size (width and height) accordingly.
You can override video screen size by passing a capability. In case of <code>videoScreenSize</code>
resolution is less than actual, screen on video will be trimmed starting from top-left corner:</p>
<div class="listingblock">
<div class="title">Type: string</div>
<div class="content">
<pre>videoScreenSize: "1024x768"</pre>
</div>
</div>
</li>
<li>
<p>Default video frame rate is <code>12</code> frames per second. Specifying <code>videoFrameRate</code> capability changes this value:</p>
<div class="listingblock">
<div class="title">Type: int</div>
<div class="content">
<pre>videoFrameRate: 24</pre>
</div>
</div>
</li>
<li>
<p>By default Moon is using <code>libx264</code> codec for video output. If this codec is consuming too much CPU, you can change it using <code>videoCodec</code> capability:</p>
<div class="listingblock">
<div class="title">Type: string</div>
<div class="content">
<pre>videoCodec: "mpeg4"</pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_custom_test_name_name"><a class="anchor" href="#_custom_test_name_name"></a>3.1.5. Custom Test Name: name</h4>
<div class="paragraph">
<p>For debugging purposes it is often useful to give a distinct name to every test case. You can set test case name by passing the following capability:</p>
</div>
<div class="listingblock">
<div class="title">Type: string</div>
<div class="content">
<pre>name: "myCoolTestName"</pre>
</div>
</div>
<div class="paragraph">
<p>The main application of this capability - is debugging tests in the UI which is showing specified name for every running session.</p>
</div>
</div>
<div class="sect3">
<h4 id="_per_session_time_zone_timezone"><a class="anchor" href="#_per_session_time_zone_timezone"></a>3.1.6. Per-session Time Zone: timeZone</h4>
<div class="paragraph">
<p>Some tests require particular time zone to be set in operating system.</p>
</div>
<div class="listingblock">
<div class="title">Type: string</div>
<div class="content">
<pre>timeZone: "Europe/Moscow"</pre>
</div>
</div>
<div class="paragraph">
<p>You can find most of available time zones <a href="https://en.wikipedia.org/wiki/List_of_tz_database_time_zones">here</a>.
Without this capability launched browser containers will have Moon timezone.</p>
</div>
</div>
<div class="sect3">
<h4 id="_per_session_environment_variables_env"><a class="anchor" href="#_per_session_environment_variables_env"></a>3.1.7. Per-session Environment Variables: env</h4>
<div class="paragraph">
<p>Sometimes you may want to set some environment variables for every test case (for example to test with different default locales). To achieve this pass one more capability:</p>
</div>
<div class="listingblock">
<div class="title">Type: array, format: &lt;key&gt;=&lt;value&gt;</div>
<div class="content">
<pre>env: ["LANG=ru_RU.UTF-8", "LANGUAGE=ru:en", "LC_ALL=ru_RU.UTF-8"]</pre>
</div>
</div>
<div class="paragraph">
<p>Environment variables from this capability are appended to variables from configuration file.</p>
</div>
</div>
<div class="sect3">
<h4 id="_hosts_entries_hostsentries"><a class="anchor" href="#_hosts_entries_hostsentries"></a>3.1.8. Hosts Entries: hostsEntries</h4>
<div class="paragraph">
<p>Although you can configure a separate list of <code>/etc/hosts</code> entries for every browser image in <a href="#_browsers_list">Browsers List</a> sometimes you may need to add more entries for particular test cases. This can be easily achieved with:</p>
</div>
<div class="listingblock">
<div class="title">Type: array, format: &lt;hostname&gt;:&lt;ip-address&gt;</div>
<div class="content">
<pre>hostsEntries: ["example.com:192.168.0.1", "test.com:192.168.0.2"]</pre>
</div>
</div>
<div class="paragraph">
<p>Entries from this capability will be override <code>/etc/hosts</code> entries from browsers list file.</p>
</div>
</div>
<div class="sect3">
<h4 id="_custom_session_timeout_sessiontimeout"><a class="anchor" href="#_custom_session_timeout_sessiontimeout"></a>3.1.9. Custom Session Timeout: sessionTimeout</h4>
<div class="paragraph">
<p>Sometimes you may want to change idle timeout for selected browser session. To achieve this - pass the following capability:</p>
</div>
<div class="listingblock">
<div class="title">Type: int</div>
<div class="content">
<pre>sessionTimeout: 1m30s</pre>
</div>
</div>
<div class="paragraph">
<p>Timeout is always specified in Golang duration format, e.g. <code>30s</code> or <code>2m</code> or <code>1h</code> and so on.</p>
</div>
</div>
<div class="sect3">
<h4 id="_specifying_capabilities_via_protocol_extensions"><a class="anchor" href="#_specifying_capabilities_via_protocol_extensions"></a>3.1.10. Specifying Capabilities via Protocol Extensions</h4>
<div class="paragraph">
<p>Some Selenium clients allow passing only a limited number of capabilities specified in <a href="https://w3c.github.io/webdriver/webdriver-spec.html">WebDriver specification</a>. For such cases Moon supports reading capabilities using <a href="https://w3c.github.io/webdriver/webdriver-spec.html#protocol-extensions">WebDriver protocol extensions</a> feature. The following two examples deliver the same result. Usually capabilities are passed like this:</p>
</div>
<div class="listingblock">
<div class="title">Passing Capabilities as Usually</div>
<div class="content">
<pre>{"browserName": "firefox", "version": "62.0", "screenResolution": "1280x1024x24"}</pre>
</div>
</div>
<div class="paragraph">
<p>Moon is using <code>moon:options</code> key to read protocol extension capabilities:</p>
</div>
<div class="listingblock">
<div class="title">Passing Capabilities using Protocol Extensions</div>
<div class="content">
<pre>{"browserName": "firefox", "version": "62.0", "moon:options": {"screenResolution": "1280x1024x24"}}</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_accessing_files_downloaded_with_browser"><a class="anchor" href="#_accessing_files_downloaded_with_browser"></a>3.2. Accessing Files Downloaded with Browser</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Files are accessible only when browser session is running.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Your tests may need to download files with browsers. To analyze these files a common requirement is then to somehow extract downloaded files from browser containers. Moon provides a <code>/download</code> API dramatically simplifying downloading such files. To work with it:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Start a new session, for example with ID <code>firefox-61-0-f2bcd32b-d932-4cdc-a639-687ab8e4f840</code>.</p>
</li>
<li>
<p>In tests code save all files to <code>~/Downloads</code> directory.</p>
</li>
<li>
<p>Access all downloaded files using an URL:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>http://moon-host.example.com:4444/download/firefox-61-0-f2bcd32b-d932-4cdc-a639-687ab8e4f840/myfile.txt</code></pre>
</div>
</div>
</li>
<li>
<p>Close the session</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_accessing_clipboard"><a class="anchor" href="#_accessing_clipboard"></a>3.3. Accessing Clipboard</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Clipboard is accessible only when browser session is running.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Sometimes you may need to interact with the clipboard to check that your application copy-paste feature works. Moon has a dedicated API to interact with the clipboard. To use it:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Start a new session, for example with ID <code>firefox-61-0-f2bcd32b-d932-4cdc-a639-687ab8e4f840</code>.</p>
</li>
<li>
<p>To get clipboard value send the following HTTP request:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>$ curl http://moon-host.example.com:4444/clipboard/firefox-61-0-f2bcd32b-d932-4cdc-a639-687ab8e4f840

some-clipboard-value</code></pre>
</div>
</div>
</li>
<li>
<p>To update clipboard value:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>$ curl -X POST --data 'some-clipboard-value' http://moon-host.example.com:4444/clipboard/firefox-61-0-f2bcd32b-d932-4cdc-a639-687ab8e4f840</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_license_agreement"><a class="anchor" href="#_license_agreement"></a>4. License Agreement</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Last updated February 17th, 2019. Replaces the prior version in its entirety.</p>
</div>
<div class="paragraph">
<p>This is a legal agreement. By downloading, installing, copying, saving on Customer&#8217;s computer, or otherwise using Aerokube software, support or products Customer becomes a party to this Agreement and Customer consents to be bound by all the terms and conditions set forth below.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Parties</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><strong>"Aerokube"</strong>, <strong>"Licensor"</strong> or <strong>"We"</strong> means <strong>Aerokube Software OÜ</strong>, having its principal place of business at Harju maakond, Tallinn, Kesklinna linnaosa, Estonia pst 5-309B, 10143, Estonia, registered in the Commercial Register of Estonia, registry code: 14653208.</p>
</li>
<li>
<p><strong>"Customer"</strong>, <strong>"Licensee"</strong> or <strong>"You"</strong> means the sole proprietor or legal entity specified in the Subscription Confirmation. For legal entities, "Customer" includes any entity which controls, is controlled by, or is under common control with Customer. For the purposes of this definition, "control" means one of the following:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>The power, directly or indirectly, to direct or manage such entity, whether by contract or otherwise.</p>
</li>
<li>
<p>Ownership of fifty percent (50%) or more of the outstanding shares or beneficial ownership of such entity.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
<li>
<p><strong>Definitions</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><strong>"Agreement"</strong> means this License Agreement.</p>
</li>
<li>
<p><strong>"Product"</strong> means any generally available Licensor&#8217;s software product identified by Licensor as a software developer tool. For the avoidance of doubt, the Product is not produced to the specifications of Customer nor customized through modification or personalization, is intended for mass distribution, and no software code will be provided to Customer.</p>
</li>
<li>
<p><strong>"User"</strong> means any employee, independent contractor or other personnel obtaining access to the Product(s) from Customer.</p>
</li>
<li>
<p><strong>"Number of Concurrent Sessions"</strong> means maximum number of software testing processes being run using the Product in parallel. This can be for example browsers executing User&#8217;s tests.</p>
</li>
<li>
<p><strong>"License Key"</strong> means a unique key-code that enables a Licensee to use the Product by unlocking the fixed Number of Concurrent Sessions. Only Licensor and/or its representatives are permitted to produce License Keys for the Product.</p>
</li>
<li>
<p><strong>"Subscription"</strong> means an arrangement for making use of the Product of periodic nature on a prepayment plan. For the purpose of clarity, Subscription includes the subscription term, Products provided to Customer, subscription fees, payment schedules and fixed number of License Keys.</p>
</li>
<li>
<p><strong>"Product Evaluation"</strong> means using the Product without a valid License Key.</p>
</li>
<li>
<p><strong>"Subscription Confirmation"</strong> means an email confirming Customer&#8217;s rights to access and use Products, including total Number of Concurrent Sessions.</p>
</li>
<li>
<p><strong>"Product Installation"</strong> means a Product copy running on Customer&#8217;s computer device, hardware server or virtual machine.</p>
</li>
<li>
<p><strong>"Product Version"</strong> means a release, update, or upgrade of a particular Product that is not identified by Licensor as being made for the purpose of fixing software bugs.</p>
</li>
<li>
<p><strong>"Bug Fix Update"</strong> for a particular Product Version means a software update or release that is specifically identified by Licensor as a bug fix for that Product Version.</p>
</li>
<li>
<p><strong>"Fallback Date"</strong> means the date that was 12 months prior to the date of expiration of the Subscription.</p>
</li>
<li>
<p><strong>"Fallback Version"</strong> means the most recent Product Version that Licensor made available for public purchase prior to the Fallback Date, along with any Bug Fix Updates for that Product Version. For the purpose of clarity, Fallback Version does not include any Product updates or upgrades other than Bug Fix Updates that Customer may have used in the period between the Fallback Date and the date of expiration of the Subscription.</p>
</li>
<li>
<p><strong>"E-mail Support"</strong> means a form of customer support provided by the Licensor. At the time of writing, the corresponding e-mail address is <strong>support@aerokube.com</strong>; should the address be changed, the new address will be referred to on the Licensor&#8217;s web site.</p>
</li>
<li>
<p><strong>"Instant Messaging Support"</strong> means a form of customer support provided by the Licensor. At the time of writing, the corresponding address to support channel is <strong><a href="https://t.me/aerokube_moon" class="bare">https://t.me/aerokube_moon</a></strong>; should the address be changed, the new address will be referred to on the Licensor&#8217;s web site.</p>
</li>
<li>
<p><strong>"Affiliate"</strong> means any entity belonging to the same group as the Licensor.</p>
</li>
</ol>
</div>
</li>
<li>
<p><strong>How this Agreement Works</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><strong>Entire Agreement.</strong> This Agreement, including the Third-Party Software license terms, constitutes the entire agreement between the parties concerning its subject matter and supersedes any prior agreements between Customer and Licensor regarding Customer&#8217;s use of any Products. No purchase order, other ordering document or any handwritten or typewritten text which purports to modify or supplement the printed text of this Agreement or any schedule will add to or vary the terms of this Agreement unless signed by both Customer and Licensor.</p>
</li>
<li>
<p><strong>Reservation of Rights.</strong> Aerokube reserves the right at any time to cease the support of the Product and to alter prices, features, specifications, capabilities, functions, terms of use, release dates, general availability or other characteristics of the Product.</p>
</li>
<li>
<p><strong>Changes to this Agreement.</strong> We may update or modify this Agreement from time to time, including any referenced policies and other documents. If a revision meaningfully reduces Customer&#8217;s rights, we will use reasonable efforts to notify Customer. If we modify this Agreement, the modified version of the Agreement will be effective from the start of the next Subscription term. In this case, if Customer objects to the updated Agreement terms, as Customer&#8217;s exclusive remedy, Customer may cancel the Subscription. Customer may be required to click through the updated Agreement to show its acceptance. For the avoidance of doubt, each Subscription Confirmation is subject to the version of the Agreement in effect on the Subscription Confirmation date.</p>
</li>
<li>
<p><strong>Opportunity to Review.</strong> Customer hereby declares that Customer has had sufficient opportunity to review this Agreement, understand the content of all of its clauses, negotiate its terms, and seek independent professional legal advice in that respect before entering into it. Consequently, any statutory "form contract" ("adhesion contract") regulations shall not be applicable to this Agreement.</p>
</li>
<li>
<p><strong>Severability.</strong> If a particular term of this Agreement is not enforceable, the unenforceability of that term will not affect any other terms of this Agreement.</p>
</li>
<li>
<p><strong>Headings.</strong> Headings and titles are for convenience only and do not affect the interpretation of this Agreement.</p>
</li>
<li>
<p><strong>No Waiver.</strong> Our failure to enforce or exercise any part of this Agreement is not a waiver of that section.</p>
</li>
<li>
<p><strong>Notice.</strong> Aerokube may deliver any notice to Customer via electronic mail to an email address provided by Customer, registered mail, personal delivery or renowned express courier (such as DHL, FedEx or UPS). Any such notice will be deemed to be effective:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>On the day the notice is sent to Customer via email.</p>
</li>
<li>
<p>Upon personal delivery.</p>
</li>
<li>
<p>One (1) day after deposit with an express courier or five (5) days after deposit in the mail, whichever occurs first.</p>
</li>
</ol>
</div>
</li>
<li>
<p><strong>Governing Law.</strong> This Agreement will be governed by the laws of the Estonia, without reference to conflict of laws principles. Customer agrees that any litigation relating to this Agreement may only be brought in, and will be subject to the jurisdiction of, any competent court of the Estonia. The parties agree that the United Nations Convention on Contracts for the International Sale of Goods does not apply to this Agreement.</p>
</li>
<li>
<p><strong>Exceptions or Modifications.</strong> For exceptions or modifications to this Agreement, please contact Aerokube at: <a href="mailto:support@aerokube.com">support@aerokube.com</a> In case the terms of this Agreement are in conflict with the terms of any agreement individually negotiated and agreed between Aerokube and Customer, the terms of the latter shall prevail.</p>
</li>
<li>
<p><strong>Force Majeure.</strong> Except with respect to Customer’s payment obligations, neither party shall be liable to the other for any delay or failure to perform any obligation under this Agreement (except for a failure to pay fees) if the delay or failure is due to unforeseen events which occur after the signing of this Agreement and which are beyond the reasonable control of such party (<strong>"Force Majeure Event"</strong>), such as a strike, blockade, war, act of terrorism, riot, natural disaster, failure or diminishment of power or telecommunications or data networks or services, or refusal of a license by a government agency. In the event of a Force Majeure Event that prevents one part from substantially performing its obligations hereunder for a period of ten (10) days or more, either party may terminate this Agreement on five (5) days written notice.</p>
</li>
</ol>
</div>
</li>
<li>
<p><strong>Grant of Rights</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The Product include code and libraries licensed to Licensor by third parties, including open source software.</p>
</li>
<li>
<p>The Product is provided basing on the Number of Concurrent Sessions. If Customer complies with the terms of this Agreement, Customer has the rights stipulated hereunder for each Subscription that Customer acquires. Customer&#8217;s rights acquired in relation to the Product are limited to those necessary to enable Customer and its Users to effectively operate the Product(s). All other rights remain reserved to Licensor.</p>
</li>
<li>
<p>Unless the Subscription has expired or this Agreement is terminated in accordance with respective section, and subject to the terms and conditions specified herein, Licensor grants Customer a non-exclusive and non-transferable right to use each Product covered by the Subscription as stipulated below.</p>
</li>
<li>
<p>Customer <strong>may</strong>:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>For each License Key included to Subscription have one Product Installation of any version covered by the Subscription on any operating system supported by the Product.</p>
</li>
<li>
<p>Make one backup copy of the Product solely for archival/security backup purposes.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Customer <strong>may not</strong>:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Allow the same Product Installation to be used concurrently by more than the Number of Concurrent Sessions specified for used License Key in Subscription Confirmation.</p>
</li>
<li>
<p>Rent, lease, reproduce, modify, adapt, create derivative works of, distribute, sell, or transfer the Product.</p>
</li>
<li>
<p>Provide access to the Product or the right to use the Product to a third party.</p>
</li>
<li>
<p>Reverse engineer, decompile, disassemble, modify, translate, make any attempt to discover the source code of the Product.</p>
</li>
<li>
<p>Remove or obscure any proprietary or other notices contained in the Product.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Following the expiration of this Agreement, the rights stipulated in "Grant of Rights" section shall continue on a perpetual, royalty-free, non-exclusive, and non-transferable basis for the continued use of a Fallback Version of each Product covered by the Subscription. The limitations set forth in this section apply to the usage of the Fallback Version. The rights granted in this section are expressly contingent upon Customer not being in breach of this Agreement, including having paid in full the applicable Subscription fees for the preceding 12 months or longer without interruption.</p>
</li>
<li>
<p>Customer acknowledges that no ownership right is conveyed to Customer under this Agreement, irrespective of the use of terms such as "purchase" or "sale". Licensor has and retains all rights, title and interest, including all intellectual property rights, in and to the Products and any and all related or underlying technology, and any modifications or derivative works thereof, including without limitation as they may incorporate Feedback (as defined below).</p>
</li>
<li>
<p>This Agreement applies whether Customer purchases a Subscription directly from Licensor or through resellers. If Customer purchases through a reseller, the Subscription details shall be as stated in the Subscription Confirmation issued by the reseller to Customer, and the reseller is responsible for the accuracy of any such Subscription Confirmation. Resellers are not authorized to make any promises or commitments on Licensor behalf, and Customer understands and agrees that Licensor is not bound by any obligations to Customer other than as specified in this Agreement.</p>
</li>
</ol>
</div>
</li>
<li>
<p><strong>Access to Products</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>All deliveries under this Agreement will be electronic. Customer and its Users must have an Internet connection in order to receive any deliveries. For the avoidance of doubt, Customer is responsible for downloading and installing the Products. Download instructions are made available on Licensor website at <a href="https://aerokube.com" class="bare">https://aerokube.com</a>.</p>
</li>
<li>
<p>Customer enables full access to Product Installation by specifying a License Key from Subscription Confirmation.</p>
</li>
<li>
<p>Subject to the terms of this Agreement, Customer is granted a right to install and use the Product for evaluation purposes without charge for unlimited amount of time. The Product contains a feature that will automatically limit allowed Number of Concurrent Sessions. Licensor reserves the right at any time to change that limit in new Product versions.</p>
</li>
</ol>
</div>
</li>
<li>
<p><strong>Fees</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Customer shall pay its Subscription fees in accordance with Licensor Terms of Purchase or the reseller&#8217;s terms of purchase, whichever are applicable.</p>
</li>
<li>
<p>The Subscription fees shall be paid in full, and any levies, duties and/or taxes imposed by Customer&#8217;s jurisdiction (including, but not limited to, value added tax, sales tax and withholding tax), shall be borne solely by Customer.</p>
</li>
<li>
<p>Customer may not deduct any amounts from fees payable to Licensor or the reseller, unless otherwise specified in the applicable terms of purchase.</p>
</li>
</ol>
</div>
</li>
<li>
<p><strong>Feedback</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Customer has no obligation to provide Licensor with ideas, suggestions, or proposals ("Feedback").</p>
</li>
<li>
<p>If Customer or Users submit Feedback to Licensor, then Customer grants Licensor a non-exclusive, worldwide, royalty-free license that is sub-licensable and transferable, to make, use, sell, have made, offer to sell, import, reproduce, publicly display, distribute, modify, or publicly perform the Feedback in any manner without any obligation, royalty or restriction based on intellectual property rights or otherwise.</p>
</li>
</ol>
</div>
</li>
<li>
<p><strong>LIMITED WARRANTY</strong></p>
<div class="paragraph">
<p>ALL PRODUCTS ARE PROVIDED TO CUSTOMER ON AN <strong>"AS IS"</strong> AND <strong>"AS AVAILABLE"</strong> BASIS WITHOUT WARRANTIES. USE OF THE PRODUCTS IS AT YOUR OWN RISK. AEROKUBE MAKES NO WARRANTY AS TO THEIR USE OR PERFORMANCE. TO THE MAXIMUM EXTENT PERMITTED BY APPLICABLE LAW, AEROKUBE, AND ITS SUPPLIERS (WHICH SHALL INCLUDE THE PROVIDERS OF THE THIRD PARTY SOFTWARE) AND RESELLERS, DISCLAIM ALL WARRANTIES AND CONDITIONS, EITHER EXPRESS OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, TITLE, AND NON-INFRINGEMENT, WITH REGARD TO THE PRODUCTS, AND THE PROVISION OF OR FAILURE TO PROVIDE SUPPORT SERVICES. THIS LIMITED WARRANTY GIVES CUSTOMER SPECIFIC LEGAL RIGHTS. CUSTOMER MAY HAVE OTHER RIGHTS, WHICH VARY FROM STATE/JURISDICTION TO STATE/JURISDICTION. AEROKUBE (AND ITS AFFILIATES, AGENTS, DIRECTORS AND EMPLOYEES) DOES NOT WARRANT:</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>THAT THE PRODUCTS ARE ACCURATE, RELIABLE OR CORRECT</p>
</li>
<li>
<p>THAT THE PRODUCTS WILL MEET YOUR REQUIREMENTS</p>
</li>
<li>
<p>THAT THE PRODUCTS WILL BE AVAILABLE AT ANY PARTICULAR TIME OR LOCATION, UNINTERRUPTED OR SECURE</p>
</li>
<li>
<p>THAT ANY DEFECTS OR ERRORS WILL BE CORRECTED</p>
</li>
<li>
<p>THAT THE PRODUCTS ARE FREE OF VIRUSES OR OTHER HARMFUL COMPONENTS</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>ANY CONTENT OR DATA DOWNLOADED OR OTHERWISE OBTAINED THROUGH THE USE OF THE PRODUCTS ARE DOWNLOADED AT YOUR OWN RISK AND YOU WILL BE SOLELY RESPONSIBLE FOR ANY DAMAGE TO YOUR PROPERTY OR LOSS OF DATA THAT RESULTS FROM SUCH DOWNLOAD. NO WARRANTY OR LIABILITY AT ALL IS GIVEN TO PRODUCTS UNDER EVALUATION.</p>
</div>
</li>
<li>
<p><strong>DISCLAIMER OF DAMAGES</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>TO THE MAXIMUM EXTENT PERMITTED BY APPLICABLE LAW, IN NO EVENT WILL AEROKUBE (OR ITS AFFILIATES, AGENTS, DIRECTORS, OR EMPLOYEES), OR AEROKUBE LICENSORS, SUPPLIERS OR RESELLERS BE LIABLE TO CUSTOMER OR ANYONE ELSE FOR:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>ANY LOSS OF USE, DATA, GOODWILL, OR PROFITS, WHETHER OR NOT FORESEEABLE</p>
</li>
<li>
<p>ANY LOSS OR DAMAGES IN CONNECTION WITH TERMINATION OR SUSPENSION OF CUSTOMER&#8217;S ACCESS TO OUR PRODUCTS IN ACCORDANCE WITH THIS AGREEMENT</p>
</li>
<li>
<p>ANY SPECIAL, INCIDENTAL, INDIRECT, CONSEQUENTIAL, EXEMPLARY OR PUNITIVE DAMAGES WHATSOEVER (EVEN IF WE HAVE BEEN ADVISED OF THE POSSIBILITY OF THESE DAMAGES), INCLUDING THOSE:</p>
<div class="olist upperalpha">
<ol class="upperalpha" type="A">
<li>
<p>RESULTING FROM LOSS OF USE, DATA, OR PROFITS, WHETHER OR NOT FORESEEABLE</p>
</li>
<li>
<p>BASED ON ANY THEORY OF LIABILITY, INCLUDING BREACH OF CONTRACT OR WARRANTY, STRICT LIABILITY, NEGLIGENCE OR OTHER TORTIOUS ACTION</p>
</li>
<li>
<p>ARISING FROM ANY OTHER CLAIM ARISING OUT OF OR IN CONNECTION WITH CUSTOMER&#8217;S USE OF OR ACCESS TO THE PRODUCTS OR SUPPORT.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>THE FOREGOING LIMITATION OF LIABILITY SHALL APPLY TO THE FULLEST EXTENT PERMITTED BY LAW IN THE APPLICABLE JURISDICTION.</p>
</li>
<li>
<p>THE TOTAL LIABILITY IN ANY MATTER ARISING OUT OF OR IN RELATION TO THIS AGREEMENT IS LIMITED TO ONE HUNDRED (100) US DOLLARS OR THE AGGREGATE AMOUNT PAID OR PAYABLE BY THE CUSTOMER FOR PRODUCTS DURING THE THREE-MONTH PERIOD PRECEDING THE EVENT GIVING RISE TO THE LIABILITY, WHICHEVER IS GREATER. THIS LIMITATION WILL APPLY EVEN IF WE OR YOU HAVE BEEN ADVISED OF THE POSSIBILITY OF LIABILITY EXCEEDING SUCH AMOUNT AND NOTWITHSTANDING ANY FAILURE OF THE ESSENTIAL PURPOSE OF ANY LIMITED REMEDY.</p>
</li>
</ol>
</div>
</li>
<li>
<p><strong>Term and Termination</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The term of this Agreement will commence upon acceptance of this Agreement by Customer as set forth in the preamble above, and will continue for each Product through the end of the applicable subscription period specified in the respective Subscription Confirmation. This Agreement will automatically renew with respect to each Product for a successive subscription term, unless terminated as set forth herein.</p>
</li>
<li>
<p>Customer may terminate this Agreement at any time by cancelling its Product subscription. If such termination occurs during a then-current subscription period, this Agreement will continue to be effective until the end of that subscription period. Such termination does not relieve Customer of the obligation to pay any outstanding subscription fees owed to Licensor, and no credits or refunds will be issued to Customer for prepaid subscription fees (except as specified in the Licensor Terms of Purchase, if applicable).</p>
</li>
<li>
<p>Licensor <strong>may terminate</strong> this agreement if:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Customer has materially breached this Agreement and fails to cure such breach within thirty (30) days of written notice thereof.</p>
</li>
<li>
<p>Customer fails to make the timely payment of subscription fees in accordance with "Fees" Section of this Agreement.</p>
</li>
<li>
<p>Licensor is required to do so by law (for example, where the provision of the Product to Customer is, or becomes, unlawful).</p>
</li>
<li>
<p>Licensor elects to discontinue providing the Product, in whole or in part.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Licensor will make reasonable efforts to <strong>notify Customer</strong> via email as follows:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Thirty (30) days prior to termination of the Agreement when required to terminate by law or because of discontinued Product. In such events Customer will be entitled to a refund of the unused portion of prepaid subscription fees, if applicable.</p>
</li>
<li>
<p>Three (3) days prior to termination of the Agreement in other cases. In such events Customer will not be entitled to any refund of the unused portion of prepaid subscription fees.</p>
</li>
</ol>
</div>
</li>
<li>
<p><strong>Survival.</strong> Upon the expiration or termination of this Agreement by Customer and if Customer elects to use the Fallback Version of the Product this Agreement statements will also survive with respect to said Fallback Version.</p>
</li>
</ol>
</div>
</li>
<li>
<p><strong>Temporary Suspension for Non-payment</strong></p>
</li>
<li>
<p>Licensor reserves the right to suspend or limit Customer&#8217;s access to Aerokube Products if Customer fails to pay subscription fees on time.</p>
</li>
<li>
<p>If Licensor suspends or limits Customer&#8217;s access to Aerokube Products for non-payment according, Customer must pay all past due amounts in order to restore full access to Aerokube Products.</p>
</li>
<li>
<p>Customer hereby agrees that Licensor is entitled to charge Customer for the time period during which Customer has access to Aerokube Products until Customer or Licensor terminates or suspends Customer&#8217;s subscription in accordance with this Agreement.</p>
</li>
<li>
<p><strong>Export Regulations</strong></p>
<div class="paragraph">
<p>Customer shall comply with all applicable laws and regulations with regards to economic sanctions, export controls, import regulations, and trade embargoes (all herein referred to as "Sanctions"), including those of the European Union and United States (specifically the Export Administration Regulations (EAR)). Customer declares that it is not a person targeted by Sanctions nor is it otherwise owned or controlled by or acting on behalf of any person targeted by Sanctions. Further, Customer warrants that it will not download or otherwise export or re-export the Product or any related technical data directly or indirectly to any person targeted by Sanctions or download or otherwise use the Product for any end-use prohibited or restricted by Sanctions.</p>
</div>
</li>
<li>
<p><strong>Customer Support</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Licensor provides Email Support as well as Instant Messaging Support. The response time will be reasonable, but no specific response time guarantees are given.</p>
</li>
<li>
<p>Customer may request additional paid support from Licensor which is subject of a supplementary individually negotiated Agreement between Customer and Licensor.</p>
</li>
<li>
<p>Any guarantees of support availability only apply to the latest version of Licensed Software available in Customer Subscription.</p>
</li>
</ol>
</div>
</li>
<li>
<p><strong>Customer Data</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><strong>Use of Name and Logo.</strong> Customer agrees that Licensor may identify it as a customer of Aerokube and may refer to it by name, trade name and trademark, if applicable. Licensor may also briefly describe Customer&#8217;s business in Licensor marketing materials, on the Aerokube website and/or in public or legal documents. Customer hereby grants Licensor a worldwide, non-exclusive and royalty-free license to use Customer&#8217;s name and any of Customer&#8217;s trade names and trademarks solely pursuant to this marketing section. Notwithstanding anything to the contrary herein, Licensor acknowledges that in some cases Customer licenses and does not own marks or logos (for example, marks or logos of the Affiliates) and cannot permit Licensor to use such marks.</p>
</li>
<li>
<p><strong>Gathering of Usage Statistics.</strong> Customer acknowledges and agrees that the Product may contain a feature that reports the usage statistics, diagnostics information and usage meta-information of the Product back to the Licensor. Customer may opt out of the gathering of usage statistics by turning off this feature in the Product settings.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_pricing"><a class="anchor" href="#_pricing"></a>5. Pricing</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Last updated August 7th, 2019. Replaces the prior version in its entirety.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Moon price is calculated using so-called <code>Number of Concurrent Sessions</code> that is to say total number of browser sessions being run in parallel. We control this by limiting total number of simultaneously running browser pods to the value you are purchasing.</p>
</li>
<li>
<p>When no license key is provided <code>4 (four)</code> parallel browser sessions maximum are allowed. If such limit is sufficient for you - you are allowed use Moon without license key for unlimited period of time.</p>
</li>
<li>
<p>If free limit is insufficient - you need <code>a paid license</code>. Such license can include <code>any desired number</code> of parallel browser sessions (yes, even <code>42</code>).</p>
</li>
<li>
<p>Every parallel session has a fixed cost - <code>$5 USD</code> (five United States dollars). If you are a EU-based company - then we convert the price to euro (€) and an additional VAT 20% applies.</p>
<div class="listingblock">
<div class="title">An example price calculation</div>
<div class="content">
<pre>42 sessions * $5/month = $210/month</pre>
</div>
</div>
</li>
<li>
<p>For simplicity we calculated monthly prices for some frequent cases:</p>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 11. Moon License Pricing</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Number of Parallel Sessions</th>
<th class="tableblock halign-left valign-top">Price per Month, USD</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0-4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">free</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">$25</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">$50</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">15</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">$75</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">20</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">$100</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">25</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">$125</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">30</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">$150</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">40</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">$200</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">50</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">$250</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">75</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">$375</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">$500</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">150</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">$750</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">$1000</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">250</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">$1250</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">500</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">$2500</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">750</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">$3750</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">$5000</p></td>
</tr>
</tbody>
</table>
</li>
</ol>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version latest<br>
Last updated 2019-08-27 14:55:19 UTC
</div>
</div>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-23854888-2"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-23854888-2');
</script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
        m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(43539754, "init", {
        clickmap:true,
        trackLinks:true,
        accurateTrackBounce:true,
        webvisor:true,
        trackHash:true
    });
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/43539754" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->
</body>
</html>